<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Pandoc - Releases</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!--[if lt IE 9]>
       <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
       <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
       <![endif]-->
  <link rel="stylesheet"
          href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="css/screen.css">
  <link rel="stylesheet" type="text/css" media="print" href="css/print.css">
  <style type="text/css">
      code{white-space: pre-wrap;}
      pre{ font-size: 12pt; }
      .smallcaps{font-variant: small-caps;}
      .line-block{white-space: pre-line;}
      .column{display: inline-block;}
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"
            type="text/javascript"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
  <script src="js/nav.js"></script>
  <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-2234613-4']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  </script>
  <script type="text/javascript">
  /* <![CDATA[ */
    (function() {
        var s = document.createElement('script'), t = document.getElementsByTagName('script')[0];
        s.type = 'text/javascript';
        s.async = true;
        s.src = 'https://api.flattr.com/js/0.6/load.js?mode=auto';
        t.parentNode.insertBefore(s, t);
    })();
  /* ]]> */
  </script>
</head>
<body>
  <div id="doc" class="container-fluid">
    <header>
      <div id="flattr">
        <a class="FlattrButton" style="display:none;" rev="flattr;button:compact;" href="https://pandoc.org"></a>
        <noscript><a href="https://flattr.com/thing/936364/Pandoc" target="_blank"><img src="https://api.flattr.com/button/flattr-badge-large.png" alt="Flattr this" title="Flattr this" border="0" /></a></noscript>
      </div>
        <div id="paypal">
         <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----MIIHbwYJKoZIhvcNAQcEoIIHYDCCB1wCAQExggEwMIIBLAIBADCBlDCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20CAQAwDQYJKoZIhvcNAQEBBQAEgYA1aF1SYXH476Drh95jHdjCr2Pe08jgMkj9i7o+LqUNtjNpn2o2WT0G0gRm8+fSf3olG3isnZ8cJcxvV4MqvT054L2Z+erugv1UnDyEx/rmOzk+JQkDX71PmMYjQLwbyrFyU0RaVR6ksjNstM3I7bn4b8gQuSM9UkmfI/xVvslsXTELMAkGBSsOAwIaBQAwgewGCSqGSIb3DQEHATAUBggqhkiG9w0DBwQIHvq7EiOKDNOAgcjLqF4vqQA57C5WLRryItIy6xBS/tEOeAqHUR3uj65kP0HqCmwUX18IhLksKwEOc4yeDqZUo9pcPWyFRcrRxjqObs167KmrafWzCrLDRN+czf9pZUjDpYTGy0sYyW7Rt38+vLtVRHukxLkMiT3ZJ8iRd1LXx5iQRN9d8ouuS4/CsTaZoD+cv4leQR7wKpIE2LbuMx9ghOJ4kR3NSSwNYN2VyHfgONyNdQqsZCWaSO5uGXK/TnDguKoi8VSOzX2fIChhYmvdgqPtmKCCA4cwggODMIIC7KADAgECAgEAMA0GCSqGSIb3DQEBBQUAMIGOMQswCQYDVQQGEwJVUzELMAkGA1UECBMCQ0ExFjAUBgNVBAcTDU1vdW50YWluIFZpZXcxFDASBgNVBAoTC1BheVBhbCBJbmMuMRMwEQYDVQQLFApsaXZlX2NlcnRzMREwDwYDVQQDFAhsaXZlX2FwaTEcMBoGCSqGSIb3DQEJARYNcmVAcGF5cGFsLmNvbTAeFw0wNDAyMTMxMDEzMTVaFw0zNTAyMTMxMDEzMTVaMIGOMQswCQYDVQQGEwJVUzELMAkGA1UECBMCQ0ExFjAUBgNVBAcTDU1vdW50YWluIFZpZXcxFDASBgNVBAoTC1BheVBhbCBJbmMuMRMwEQYDVQQLFApsaXZlX2NlcnRzMREwDwYDVQQDFAhsaXZlX2FwaTEcMBoGCSqGSIb3DQEJARYNcmVAcGF5cGFsLmNvbTCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAwUdO3fxEzEtcnI7ZKZL412XvZPugoni7i7D7prCe0AtaHTc97CYgm7NsAtJyxNLixmhLV8pyIEaiHXWAh8fPKW+R017+EmXrr9EaquPmsVvTywAAE1PMNOKqo2kl4Gxiz9zZqIajOm1fZGWcGS0f5JQ2kBqNbvbg2/Za+GJ/qwUCAwEAAaOB7jCB6zAdBgNVHQ4EFgQUlp98u8ZvF71ZP1LXChvsENZklGswgbsGA1UdIwSBszCBsIAUlp98u8ZvF71ZP1LXChvsENZklGuhgZSkgZEwgY4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLUGF5UGFsIEluYy4xEzARBgNVBAsUCmxpdmVfY2VydHMxETAPBgNVBAMUCGxpdmVfYXBpMRwwGgYJKoZIhvcNAQkBFg1yZUBwYXlwYWwuY29tggEAMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADgYEAgV86VpqAWuXvX6Oro4qJ1tYVIT5DgWpE692Ag422H7yRIr/9j/iKG4Thia/Oflx4TdL+IFJBAyPK9v6zZNZtBgPBynXb048hsP16l2vi0k5Q2JKiPDsEfBhGI+HnxLXEaUWAcVfCsQFvd2A1sxRr67ip5y2wwBelUecP3AjJ+YcxggGaMIIBlgIBATCBlDCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20CAQAwCQYFKw4DAhoFAKBdMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8XDTE0MDEwNjIwMjYzOVowIwYJKoZIhvcNAQkEMRYEFJLYt8/tr7y69LYjPJjKyTMm5QAYMA0GCSqGSIb3DQEBAQUABIGAI2+pZ4nP2NsnH4648MqJ7ihLLMxoiNXZTiH2yV9rknNcK0cCT28UTWnO1iFZPWNeZRMA+PclqnTS4DuGvj3+MYvGbu0NauKT9TE1eP+nrdP2XHa3qTGXcCqezVqfUxknMXyXBW5u20JGXp+D9RizEfhSX67JBLvsVwlmBYmcyYk=-----END PKCS7-----
">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>
      </div>

        <span class="big">Pandoc</span>
        &nbsp;
        <span class="small">a universal document converter</span>
    </header>
    <div id="bd">
      <nav id="navbar" class="navbar nav navbar-default col-md-3 col-sm-4">
        <div class="navbar-header">
  <button type="button" class="navbar-toggle"
          data-toggle="collapse"
          data-target=".navbar-collapse">
    <span class="sr-only">Toggle navigation</span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
  </button>
</div>
<div class="navbar-collapse collapse">
  <ul class="nav tree">
    <li><a href="index.html">About</a></li>
    <li><a href="installing.html">Installing</a></li>
    <li><a href="getting-started.html">Getting started</a></li>
    <li><a class="tree-toggle nav-header">Demos</a>
    <ul class="nav tree">
      <li><a href="try">Try pandoc online</a></li>
      <li><a href="demos.html">Examples</a></li>
    </ul>
    </li>
    <li><a class="tree-toggle nav-header">Documentation</a>
    <ul class="nav tree">
      <li><a href="MANUAL.html">User's Guide</a>
      <li><a href="MANUAL.pdf">User's Guide (PDF)</a>
      <li><a href="epub.html">Making an ebook</a></li>
      <li><a href="filters.html">Filters</a></li>
      <li><a href="lua-filters.html">Lua filters</a></li>
      <li><a href="CONTRIBUTING.html">Contributing</a></li>
      <li><a href="faqs.html">FAQ</a></li>
      <li><a href="press.html">Press</a></li>
      <li><a href="using-the-pandoc-api.html">Using the Pandoc API</a></li>
      <li><a href="http://hackage.haskell.org/package/pandoc">API documentation</a></li>
    </ul>
    </li>
    <li><a href="help.html">Help</a></li>
    <li><a href="https://github.com/jgm/pandoc/wiki/Pandoc-Extras">Extras</a></li>
    <li><a href="releases.html">Releases</a></li>
  </ul>
</div>
      </nav>
      <main class="col-md-9 col-sm-8">
        <div class="row">
          <h1 class="title">Releases</h1>
        <div id="toc">
<ul>
<li><a href="#pandoc-2.1.1-18-january-2018">pandoc 2.1.1 (18 January 2018)</a></li>
<li><a href="#pandoc-2.1-7-january-2018">pandoc 2.1 ( 7 January 2018)</a></li>
<li><a href="#pandoc-2.0.6-28-december-2017">pandoc 2.0.6 (28 December 2017)</a></li>
<li><a href="#pandoc-2.0.5-12-december-2017">pandoc 2.0.5 (12 December 2017)</a></li>
<li><a href="#pandoc-2.0.4-03-december-2017">pandoc 2.0.4 (03 December 2017)</a></li>
<li><a href="#pandoc-2.0.3-20-november-2017">pandoc 2.0.3 (20 November 2017)</a></li>
<li><a href="#pandoc-2.0.2-12-november-2017">pandoc 2.0.2 (12 November 2017)</a></li>
<li><a href="#pandoc-2.0.1.1-04-november-2017">pandoc 2.0.1.1 (04 November 2017)</a></li>
<li><a href="#pandoc-2.0.1-31-october-2017">pandoc 2.0.1 (31 October 2017)</a></li>
<li><a href="#pandoc-2.0.0.1-30-oct-2017">pandoc 2.0.0.1 (30 Oct 2017)</a></li>
<li><a href="#pandoc-2.0-29-oct-2017">pandoc 2.0 (29 Oct 2017)</a><ul>
<li><a href="#new-features">New features</a></li>
<li><a href="#behavior-changes">Behavior changes</a></li>
<li><a href="#api-changes">API changes</a></li>
<li><a href="#bug-fixes-and-under-the-hood-improvements">Bug fixes and under-the-hood improvements</a></li>
<li><a href="#default-template-changes">Default template changes</a></li>
<li><a href="#documentation-improvements">Documentation improvements</a></li>
<li><a href="#build-infrastructure-improvements">Build infrastructure improvements</a></li>
</ul></li>
<li><a href="#pandoc-1.19.2.4-10-sep-2017">pandoc 1.19.2.4 (10 Sep 2017)</a></li>
<li><a href="#pandoc-1.19.2.3-09-sep-2017">pandoc 1.19.2.3 (09 Sep 2017)</a></li>
<li><a href="#pandoc-1.19.2.2-08-sep-2017">pandoc 1.19.2.2 (08 Sep 2017)</a></li>
<li><a href="#pandoc-1.19.2.1-31-jan-2017">pandoc 1.19.2.1 (31 Jan 2017)</a></li>
<li><a href="#pandoc-1.19.2-29-jan-2017">pandoc 1.19.2 (29 Jan 2017)</a></li>
<li><a href="#pandoc-1.19.1-10-dec-2016">pandoc 1.19.1 (10 Dec 2016)</a></li>
<li><a href="#pandoc-1.19-01-dec-2016">pandoc 1.19 (01 Dec 2016)</a></li>
<li><a href="#pandoc-1.18-26-oct-2016">pandoc 1.18 (26 Oct 2016)</a></li>
<li><a href="#pandoc-1.17.2-17-jul-2016">pandoc 1.17.2 (17 Jul 2016)</a></li>
<li><a href="#pandoc-1.17.1-4-jun-2016">pandoc 1.17.1 (4 Jun 2016)</a></li>
<li><a href="#pandoc-1.17.0.3-24-mar-2016">pandoc 1.17.0.3 (24 Mar 2016)</a></li>
<li><a href="#pandoc-1.17.0.2-23-mar-2016">pandoc 1.17.0.2 (23 Mar 2016)</a></li>
<li><a href="#pandoc-1.17.0.1-21-mar-2016">pandoc 1.17.0.1 (21 Mar 2016)</a></li>
<li><a href="#pandoc-1.17-20-mar-2016">pandoc 1.17 (20 Mar 2016)</a></li>
<li><a href="#pandoc-1.16.0.2">pandoc (1.16.0.2)</a></li>
<li><a href="#pandoc-1.16.0.2-12-jan-2016">pandoc 1.16.0.2 (12 Jan 2016)</a></li>
<li><a href="#pandoc-1.16.0.1-10-jan-2016">pandoc 1.16.0.1 (10 Jan 2016)</a></li>
<li><a href="#pandoc-1.16-02-jan-2016">pandoc 1.16 (02 Jan 2016)</a></li>
<li><a href="#pandoc-1.15.2.1-16-nov-2015">pandoc 1.15.2.1 (16 Nov 2015)</a></li>
<li><a href="#pandoc-1.15.2-15-nov-2015">pandoc 1.15.2 (15 Nov 2015)</a></li>
<li><a href="#pandoc-1.15.1-15-oct-2015">pandoc 1.15.1 (15 Oct 2015)</a></li>
<li><a href="#pandoc-1.15.0.6-15-jul-2015">pandoc 1.15.0.6 (15 Jul 2015)</a></li>
<li><a href="#pandoc-1.15.0.5-10-jul-2015">pandoc 1.15.0.5 (10 Jul 2015)</a></li>
<li><a href="#pandoc-1.15.0.4-03-jul-2015">pandoc 1.15.0.4 (03 Jul 2015)</a></li>
<li><a href="#pandoc-1.15.0.3-02-jul-2015">pandoc 1.15.0.3 (02 Jul 2015)</a></li>
<li><a href="#pandoc-1.15.0.2-02-jul-2015">pandoc 1.15.0.2 (02 Jul 2015)</a></li>
<li><a href="#pandoc-1.15.0.1-01-jul-2015">pandoc 1.15.0.1 (01 Jul 2015)</a></li>
<li><a href="#pandoc-1.15-01-jul-2015">pandoc 1.15 (01 Jul 2015)</a></li>
<li><a href="#pandoc-1.14.1-30-jun-2015">pandoc 1.14.1 (30 Jun 2015)</a></li>
<li><a href="#pandoc-1.14.0.4-02-jun-2015">pandoc 1.14.0.4 (02 Jun 2015)</a></li>
<li><a href="#pandoc-1.14.0.3-01-jun-2015">pandoc 1.14.0.3 (01 Jun 2015)</a></li>
<li><a href="#pandoc-1.14.0.2-31-may-2015">pandoc 1.14.0.2 (31 May 2015)</a></li>
<li><a href="#pandoc-1.14.0.1-28-may-2015">pandoc 1.14.0.1 (28 May 2015)</a></li>
<li><a href="#pandoc-1.14-27-may-2015">pandoc 1.14 (27 May 2015)</a><ul>
<li><a href="#new-features-1">New features</a></li>
<li><a href="#behavior-changes-1">Behavior changes</a></li>
<li><a href="#api-changes-1">API changes</a></li>
<li><a href="#bug-fixes">Bug fixes</a></li>
<li><a href="#template-changes">Template changes</a></li>
<li><a href="#under-the-hood-improvements">Under the hood improvements</a></li>
</ul></li>
<li><a href="#pandoc-1.13.2.1-15-apr-2015">pandoc 1.13.2.1 (15 Apr 2015)</a></li>
<li><a href="#pandoc-1.13.2-20-dec-2014">pandoc 1.13.2 (20 Dec 2014)</a></li>
<li><a href="#pandoc-1.13.1-30-aug-2014">pandoc 1.13.1 (30 Aug 2014)</a></li>
<li><a href="#pandoc-1.13.0.1-17-august-2014">pandoc 1.13.0.1 (17 August 2014)</a></li>
<li><a href="#pandoc-1.13-15-august-2014">pandoc 1.13 (15 August 2014)</a><ul>
<li><a href="#new-features-2">New features</a></li>
<li><a href="#behavior-changes-2">Behavior changes</a></li>
<li><a href="#api-changes-2">API changes</a></li>
<li><a href="#bug-fixes-1">Bug fixes</a></li>
<li><a href="#template-changes-1">Template changes</a></li>
<li><a href="#under-the-hood-improvements-1">Under the hood improvements</a></li>
</ul></li>
<li><a href="#pandoc-1.12.4.2-14-may-2014">pandoc 1.12.4.2 (14 May 2014)</a></li>
<li><a href="#pandoc-1.12.4-07-may-2014">pandoc 1.12.4 (07 May 2014)</a></li>
<li><a href="#pandoc-1.12.3.3-03-feb-2014">pandoc 1.12.3.3 (03 Feb 2014)</a></li>
<li><a href="#pandoc-1.12.3.2-03-feb-2014">pandoc 1.12.3.2 (03 Feb 2014)</a></li>
<li><a href="#pandoc-1.12.3.1-14-jan-2014">pandoc 1.12.3.1 (14 Jan 2014)</a></li>
<li><a href="#pandoc-1.12.3-10-jan-2014">pandoc 1.12.3 (10 Jan 2014)</a></li>
<li><a href="#pandoc-1.12.2.1-2013-12-08">pandoc 1.12.2.1 (2013-12-08)</a></li>
<li><a href="#pandoc-1.12.2-2013-12-07">pandoc 1.12.2 (2013-12-07)</a></li>
<li><a href="#pandoc-1.12.1-2013-10-20">pandoc 1.12.1 (2013-10-20)</a></li>
<li><a href="#pandoc-1.12.0.2-2013-09-20">pandoc 1.12.0.2 (2013-09-20)</a></li>
<li><a href="#pandoc-1.12.0.1-2013-09-20">pandoc 1.12.0.1 (2013-09-20)</a></li>
<li><a href="#pandoc-1.12-2013-09-15">pandoc 1.12 (2013-09-15)</a><ul>
<li><a href="#new-features-3">New features</a></li>
<li><a href="#behavior-changes-3">Behavior changes</a></li>
<li><a href="#api-changes-3">API changes</a></li>
<li><a href="#bug-fixes-2">Bug fixes</a></li>
<li><a href="#template-changes-2">Template changes</a></li>
<li><a href="#under-the-hood-improvements-2">Under-the-hood improvements</a></li>
</ul></li>
<li><a href="#pandoc-1.11.1-2013-03-17">pandoc 1.11.1 (2013-03-17)</a></li>
<li><a href="#pandoc-1.11-2013-03-09">pandoc 1.11 (2013-03-09)</a></li>
<li><a href="#pandoc-1.10.1-2013-01-23">pandoc 1.10.1 (2013-01-23)</a></li>
<li><a href="#pandoc-1.10.0.5-2013-01-23">pandoc 1.10.0.5 (2013-01-23)</a></li>
<li><a href="#pandoc-1.10.0.4-2013-01-20">pandoc 1.10.0.4 (2013-01-20)</a></li>
<li><a href="#pandoc-1.10.0.3-2013-01-20">pandoc 1.10.0.3 (2013-01-20)</a></li>
<li><a href="#pandoc-1.10.0.2-2013-01-20">pandoc 1.10.0.2 (2013-01-20)</a></li>
<li><a href="#pandoc-1.10.0.1-2013-01-20">pandoc 1.10.0.1 (2013-01-20)</a></li>
<li><a href="#pandoc-1.10-2013-01-19">pandoc 1.10 (2013-01-19)</a><ul>
<li><a href="#new-features-4">New features</a></li>
<li><a href="#behavior-changes-4">Behavior changes</a></li>
<li><a href="#template-changes-3">Template changes</a></li>
<li><a href="#api-changes-4">API changes</a></li>
<li><a href="#bug-fixes-3">Bug fixes</a></li>
<li><a href="#under-the-hood-improvements-3">Under the hood improvements</a></li>
</ul></li>
<li><a href="#pandoc-1.9.4.5-2012-10-21">pandoc 1.9.4.5 (2012-10-21)</a></li>
<li><a href="#pandoc-1.9.4.4-2012-10-20">pandoc 1.9.4.4 (2012-10-20)</a></li>
<li><a href="#pandoc-1.9.4.3-2012-10-20">pandoc 1.9.4.3 (2012-10-20)</a></li>
<li><a href="#pandoc-1.9.4.2-2012-06-29">pandoc 1.9.4.2 (2012-06-29)</a></li>
<li><a href="#pandoc-1.9.4.1-2012-06-08">pandoc 1.9.4.1 (2012-06-08)</a></li>
<li><a href="#pandoc-1.9.4-2012-06-03">pandoc 1.9.4 (2012-06-03)</a></li>
<li><a href="#pandoc-1.9.3-2012-05-12">pandoc 1.9.3 (2012-05-12)</a></li>
<li><a href="#pandoc-1.9.2-2012-04-05">pandoc 1.9.2 (2012-04-05)</a></li>
<li><a href="#pandoc-1.9.1.2-2012-03-09">pandoc 1.9.1.2 (2012-03-09)</a></li>
<li><a href="#pandoc-1.9.1.1-2012-02-11">pandoc 1.9.1.1 (2012-02-11)</a></li>
<li><a href="#pandoc-1.9.1-2012-02-09">pandoc 1.9.1 (2012-02-09)</a></li>
<li><a href="#pandoc-1.9.0.5-2012-02-06">pandoc 1.9.0.5 (2012-02-06)</a></li>
<li><a href="#pandoc-1.9.0.4-2012-02-06">pandoc 1.9.0.4 (2012-02-06)</a></li>
<li><a href="#pandoc-1.9.0.3-2012-02-06">pandoc 1.9.0.3 (2012-02-06)</a></li>
<li><a href="#pandoc-1.9.0.2-2012-02-05">pandoc 1.9.0.2 (2012-02-05)</a></li>
<li><a href="#pandoc-1.9-2012-02-05">pandoc 1.9 (2012-02-05)</a><ul>
<li><a href="#new-features-5">New features</a></li>
<li><a href="#behavior-changes-5">Behavior changes</a></li>
<li><a href="#bug-fixes-4">Bug fixes</a></li>
<li><a href="#under-the-hood-improvements-4">Under the hood improvements</a></li>
<li><a href="#api-changes-5">API changes</a></li>
</ul></li>
<li><a href="#pandoc-1.8.2.1-2011-08-01">pandoc 1.8.2.1 (2011-08-01)</a></li>
<li><a href="#pandoc-1.8.2-2011-07-30">pandoc 1.8.2 (2011-07-30)</a></li>
<li><a href="#pandoc-1.8.1.2-2011-07-16">pandoc 1.8.1.2 (2011-07-16)</a></li>
<li><a href="#pandoc-1.8.1.1-2011-02-13">pandoc 1.8.1.1 (2011-02-13)</a></li>
<li><a href="#pandoc-1.8.1-2011-02-13">pandoc 1.8.1 (2011-02-13)</a></li>
<li><a href="#pandoc-1.8.0.3-2011-02-05">pandoc 1.8.0.3 (2011-02-05)</a></li>
<li><a href="#pandoc-1.8.0.2-2011-02-05">pandoc 1.8.0.2 (2011-02-05)</a></li>
<li><a href="#pandoc-1.8.0.1-2001-01-31">pandoc 1.8.0.1 (2001-01-31)</a></li>
<li><a href="#pandoc-1.8-2011-01-30">pandoc 1.8 (2011-01-30)</a><ul>
<li><a href="#new-features-6">New features</a></li>
<li><a href="#api-and-program-changes">API and program changes</a></li>
<li><a href="#under-the-hood-improvements-5">Under-the-hood improvements</a></li>
<li><a href="#bug-fixes-5">Bug fixes</a></li>
</ul></li>
<li><a href="#pandoc-1.6-2010-07-24">pandoc 1.6 (2010-07-24)</a></li>
<li><a href="#pandoc-1.5.1.1-2010-03-29">pandoc 1.5.1.1 (2010-03-29)</a></li>
<li><a href="#pandoc-1.5.1-2010-03-23">pandoc 1.5.1 (2010-03-23)</a></li>
<li><a href="#pandoc-1.5.0.1-2010-03-21">pandoc 1.5.0.1 (2010-03-21)</a></li>
<li><a href="#pandoc-1.5-2010-03-20">pandoc 1.5 (2010-03-20)</a></li>
<li><a href="#pandoc-1.4-2010-01-02">pandoc 1.4 (2010-01-02)</a></li>
<li><a href="#pandoc-1.3-2009-12-10">pandoc 1.3 (2009-12-10)</a></li>
<li><a href="#pandoc-1.2.1-2009-07-18">pandoc 1.2.1 (2009-07-18)</a></li>
<li><a href="#pandoc-1.2-2009-03-01">pandoc 1.2 (2009-03-01)</a></li>
<li><a href="#pandoc-1.1-2008-11-06">pandoc 1.1 (2008-11-06)</a></li>
<li><a href="#pandoc-1.0-2008-09-13">pandoc 1.0 (2008-09-13)</a></li>
<li><a href="#pandoc-0.46-2008-01-08">pandoc 0.46 (2008-01-08)</a></li>
<li><a href="#pandoc-0.45-2007-12-09">pandoc 0.45 (2007-12-09)</a></li>
</ul>
        </div>
<p>Want to know when a new release is available? Subscribe to <a href="http://groups.google.com/group/pandoc-announce"><code>pandoc-announce</code></a>, a low-volume mailing list that is just for announcements of new releases.</p>
<h1 id="pandoc-2.1.1-18-january-2018">pandoc 2.1.1 (18 January 2018)</h1>
<ul>
<li><p>Markdown reader:</p>
<ul>
<li>Don’t coalesce adjacent raw LaTeX blocks if they are separated by a blank line. See lierdakil/pandoc-crossref#160.</li>
<li>Improved <code>inlinesInBalancedBrackets</code> (#4272, jgm/pandoc-citeproc#315). The change both improves performance and fixes a regression whereby normal citations inside inline notes and figure captions were not parsed correctly.</li>
</ul></li>
<li><p>RST reader:</p>
<ul>
<li>Better handling for headers with an anchor (#4240). Instead of creating a Div containing the header, we put the id directly on the header. This way header promotion will work properly.</li>
<li>Add aligned environment when needed in math (#4254). <code>rst2latex.py</code> uses an <code>align*</code> environment for math in <code>.. math::</code> blocks, so this math may contain line breaks. If it does, we put the math in an <code>aligned</code> environment to simulate <code>rst2latex.py</code>’s behavior.</li>
</ul></li>
<li><p>HTML reader:</p>
<ul>
<li>Fix col width parsing for percentages &lt; 10% (#4262, n3fariox).</li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Advance source position at end of stream.</li>
<li>Pass through macro defs in <code>rawLaTeXBlock</code> even if the <code>latex_macros</code> extension is set (#4246). This reverts to earlier behavior and is probably safer on the whole, since some macros only modify things in included packages, which pandoc’s macro expansion can’t modify.</li>
<li>Fixed pos calculation in tokenizing escaped space.</li>
<li><p>Allow macro definitions inside macros (#4253). Previously we went into an infinite loop with</p>
<pre><code>\newcommand{\noop}[1]{#1}
\noop{\newcommand{\foo}[1]{#1}}
\foo{hi}</code></pre></li>
<li><p>Fix inconsistent column widths (#4238). This fixes a bug whereby column widths for the body were different from widths for the header in some tables.</p></li>
</ul></li>
<li><p>Docx reader (Jesse Rosenthal):</p>
<ul>
<li>Parse hyperlinks in <code>instrText</code> tags (#3389, #4266). This was a form of hyperlink found in older versions of word. The changes introduced for this, though, create a framework for parsing further fields in MS Word (see the spec, ECMA-376-1:2016, §17.16.5, for more on these fields). We introduce a new module, <code>Text.Pandoc.Readers.Docx.Fields</code> which contains a simple parsec parser. At the moment, only simple hyperlink fields are accepted, but that can be extended in the future.</li>
</ul></li>
<li><p>Muse reader (Alexander Krotov):</p>
<ul>
<li>Parse <code>~~</code> as non-breaking space in Text::Amuse mode.</li>
<li>Refactor list parsing.</li>
</ul></li>
<li><p>Powerpoint writer (Jesse Rosenthal):</p>
<ul>
<li>Change reference to <code>notesSlide</code> to <code>endNotesSlide</code>.</li>
<li>Move image sizing into <code>picProps</code>.</li>
<li>Improve table placement.</li>
<li>Make our own <code>_rels/.rels</code> file.</li>
<li>Import reference-doc images properly.</li>
<li>Move <code>Presentation.hs</code> out of <code>PandocMonad</code>.</li>
<li>Refactor into separate modules. T.P.W.Powerpoint.Presentation defines the Presentation datatype and goes Pandoc-&gt;Presentation; T.P.W.Pandoc.Output goes Presentation-&gt;Archive. Text.Pandoc.Writers.Powerpoint a thin wrapper around the two modules.</li>
<li>Avoid overlapping blocks in column output.</li>
<li>Position images correctly in two-column layout.</li>
<li>Make content shape retrieval environment-aware.</li>
<li>Improve image handling. We now determine image and caption placement by getting the dimensions of the content box in a given layout. This allows for images to be correctly sized and positioned in a different template. Note that images without captions and headers are no longer full-screened. We can’t do this dependably in different layouts, because we don’t know where the header is (it could be to the side of the content, for example).</li>
<li>Read presentation size from reference file. Our presentation size is now dependent on the reference/template file we use.</li>
<li>Handle (sub)headers above slidelevel correctly. Above the slidelevel, subheaders will be printed in bold and given a bit of extra space before them. Note that at the moment, no distinction is made between levels of headers above the slide header, though that can be changed.</li>
<li>Check for required files. Since we now import from reference/dist file by glob, we need to make sure that we’re getting the files we need to make a non-corrupt Powerpoint. This performs that check.</li>
<li>Improve templating using <code>--reference-doc</code>. Templating should work much more reliably now.</li>
<li>Include Notes slide in TOC.</li>
<li>Set notes slide header to slide-level.</li>
<li>Add table of contents. This is triggered by the <code>--toc</code> flag. Note that in a long slide deck this risks overrunning the text box. The user can address this by setting <code>--toc-depth=1</code>.</li>
<li>Set notes slide number correctly.</li>
<li>Clean up adding metadata slide. We want to count the slide numbers correctly if it’s in there.</li>
<li>Add anchor links. For anchor-type links (<code>[foo](#bar)</code>) we produce an anchor link. In powerpoint these are links to slides, so we keep track of a map relating anchors to the slides they occur on.</li>
<li>Make the slide number available to the blocks. For anchors, block-processing functions need to know what slide number they’re in. We make the <code>envCurSlideId</code> available to blocks.</li>
<li>Move <code>curSlideId</code> to environment.</li>
<li>Allow setting <code>toc-title</code> in metadata.</li>
<li>Link notes to endnotes slide.</li>
</ul></li>
<li><p>Markdown writer:</p>
<ul>
<li>Fix cell width calculation (#4265). Previously we could get ever-lengthening cell widths when a table was run repeatedly through <code>pandoc -f markdown -t markdown</code>.</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Escape <code>&amp;</code> in lstinline (Robert Schütz).</li>
</ul></li>
<li><p>ConTeXt writer:</p>
<ul>
<li>Use xtables instead of Tables (#4223, Henri Menke). Default to xtables for context output. Natural Tables are used if the new <code>ntb</code> extension is set.</li>
</ul></li>
<li><p>HTML writer:</p>
<ul>
<li>Fixed footnote backlinks with <code>--id-prefix</code> (#4235).</li>
</ul></li>
<li><p><code>Text.Pandoc.Extensions</code>: Added <code>Ext_ntb</code> constructor (API change, Henri Menke).</p></li>
<li><p><code>Text.Pandoc.ImageSize</code>: add derived <code>Eq</code> instance to <code>Dimension</code> (Jesse Rosenthal, API change).</p></li>
<li><p>Lua filters (Albert Krewinkel):</p>
<ul>
<li>Make <code>PANDOC_READER_OPTIONS</code> available. The options which were used to read the document are made available to Lua filters via the <code>PANDOC_READER_OPTIONS</code> global.</li>
<li>Add lua module <code>pandoc.utils.run_json_filter</code>, which runs a JSON filter on a Pandoc document.</li>
<li>Refactor filter-handling code into <code>Text.Pandoc.Filter.JSON</code>, <code>Text.Pandoc.Filter.Lua</code>, and <code>Text.Pandoc.Filter.Path</code>.</li>
<li>Improve error messages. Provide more context about the task which caused an error.</li>
</ul></li>
<li><p>data/pandoc.lua (Albert Krewinkel):</p>
<ul>
<li>Accept singleton inline as a list. Every constructor which accepts a list of inlines now also accepts a single inline element for convenience.</li>
<li>Accept single block as singleton list. Every constructor which accepts a list of blocks now also accepts a single block element for convenience. Furthermore, strings are accepted as shorthand for <code>{pandoc.Str &quot;text&quot;}</code> in constructors.</li>
<li>Add attr, listAttributes accessors. Elements with attributes got an additional <code>attr</code> accessor. Attributes were accessible only via the <code>identifier</code>, <code>classes</code>, and <code>attributes</code>, which was in conflict with the documentation, which indirectly states that such elements have the an <code>attr</code> property.</li>
<li>Drop <code>_VERSION</code>. Having a <code>_VERSION</code> became superfluous, as this module is closely tied to the pandoc version, which is available via <code>PANDOC_VERSION</code>.</li>
<li>Fix access to Attr components. Accessing an Attr value (e.g., <code>Attr().classes</code>) was broken; the more common case of accessing it via an Inline or Block element was unaffected by this.</li>
</ul></li>
<li><p>Move <code>metaValueToInlines</code> to from Docx writer to <code>Text.Pandoc.Writers.Shared</code>, so it can be used by other writers (Jesse Rosenthal).</p></li>
<li><p>MANUAL.txt:</p>
<ul>
<li>Clarify otherlangs in LaTeX (#4072).</li>
<li>Clarify <code>latex_macros</code> extension.</li>
<li>Recommend use of <code>raw_attribute</code> extension in header includes (#4253).</li>
</ul></li>
<li><p>Allow latest QuickCheck, tasty, criterion.</p></li>
<li><p>Remove custom prelude and ghc 7.8 support.</p></li>
<li><p>Reduce compiler noise (exact paths for compiled modules).</p></li>
</ul>
<h1 id="pandoc-2.1-7-january-2018">pandoc 2.1 ( 7 January 2018)</h1>
<ul>
<li><p>Allow filters and lua filters to be interspersed (#4196). Previously we ran all lua filters before JSON filters. Now we run filters in the order they are presented on the command line, whether lua or JSON. There are two incompatible API changes: The type of <code>applyFilters</code> has changed, and <code>applyLuaFilters</code> has been removed. <code>Filter</code> is also now exported.</p></li>
<li><p>Use latest skylighting and omit the <code>missingIncludes</code> check, fixing a major performance regression in earlier releases of the 2.x series (#4226). Behavior change: If you use a custom syntax definition that refers to a syntax you haven’t loaded, pandoc will now complain when it is highlighting the text, rather than doing a check at the start. This change dramatically speeds up invocations of pandoc on short inputs.</p></li>
<li><p>Text.Pandoc.Class: make <code>FileTree</code> opaque (don’t export <code>FileTree</code> constructor). This forces users to interact with it using <code>insertInFileTree</code> and <code>getFileInfo</code>, which normalize file names.</p></li>
<li><p>Markdown reader:</p>
<ul>
<li>Rewrite <code>inlinesInBalancedBrackets</code>. The rewrite is much more direct, avoiding <code>parseFromString</code>. And it performs significantly better; unfortunately, parsing time still increases exponentially (see #1735).</li>
<li>Avoid parsing raw tex unless <code>\</code> + letter seen. This seems to help with the performance problem, #4216.</li>
</ul></li>
<li><p>LaTeX reader: Simplified a check for raw tex command.</p></li>
<li><p>Muse reader (Alexander Krotov):</p>
<ul>
<li>Enable round trip test (#4107).</li>
<li>Automatically translate <code>#cover</code> into <code>#cover-image</code>. Amusewiki uses #cover directive to specify cover image.</li>
</ul></li>
<li><p>Docx reader (Jesse Rosenthal):</p>
<ul>
<li>Allow for insertion/deletion of paragraphs (#3927). If the paragraph has a deleted or inserted paragraph break (depending on the track-changes setting) we hold onto it until the next paragraph. This takes care of accept and reject. For this we introduce a new state which holds the ils from the previous para if necessary. For <code>--track-changes=all</code>, we add an empty span with class <code>paragraph-insertion</code>/<code>paragraph-deletion</code> at the end of the paragraph prior to the break to be inserted or deleted.</li>
<li>Remove unused anchors (#3679). Docx produces a lot of anchors with nothing pointing to them—we now remove these to produce cleaner output. Note that this has to occur at the end of the process because it has to follow link/anchor rewriting.</li>
<li>Read multiple children of <code>w:sdtContents</code>.</li>
<li>Combine adjacent anchors. There isn’t any reason to have numerous anchors in the same place, since we can’t maintain docx’s non-nesting overlapping. So we reduce to a single anchor.</li>
<li>Improved tests.</li>
</ul></li>
<li><p>Muse writer (Alexander Krotov): don’t escape URIs from AST</p></li>
<li><p>Docx writer:</p>
<ul>
<li>Removed redundant subtitle in title (Sebastian Talmon).</li>
<li><code>firstRow</code> table definition compatibility for Word 2016 (Sebastian Talmon). Word 2016 seems to use a default value of “1” for table headers, if there is no firstRow definition (although a default value of 0 is documented), so all tables get the first Row formatted as header. Setting the parameter to 0 if the table has no header row fixes this for Word 2016</li>
<li>Fix custom styles with spaces in the name (#3290).</li>
</ul></li>
<li><p>Powerpoint writer (Jesse Rosenthal):</p>
<ul>
<li>Ignore Notes div for parity with other slide outputs.</li>
<li>Set default slidelevel correctly. We had previously defaulted to slideLevel 2. Now we use the correct behavior of defaulting to the highest level header followed by content. We change an expected test result to match this behavior.</li>
<li>Split blocks correctly for linked images.</li>
<li>Combine adjacent runs.</li>
<li>Make inline code inherit code size. Previously (a) the code size wasn’t set when we force size, and (b) the properties was set from the default, instead of inheriting.</li>
<li>Simplify <code>replaceNamedChildren</code> function.</li>
<li>Allow linked images. The following markdown: <code>[![Image Title](image.jpg)](http://www.example.com)</code> will now produce a linked image in the resulting PowerPoint file.</li>
<li>Fix error with empty table cell. We require an empty <code>&lt;a:p&gt;</code> tag, even if the cell contains no paragraphs—otherwise PowerPoint complains of corruption.</li>
<li>Implement two-column slides. This uses the columns/column div format described in the pandoc manual. At the moment, only two columns (half the screen each) are allowed. Custom widths are not supported.</li>
<li>Added more tests.</li>
</ul></li>
<li><p>OpenDocument/ODT writers: improved rendering of formulas (#4170, oltolm).</p></li>
<li><p>Lua filters (Albert Krewinkel):</p>
<ul>
<li><code>data/pandoc.lua</code>: drop ‘pandoc-api-version’ from Pandoc objects</li>
<li>The current pandoc-types version is made available to Lua programs in the global <code>PANDOC_API_VERSION</code>. It contains the version as a list of numbers.</li>
<li>The pandoc version available as a global <code>PANDOC_VERSION</code> (a list of numbers).</li>
<li><code>data/pandoc.lua</code>: make <code>Attr</code> an <code>AstElement</code>.</li>
<li><code>data/pandoc.lua</code>: make all types subtypes of <code>AstElement</code>. <code>Pandoc</code>, <code>Meta</code>, and <code>Citation</code> were just plain functions and did not set a metatable on the returned value, which made it difficult to amend objects of these types with new behavior. They are now subtypes of AstElement, meaning that all their objects can gain new features when a method is added to the behavior object (e.g., <code>pandoc.Pandoc.behavior</code>).</li>
<li><p><code>data/pandoc.lua</code>: split type and behavior tables. Clearly distinguish between a type and the behavioral properties of an instance of that type. The behavior of a type (and all its subtypes) can now be amended by adding methods to that types <code>behavior</code> object, without exposing the type objects internals. E.g.:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode lua"><code class="sourceCode lua"><a class="sourceLine" id="cb2-1" data-line-number="1">pandoc<span class="ot">.</span>Inline<span class="ot">.</span>behavior<span class="ot">.</span>frob <span class="ot">=</span> <span class="kw">function</span> <span class="ot">()</span> print<span class="st">&#39;42&#39;</span> <span class="kw">end</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">local</span> str <span class="ot">=</span> pandoc<span class="ot">.</span>Str<span class="st">&#39;hello&#39;</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">str<span class="ot">.</span>frob<span class="ot">()</span> <span class="do">-- outputs &#39;42&#39;</span></a></code></pre></div></li>
<li><code>data/pandoc.lua</code>: fix Element inheritance. Extending all elements of a given type (e.g., all inline elements) was difficult, as the table used to lookup unknown methods would be reset every time a new element of that type was created, preventing recursive property lookup. This is was changed in that all methods and attributes of supertypes are now available to their subtypes.</li>
<li><code>data/pandoc.lua</code>: fix attribute names of Citation (#4222). The fields were named like the Haskell fields, not like the documented, shorter version. The names are changed to match the documentation and Citations are given a shared metatable to enable simple extensibility.</li>
<li><code>data/pandoc.lua</code>: drop function <code>pandoc.global_filter</code>.</li>
<li>Bump <code>hslua</code> version to 0.9.5. This version fixes a bug that made it difficult to handle failures while getting lists or a Map from Lua. A bug in pandoc, which made it necessary to always pass a tag when using MetaList or MetaBlock, is fixed as a result. Using the pandoc module’s constructor functions for these values is now optional (if still recommended).</li>
<li>Stop exporting <code>pushPandocModule</code> (API change). The introduction of <code>runPandocLua</code> renders direct use of this function obsolete.</li>
<li>Update generation of module docs for lua filters.</li>
<li><p><code>Lua.Module.Utils</code>: make stringify work on <code>MetaValues</code> (John MacFarlane). I’m sure this was intended in the first place, but currently only <code>Meta</code> is supported.</p></li>
</ul></li>
<li><p>Improve benchmarks.</p>
<ul>
<li>Set the default extensions properly.</li>
<li>Improve benchmark argument parsing. You can now say <code>make bench BENCHARGS=&quot;markdown latex reader&quot;</code> and both the markdown and latex readers will be benchmarked.</li>
</ul></li>
<li><p>MANUAL.txt simplify and add more structure (Mauro Bieg).</p></li>
<li><p>Generate README.md from template and MANUAL.txt. <code>make README.md</code> will generate the README.md after changes to MANUAL.txt have been made.</p></li>
<li><p>Update copyright notices to include 2018 (Albert Krewinkel).</p></li>
</ul>
<h1 id="pandoc-2.0.6-28-december-2017">pandoc 2.0.6 (28 December 2017)</h1>
<ul>
<li><p>Added <code>jats</code> as an input format.</p>
<ul>
<li>Add Text.Pandoc.Readers.JATS, exporting <code>readJATS</code> (API change) (Hamish Mackenzie).</li>
<li>Improved citation handling in JATS reader. JATS citations are now converted to pandoc citations, and JATS ref-lists are converted into a <code>references</code> field in metadata, suitable for use with pandoc-citeproc. Thus a JATS article with embedded bibliographic information can be processed with pandoc and pandoc-citeproc to produce a formatted bibliography.</li>
</ul></li>
<li><p>Allow <code>--list-extensions</code> to take an optional FORMAT argument. This lists the extensions set by default for the selected FORMAT. The extensions are now alphabetized, and the <code>+</code> or <code>-</code> indicating the default setting comes before, rather than after, the extension.</p></li>
<li><p>Markdown reader:</p>
<ul>
<li>Preserve original whitespace between blocks.</li>
<li>Recognize <code>\placeformula</code> as context.</li>
<li>Be pickier about table captions. A caption starts with a <code>:</code> which can’t be followed by punctuation. Otherwise we can falsely interpret the start of a fenced div, or even a table header line like <code>:--:|:--:</code>, as a caption.</li>
<li>Always use four space rule for example lists. It would be awkward to indent example list contents to the first non-space character after the label, since example list labels are often long. Thanks to Bernhard Fisseni for the suggestion.</li>
<li>Improve raw tex parsing. Note that the Markdown reader is also affected by the <code>latex_macros</code> extension changes described below under the LaTeX reader.</li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li><code>latex_macros</code> extension changes (#4179). Don’t pass through macro definitions themselves when <code>latex_macros</code> is set. The macros have already been applied. If <code>latex_macros</code> is enabled, then <code>rawLaTeXBlock</code> in Text.Pandoc.Readers.LaTeX will succeed in parsing a macro definition, and will update pandoc’s internal macro map accordingly, but the empty string will be returned.</li>
<li>Export <code>tokenize</code>, <code>untokenize</code> (API change).</li>
<li>Use <code>applyMacros</code> in <code>rawLaTeXBlock</code>, <code>rawLaTeXInline</code>.</li>
<li>Refactored <code>inlineCommand</code>.</li>
<li>Fix bug in tokenizer. Material following <code>^^</code> was dropped if it wasn’t a character escape. This only affected invalid LaTeX, so we didn’t see it in the wild, but it appeared in a QuickCheck test failure.</li>
<li>Fix regression in LateX tokenization (#4159). This mainly affects the Markdown reader when parsing raw LaTeX with escaped spaces.</li>
<li>Add tests of LaTeX tokenizer.</li>
<li>Support <code>\foreignlanguage</code> from babel.</li>
<li>Be more tolerant of <code>&amp;</code> character (#4208). This allows us to parse unknown tabular environments as raw LaTeX.</li>
</ul></li>
<li><p>Muse reader (Alexander Krotov):</p>
<ul>
<li>Parse anchors immediately after headings as IDs.</li>
<li>Require that note references does not start with 0.</li>
<li>Parse empty comments correctly.</li>
</ul></li>
<li><p>Org reader (Albert Krewinkel):</p>
<ul>
<li>Fix asterisks-related parsing error (#4180).</li>
<li>Support minlevel option for includes (#4154). The level of headers in included files can be shifted to a higher level by specifying a minimum header level via the <code>:minlevel</code> parameter. E.g. <code>#+include: &quot;tour.org&quot; :minlevel 1</code> will shift the headers in tour.org such that the topmost headers become level 1 headers.</li>
<li>Break-up org reader test file into multiple modules.</li>
</ul></li>
<li><p>OPML reader:</p>
<ul>
<li>Enable raw HTML and other extensions by default for notes (#4164). This fixes a regression in 2.0. Note that extensions can now be individually disabled, e.g. <code>-f opml-smart-raw_html</code>.</li>
</ul></li>
<li><p>RST reader:</p>
<ul>
<li>Allow empty list items (#4193).</li>
<li>More accurate parsing of references (#4156). Previously we erroneously included the enclosing backticks in a reference ID (#4156). This change also disables interpretation of syntax inside references, as in docutils. So, there is no emphasis in <code>`my *link*`_</code>.</li>
</ul></li>
<li><p>Docx reader:</p>
<ul>
<li>Continue lists after interruption (#4025, Jesse Rosenthal). Docx expects that lists will continue where they left off after an interruption and introduces a new id if a list is starting again. So we keep track of the state of lists and use them to define a “start” attribute, if necessary.</li>
<li>Add tests for structured document tags unwrapping (Jesse Rosenthal).</li>
<li>Preprocess Document body to unwrap <code>w:sdt</code> elements (Jesse Rosenthal, #4190).</li>
</ul></li>
<li><p>Plain writer:</p>
<ul>
<li>Don’t linkify table of contents.</li>
</ul></li>
<li><p>RST writer:</p>
<ul>
<li>Fix anchors for headers (#4188). We were missing an <code>_</code>.</li>
</ul></li>
<li><p>PowerPoint writer (Jesse Rosenthal):</p>
<ul>
<li>Treat lists inside BlockQuotes as lists. We don’t yet produce incremental lists in PowerPoint, but we should at least treat lists inside BlockQuotes as lists, for compatibility with other slide formats.</li>
<li>Add ability to force size. This replaces the more specific <code>blockQuote runProp</code>, which only affected the size of blockquotes. We can use this for notes, etc.</li>
<li>Implement notes. This currently prints all notes on a final slide. Note that at the moment, there is a danger of text overflowing the note slide, since there is no logic for adding further slides.</li>
<li>Implement basic definition list functionality to PowerPoint writer.</li>
<li>Don’t look for default template file for Powerpoint (#4181).</li>
<li>Add pptx to isTextFormat list. This is used to check standalone and not writing to the terminal.</li>
<li>Obey slide level option (Jesse Rosenthal).</li>
<li>Introduce tests.</li>
</ul></li>
<li><p>Docx writer:</p>
<ul>
<li>Ensure that <code>distArchive</code> is the one that comes with pandoc (#4182). Previously a <code>reference.docx</code> in <code>~/.pandoc</code> (or the user data dir) would be used instead, and this could cause problems because a user-modified docx sometimes lacks vital sections that we count on the <code>distArchive</code> to supply.</li>
</ul></li>
<li><p>Org writer:</p>
<ul>
<li>Do not wrap “-” to avoid accidental bullet lists (Alexander Krotov).</li>
<li>Don’t allow fn refs to wrap to beginning of line (#4171, with help from Alexander Krotov). Otherwise they can be interpreted as footnote definitions.</li>
</ul></li>
<li><p>Muse writer (Alexander Krotov):</p>
<ul>
<li>Don’t wrap note references to the next line (#4172).</li>
</ul></li>
<li><p>HTML writer:</p>
<ul>
<li>Use br elements in line blocks instead of relying on CSS (#4162). HTML-based templates have had the custom CSS for <code>div.line-block</code> removed. Those maintaining custom templates will want to remove this too. We still enclose line blocks in a div with class <code>line-block</code>.</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Use <code>\renewcommand</code> for <code>\textlatin</code> with babel (#4161). This avoids a clash with a deprecated <code>\textlatin</code> command defined in Babel.</li>
<li>Allow fragile=singleslide attribute in beamer slides (#4169).</li>
<li>Use <code>\endhead</code> after <code>\toprule</code> in headerless tables (#4207).</li>
</ul></li>
<li><p>FB2 writer:</p>
<ul>
<li>Add cover image specified by <code>cover-image</code> meta (Alexander Krotov, #4195).</li>
</ul></li>
<li><p>JATS writer (Hamish Mackenzie):</p>
<ul>
<li>Support writing <code>&lt;fig&gt;</code> and <code>&lt;table-wrap&gt;</code> elements with <code>&lt;title&gt;</code> and <code>&lt;caption&gt;</code> inside them by using Divs with class set to one of <code>fig</code>, <code>table-wrap</code> or <code>caption</code> (Hamish Mackenzie). The title is included as a Heading so the constraint on where Heading can occur is also relaxed.</li>
<li>Leave out empty alt attributes on links.</li>
<li>Deduplicate image mime type code.</li>
<li>Make <code>&lt;p&gt;</code> optional in <code>&lt;td&gt;</code> and <code>&lt;th&gt;</code> (#4178).</li>
<li>Self closing tags for empty xref (#4187).</li>
<li>Improve support for code language.</li>
</ul></li>
<li><p>Custom writer:</p>
<ul>
<li>Use init file to setup Lua interpreter (Albert Krewinkel). The same init file (<code>data/init</code>) that is used to setup the Lua interpreter for Lua filters is also used to setup the interpreter of custom writers.lua.</li>
<li>Define instances for newtype wrapper (Albert Krewinkel). The custom writer used its own <code>ToLuaStack</code> instance definitions, which made it difficult to share code with Lua filters, as this could result in conflicting instances. A <code>Stringify</code> wrapper is introduced to avoid this problem.</li>
<li>Added tests for custom writer.</li>
<li>Fixed definition lists and tables in <code>data/sample.lua</code>.</li>
</ul></li>
<li><p>Fixed regression: when target is PDF, writer extensions were being ignored. So, for example, <code>pandoc -t latex-smart -o file.pdf</code> did not work properly.</p></li>
<li><p>Lua modules (Albert Krewinkel):</p>
<ul>
<li>Add <code>pandoc.utils</code> module, to hold utility functions.</li>
<li>Create a Haskell module Text.Pandoc.Lua.Module.Pandoc to define the <code>pandoc</code> lua module.</li>
<li>Make a Haskell module for each Lua module. Move definitions for the <code>pandoc.mediabag</code> modules to a separate Haskell module.</li>
<li>Move <code>sha1</code> from the main <code>pandoc</code> module to <code>pandoc.utils</code>.</li>
<li>Add function <code>pandoc.utils.hierarchicalize</code> (convert list of Pandoc blocks into (hierarchical) list of Elements).</li>
<li>Add function <code>pandoc.utils.normalize_date</code> (parses a date and converts it (if possible) to “YYYY-MM-DD” format).</li>
<li>Add function <code>pandoc.utils.to_roman_numeral</code> (allows conversion of numbers below 4000 into roman numerals).</li>
<li>Add function <code>pandoc.utils.stringify</code> (converts any AST element to a string with formatting removed).</li>
<li><code>data/init.lua</code>: load <code>pandoc.utils</code> by default</li>
<li>Turn pipe, read into full Haskell functions. The <code>pipe</code> and <code>read</code> utility functions are converted from hybrid lua/haskell functions into full Haskell functions. This avoids the need for intermediate <code>_pipe</code>/<code>_read</code> helper functions, which have dropped.</li>
<li>pandoc.lua: re-add missing MetaMap function. This was a bug introduced in version 2.0.4.</li>
</ul></li>
<li><p>Text.Pandoc.Class: Add <code>insertInFileTree</code> [API change]. This gives a pure way to insert an ersatz file into a <code>FileTree</code>. In addition, we normalize paths both on insertion and on lookup.</p></li>
<li><p>Text.Pandoc.Shared: export <code>blocksToInlines'</code> (API change, Maura Bieg).</p></li>
<li><p>Text.Pandoc.MIME: Add opus to MIME type table as audio/ogg (#4198).</p></li>
<li><p>Text.Pandoc.Extensions: Alphabetical order constructors for <code>Extension</code>. This makes them appear in order in <code>--list-extensions</code>.</p></li>
<li><p>Allow lenient decoding of latex error logs, which are not always properly UTF8-encoded (#4200).</p></li>
<li><p>Update latex template to work with recent versions of beamer. The old template produced numbered sections with some recent versions of beamer. Thanks to Thomas Hodgson.</p></li>
<li><p>Updated reference.docx (#4175). Instead of just “Hello, world”, the document now contains exemplars of most of the styles that have an effect on pandoc documents. This makes it easier to see the effect of style changes.</p></li>
<li><p>Removed <code>default.theme</code> data file (#4096). It is no longer needed now that we have <code>--print-highlight-style</code>.</p></li>
<li><p>Added <code>stack.lts9.yaml</code> for building with lts 9 and ghc 8.0.2. We still need this for the alpine static linux build, since we don’t have ghc 8.2.2 for that yet.</p></li>
<li><p>Removed <code>stack.pkg.yaml</code>. We only really need <code>stack.yaml</code>; we can put flag settings for pandoc-citeproc there.</p></li>
<li><p>Makefile: Add ‘trypandoc’ and ‘pandoc-templates’ targets to make releases easier.</p></li>
<li><p>MANUAL.txt:</p>
<ul>
<li>Add note on what formats have <code>+smart</code> by default.</li>
<li>Use native syntax for custom-style (#4174, Mauro Bieg).</li>
<li>Introduce dedicated Extensions section, since some extensions affect formats other than markdown (Mauro Bieg, #4204).</li>
<li>Clarify default html output for <code>--section-divs</code> (Richard Edwards).</li>
</ul></li>
<li><p>filters.md: say that Text.Pandoc.JSON comes form pandoc-types. Closes jgm/pandoc-website#16.</p></li>
<li><p>epub.md: Delete removed <code>-S</code> option from command (#4151, Georger Araújo).</p></li>
</ul>
<h1 id="pandoc-2.0.5-12-december-2017">pandoc 2.0.5 (12 December 2017)</h1>
<ul>
<li><p>Fix a bug in 2.0.4, whereby pandoc could not read the theme files generated with <code>--print-highlight-style</code> (#4133). Improve JSON serialization of styles.</p></li>
<li><p>Fix CSS issues involving line numbers (#4128). Highlighted code blocks are now enclosed in a div with class <code>sourceCode</code>. Highlighting CSS no longer sets a generic color for pre and code; we only set these for class <code>sourceCode</code>.</p></li>
<li><p><code>--pdf-engine-opt</code>: fix bug where option order was reversed (#4137).</p></li>
<li><p>Add PowerPoint (pptx) writer (Jesse Rosenthal). It works following the standard Pandoc conventions for making other sorts of slides. Caveats:</p>
<ul>
<li>Syntax highlighting is not yet implemented. (This is difficult because there are no character classes in Powerpoint.)</li>
<li>Footnotes and Definition lists are not yet implemented. (Notes will usually take the form of a final slide.</li>
<li>Image placement and auto-resizing has a few glitches.</li>
<li>Reference powerpoint files don’t work dependably from the command line. This will be implemented, but at the moment users are advised to change themes from within Powerpoint.</li>
</ul></li>
<li><p>Create shared Text.Pandoc.Writers.OOXML module (Jesse Rosenthal). This is for functions used by both Powerpoint and Docx writers.</p></li>
<li><p>Add default pptx data for Powerpoint writer (Jesse Rosenthal).</p></li>
<li><p>Add <code>empty_paragraphs</code> extension.</p>
<ul>
<li>Deprecate <code>--strip-empty-paragraphs</code> option. Instead we now use an <code>empty_paragraphs</code> extension that can be enabled on the reader or writer. By default, disabled.</li>
<li>Add <code>Ext_empty_paragraphs</code> constructor to <code>Extension</code>.</li>
<li>Revert “Docx reader: don’t strip out empty paragraphs.” This reverts commit d6c58eb836f033a48955796de4d9ffb3b30e297b.</li>
<li>Implement <code>empty_paragraphs</code> extension in docx reader and writer, opendocument writer, html reader and writer.</li>
<li>Add tests for <code>empty_paragraphs</code> extension.</li>
</ul></li>
<li><p>Markdown reader:</p>
<ul>
<li>Don’t parse native div as table caption (#4119).</li>
<li>Improved computation of column widths in pipe tables. Pipe tables with lines longer than the text width (as set by <code>--columns</code>) are now scaled to text width, with the relative widths of columns determined by the ratios between the header lines. Previously we computed column widths using the ratio of header line lengths to column width, so that tables with narrow header lines were extremely thin, which was very rarely the desired result.</li>
</ul></li>
<li><p>LaTeX reader: fix <code>\</code> before newline (#4134). This should be a space, as long as it’s not followed by a blank line. This has been fixed at the tokenizer level.</p></li>
<li><p>Muse reader (Alexander Krotov):</p>
<ul>
<li>Add test for <code>#disable-tables</code> directive in Emacs mode.</li>
<li>Don’t allow emphasis to be preceded by letter.</li>
<li>Add underline support in Emacs Muse mode..</li>
<li>Support multiline directives in Amusewiki mode</li>
</ul></li>
<li><p>Man writer: omit internal links (#4136). That is, just print the link text without the URL.</p></li>
<li><p>Markdown reader: accept processing instructions as raw HTML (#4125).</p></li>
<li><p>Lua filters (Albert Krewinkel):</p>
<ul>
<li>Use script to initialize the interpreter. The file <code>init.lua</code> is used to initialize the Lua interpreter which is used in Lua filters. This gives users the option to require libraries which they want to use in all of their filters, and to extend default modules.</li>
<li>Fix package loading for Lua 5.1. The list of package searchers is named <code>package.loaders</code> in Lua 5.1 and LuaJIT, and <code>package.searchers</code> in Lua 5.2 and later.</li>
<li>Refactor lua module handling. The integration with Lua’s package/module system is improved: A pandoc-specific package searcher is prepended to the searchers in <code>package.searchers</code>. The modules <code>pandoc</code> and <code>pandoc.mediabag</code> can now be loaded via <code>require</code>.</li>
<li>Bump lower bound of hslua. The release hslua 0.9.3 contains a new function which makes using Haskell functions as package loaders much easier.</li>
</ul></li>
<li><p>reveal.js template: add title-slide identifier to title slide (#4120). This allows it to be styled more easily.</p></li>
<li><p>LaTeX template: Added support for <code>pagestyle</code> variable (#4135, Thomas Hodgson)</p></li>
<li><p>Add <code>-threaded</code> to ghc-options for executable (#4130, fixes a build error on linux).</p></li>
</ul>
<h1 id="pandoc-2.0.4-03-december-2017">pandoc 2.0.4 (03 December 2017)</h1>
<ul>
<li><p>Add <code>--print-highlight-style</code> option. This generates a JSON version of a highlighting style, which can be saved as a <code>.theme</code> file, modified, and used with <code>--highlight-style</code> (#4106, #4096).</p></li>
<li><p>Add <code>--strip-empty-paragraphs</code> option. This works for any input format. It is primarily intended for use with docx and odt documents where empty paragraphs have been used for inter-paragraph spaces.</p></li>
<li><p>Support <code>--webtex</code> for <code>gfm</code> output.</p></li>
<li><p>Recognize <code>.muse</code> file extension.</p></li>
<li><p>Support beamer <code>\alert</code> in LaTeX reader. Closes #4091.</p></li>
<li><p>Docx reader: don’t strip out empty paragraphs (#2252). Users who have a conversion pipeline from docx may want to consider adding <code>--strip-empty-paragraphs</code> to the command line.</p></li>
<li><p>Org reader (Albert Krewinkel): Allow empty list items (#4090).</p></li>
<li><p>Muse reader (Alexander Krotov):</p>
<ul>
<li>Parse markup in definition list terms.</li>
<li>Allow definition to end with EOF.</li>
<li>Make code blocks round trip.</li>
<li>Drop common space prefix from list items.</li>
<li>Add partial round trip test.</li>
<li>Don’t interpret XML entities.</li>
<li>Remove <code>nested</code>.</li>
<li>Parse <code>~~</code> as non-breaking space in Emacs mode.</li>
<li>Correctly remove indentation from notes. Exactly one space is required and considered to be part of the marker.</li>
<li>Allow list items to be empty.</li>
<li>Add ordered list test.</li>
<li>Add more multiline definition tests.</li>
<li>Don’t allow blockquotes within lists.</li>
<li>Fix reading of multiline definitions.</li>
<li>Add inline <code>&lt;literal&gt;</code> support.</li>
<li>Concatenate inlines of the same type</li>
</ul></li>
<li><p>Docx writer: allow empty paragraphs (#2252).</p></li>
<li><p>CommonMark/gfm writer:</p>
<ul>
<li>Use raw html for native divs/spans (#4113). This allows a pandoc markdown native div or span to be rendered in gfm using raw html tags.</li>
<li>Implement <code>raw_html</code> and <code>raw_tex</code> extensions. Note that <code>raw_html</code> is enabled by default for <code>gfm</code>, while <code>raw_tex</code> is disabled by default.</li>
</ul></li>
<li><p>Muse writer (Alexander Krotov):</p>
<ul>
<li>Test that inline math conversion result is normalized. Without normalization this test produced <code>&lt;em&gt;a&lt;/em&gt;&lt;em&gt;b&lt;/em&gt;&lt;em&gt;c&lt;/em&gt;</code>.</li>
<li>Improve inline list normalization and move to writer.</li>
<li>Escape hash symbol.</li>
<li>Escape <code>----</code> to avoid accidental horizontal rules.</li>
<li>Escape only <code>&lt;/code&gt;</code> inside code tag.</li>
<li>Additional <code>&lt;verbatim&gt;</code> is not needed as <code>&lt;code&gt;</code> is verbatim already.</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Allow specifying just width or height for image size. Previously both needed to be specified (unless the image was being resized to be smaller than its original size). If height but not width is specified, we now set width to textwidth. If width but not height is specified, we now set height to textheight. Since we have <code>keepaspectratio</code>, this yields the desired result.</li>
<li>Escape <code>~</code> and <code>_</code> in code with <code>--listings</code> (#4111).</li>
</ul></li>
<li><p>HTML writer: export <code>tagWithAttributes</code>. This is a helper allowing other writers to create single HTML tags.</p></li>
<li><p>Let papersizes <code>a0</code>, <code>a1</code>, <code>a2</code>, … be case-insensitive by converting the case as needed in LaTeX and ConTeXt writers.</p></li>
<li><p>Change <code>fixDisplayMath</code> from <code>Text.Pandoc.Writers.Shared</code> so that it no longer produces empty <code>Para</code>’s as an artifact.</p></li>
<li><p><code>Text.Pandoc.Shared.blocksToInlines</code>: rewrote using builder. This gives us automatic normalization, so we don’t get for example two consecutive Spaces.</p></li>
<li><p>Include default CSS for ‘underline’ class in HTML-based templates.</p></li>
<li><p>revealjs template: add <code>tex2jax</code> configuration for the math plugin. With the next release of reveal.js, this will fix the problem of <code>$</code>s outside of math contexts being interpreted as math delimiters (#4027).</p></li>
<li><p><code>pandoc.lua</code> module for use in lua filters (Albert Krewinkel):</p>
<ul>
<li><p>Add basic lua List module (#4099, #4081). The List module is automatically loaded, but not assigned to a global variable. It can be included in filters by calling <code>List = require 'List'</code>. Lists of blocks, lists of inlines, and lists of classes are now given <code>List</code> as a metatable, making working with them more convenient. E.g., it is now possible to concatenate lists of inlines using Lua’s concatenation operator <code>..</code> (requires at least one of the operants to have <code>List</code> as a metatable):</p>
<pre><code>function Emph (emph)
  local s = {pandoc.Space(), pandoc.Str &#39;emphasized&#39;}
  return pandoc.Span(emph.content .. s)
end</code></pre>
The <code>List</code> metatable is assigned to the tables which get passed to the constructors <code>MetaBlocks</code>, <code>MetaInline</code>, and <code>MetaList</code>. This enables the use of the resulting objects as lists.</li>
<li><code>Lua/StackInstances</code>: push Pandoc and Meta via constructor. Pandoc and Meta elements are now pushed by calling the respective constructor functions of the pandoc Lua module. This makes serialization consistent with the way blocks and inlines are pushed to lua and allows to use List methods with the <code>blocks</code> value.</li>
<li><p>Add documentation for pandoc.List in <code>lua-filters.md</code>.</p></li>
</ul></li>
<li><p>Use latest tagsoup. This fixes a bug in parsing HTML tags with <code>&amp;</code> (but not a valid entity) following them (#4094, #4088).</p></li>
<li><p>Use skylighting 0.4.4.1, fixing the color of unmarked code text when <code>numberLines</code> is used (#4103).</p></li>
<li><p>Make <code>normalizeDate</code> more forgiving (Mauro Bieg, #4101), not requiring a leading 0 on single-digit days.</p></li>
<li><p>Fix <code>--help</code> output for <code>--highlight-style</code> to include <code>FILE</code> (Mauro Bieg, #4095).</p></li>
<li><p>Clearer deprecation warning for <code>--latexmathml, --asciimathml, -m</code>. Previously we only mentioned <code>--latexmathml</code>, even if <code>-m</code> was used.</p></li>
<li><p>Changelog: fix description of lua filters in 2.0 release (Albert Krewinkel). Lua filters were initially run <em>after</em> conventional (JSON) filters. However, this was changed later to make it easier to deal with files in the mediabag. The changelog is updated to describe that feature of the 2.0 release correctly.</p></li>
<li><p>Change Generic JSON instances to TemplateHaskell (Jasper Van der Jeugt, #4085). This reduces compile time and memory usage significantly.</p></li>
<li><p><code>lua-filters.md</code>: Added tikz filter example.</p></li>
<li><p>Create alternative zip file for macOS binaries.</p></li>
<li><p>Create alternative zip file for Windows binaries.</p></li>
<li><p>Update INSTALL.md since we now provide zips for binaries.</p></li>
<li><p>Relax <code>http-types</code> dependency (Justus Sagemüller, #4084).</p></li>
<li><p>Add <code>epub.md</code>, <code>getting-started.md</code> to docs. These used to live in the website repo.</p></li>
<li><p>Add <code>packages</code> target to Makefile.</p></li>
<li><p>Bump bounds for binary, http-types, tasty-hunit</p></li>
</ul>
<h1 id="pandoc-2.0.3-20-november-2017">pandoc 2.0.3 (20 November 2017)</h1>
<ul>
<li><p>Lua filters: preload text module (Albert Krewinkel, #4077). The <code>text</code> module is preloaded in lua. The module contains some UTF-8 aware string functions, implemented in Haskell. The module is loaded on request only, e.g.:</p>
<pre><code>text = require &#39;text&#39;
function Str (s)
  s.text = text.upper(s.text)
  return s
end</code></pre></li>
<li><p>Allow table-like access to attributes in lua filters (Albert Krewinkel, #4071). Attribute lists are represented as associative lists in Lua. Pure associative lists are awkward to work with. A metatable is attached to attribute lists, allowing to access and use the associative list as if the attributes were stored in as normal key-value pair in table. Note that this changes the way <code>pairs</code> works on attribute lists. Instead of producing integer keys and two-element tables, the resulting iterator function now returns the key and value of those pairs. Use <code>ipairs</code> to get the old behavior. Warning: the new iteration mechanism only works if pandoc has been compiled with Lua 5.2 or later (current default: 5.3).</p></li>
<li><p>Text.Pandoc.Parsing.uri: allow <code>&amp;</code> and <code>=</code> as word characters (#4068). This fixes a bug where pandoc would stop parsing a URI with an empty attribute: for example, <code>&amp;a=&amp;b=</code> wolud stop at <code>a</code>. (The uri parser tries to guess which punctuation characters are part of the URI and which might be punctuation after it.)</p></li>
<li><p>Introduce <code>HasSyntaxExtensions</code> typeclass (Alexander Krotov, #4074).</p>
<ul>
<li>Added new <code>HasSyntaxExtensions</code> typeclass for <code>ReaderOptions</code> and <code>WriterOptions</code>.</li>
<li>Reimplemented <code>isEnabled</code> function from <code>Options.hs</code> to accept both <code>ReaderOptions</code> and <code>WriterOptions</code>.</li>
<li>Replaced <code>enabled</code> from <code>CommonMark.hs</code> with new <code>isEnabled</code>.</li>
</ul></li>
<li><p>Add <code>amuse</code> extension (Alexander Krotov) to enable Amuse wiki behavior for <code>muse</code>. New <code>Ext_amuse</code> constructor for <code>Extension</code>. Note: this is switched on by default; for Emacs behavior, use <code>muse-amuse</code>.</p></li>
<li><p>Muse reader (Alexander Krotov):</p>
<ul>
<li>Count only one space as part of list item marker.</li>
<li>Produce SoftBreaks on newlines. Now wrapping can be preserved with <code>--wrap=preserve</code>.</li>
<li>Add Text::Amuse footnote extensions. Footnote end is indicated by indentation, so footnotes can be placed anywhere in the text, not just at the end of it.</li>
<li>Accept Emacs Muse definition lists when <code>-amuse</code>. Emacs Muse does not require indentation.</li>
</ul></li>
<li><p>HTML reader:</p>
<ul>
<li>Ensure we don’t produce level 0 headers (#4076), even for chapter sections in epubs. This causes problems because writers aren’t set up to expect these.</li>
<li>Allow spaces after <code>\(</code> and before <code>\)</code> with <code>tex_math_single_backslash</code>. Previously <code>\( \frac{1}{a} &lt; \frac{1}{b} \)</code> was not parsed as math in <code>markdown</code> or <code>html</code> <code>+tex_math_single_backslash</code>.</li>
</ul></li>
<li><p>MANUAL: clarify that math extensions work with HTML. Clarify that <code>tex_math_dollars</code> and <code>tex_math_single_backslash</code> will work with HTML as well as Markdown.</p></li>
<li><p>Creole reader: Fix performance issue for longer lists (Sascha Wilde, #4067).</p></li>
<li><p>RST reader: better support for ‘container’ directive (#4066). Create a div, incorporate name attribute and classes.</p></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Support column specs like <code>*{2}{r}</code> (#4056). This is equivalent to <code>rr</code>. We now expand it like a macro.</li>
<li>Allow optional args for parbox (#4056).</li>
<li>Allow optional arguments on <code>\footnote</code> (#4062).</li>
</ul></li>
<li><p>EPUB writer: Fixed path for cover image (#4069). It was previously <code>media/media/imagename</code>, and should have been <code>media/imagename</code>.</p></li>
<li><p>Markdown writer: fix bug with doubled footnotes in grid tables (#4061).</p></li>
<li><p>LaTeX template: include natbib/biblatex after polyglossia (#4073). Otherwise we seem to get an error; biblatex wants polyglossia language to be defined.</p></li>
<li><p>Added examples to lua filters documentation.</p></li>
</ul>
<h1 id="pandoc-2.0.2-12-november-2017">pandoc 2.0.2 (12 November 2017)</h1>
<ul>
<li><p>Deprecated ancient HTML math methods: <code>--latexmathml</code>, <code>--gladtex</code>, <code>--mimetex</code>, <code>--jsmath</code>.</p></li>
<li><p>Fixed URIs in <code>data/jats.csl</code>. They were being rendered twice, leading to invalid XML in default JATS output with pandoc-citeproc.</p></li>
<li><p><code>lua-filters.md</code>: use real-world man page filter as example.</p></li>
<li><p>Add lua filter functions <code>walk_inline</code> and <code>walk_block</code> in the pandoc module, to apply filters inside particular inline and block elements.</p></li>
<li><p>Refactored some code from <code>Text.Pandoc.Lua.PandocModule</code> into new internal module <code>Text.Pandoc.Lua.Filter</code>.</p></li>
<li><p>Markdown reader:</p>
<ul>
<li>Allow fenced code blocks to be indented 1-3 spaces (#4011). This brings our handling of them into alignment with CommonMark’s.</li>
<li>Fix YAML metadata with “chomp” (<code>|-</code>). Previously if a YAML block under <code>|-</code> contained a blank line, pandoc would not parse it as metadata.</li>
</ul></li>
<li><p>Removed <code>etc.</code> from abbreviations file. Often <code>etc.</code> ends a sentence, and we want the period to be treated as a sentence-ending period.</p></li>
<li><p>Fix regression with <code>--metadata</code> (#4054). Values specified with <code>--metadata</code> should replace a metadata value set in the document itself, rather than creating a list including a new value.</p></li>
<li><p>EPUB writer:</p>
<ul>
<li>Fix EPUB OCF structure. #3720 had been improperly implemented.</li>
<li>Fix modified paths for raw HTML tags (src, poster, etc.) (#4050, #4055). This had not been updated for the new EPUB container layout, with a separate text/ subdirectory.</li>
<li>Fix image paths with empty <code>--epub-subdirectory</code>.</li>
</ul></li>
<li><p>Miscellaneous code cleanup (Alexander Krotov).</p></li>
<li><p>Use pandoc-types 1.17.3, which adds <code>Walkable</code> instances for <code>[Block] Block</code> and <code>[Inline] Inline</code>.</p></li>
<li><p>Remove obsolete <code>stack.full.yaml</code> (#4052).</p></li>
<li><p>Change to using pandoc-citeproc 0.12.1 in binary packages.</p></li>
<li><p>Consolidate math output method documentation (#4049, Mauro Bieg).</p></li>
<li><p><code>MANUAL.txt</code>: fix header level of “Extension: emoji” (Albert Krewinkel).</p></li>
<li><p>Use lua filter to generate man page from <code>MANUAL.txt</code>, replacing old Haskell filters. This is easier and faster.</p></li>
<li><p>Improved <code>INSTALL.md</code>.</p></li>
<li><p>Update commands to extract deb archive on Linux (#4043, Salim B).</p></li>
</ul>
<h1 id="pandoc-2.0.1.1-04-november-2017">pandoc 2.0.1.1 (04 November 2017)</h1>
<ul>
<li><p>Improved fix to #3989 (parsing of HTML tags containing <code>&gt;</code> in an attribute or comment). The previous fix (in 2.0.1) only worked in certain cases.</p></li>
<li><p>FB2 writer (Alexander Krotov):</p>
<ul>
<li>Add <code>unrecognised</code> genre to <code>&lt;title-info&gt;</code> (Alexander Krotov). XML schema requires at least one genre.</li>
<li>Remove <code>&lt;annotation&gt;</code> from <code>&lt;body&gt;</code>.</li>
</ul></li>
<li><p>CommonMark writer: fix strikethrough for <code>gfm</code> (#4038).</p></li>
<li><p>Use texmath 0.10, which adds support for a wider range of symbols and fixes default column alignments in MathML and OMML.</p></li>
<li><p>Highlighting fixes, using skylighting 0.4.3.2:</p>
<ul>
<li>Fix invalid CSS.</li>
<li>Support <code>lineAnchors</code> (or <code>line-anchors</code>) in HTML code blocks.</li>
<li>Ensure that code lines don’t get duplicate identifiers (#4031). The line identifiers are built using the code block’s identifier as a prefix. If the code block has null identifier, we use <code>cb1</code>, <code>cb2</code>, etc.</li>
</ul></li>
<li><p>Added a few abbreviations to <code>data/abbreviations</code>, and sorted the list (#3984, Wandmalfarbe).</p></li>
<li><p>Improved support for columns in HTML writer (#4028).</p>
<ul>
<li>Remove <code>width</code> attribute from the <code>div</code>.</li>
<li>Remove space between <code>&lt;div class=&quot;column&quot;&gt;</code> elements, since this prevents columns whose widths sum to 100% (the space takes up space).</li>
<li>Move as much as possible of the CSS to the template.</li>
<li>Ensure that all the HTML-based templates (including epub) contain the CSS for columns.</li>
<li>Columns default to 50% width unless they are given a width attribute. So if you want two equal-width columns, you can use a div with class <code>column</code> and no <code>width</code> attribute.</li>
</ul></li>
<li><p>SelfContained: use <code>base64</code> for css links with media attribute (#4026). This fixes <code>--self-contained</code> with S5.</p></li>
<li><p>Improve <code>pandoc-template-mode.el</code> (Vaclav Haisman).</p></li>
<li><p>INSTALL.md: MacOS instructions needed xar -f (adam234).</p></li>
<li><p>MANUAL.txt:</p>
<ul>
<li>Clarify that –setext-headers doesn’t affect gfm output (#4035).</li>
<li>Clarify what is needed to open and close a div in <code>fenced_divs</code> (#4039, Tristano Ajmone).</li>
<li>Removed reference to <code>default.beamer</code> in docs (#4024). Also added mention of other templates affecting PDF output with different settings.</li>
</ul></li>
</ul>
<h1 id="pandoc-2.0.1-31-october-2017">pandoc 2.0.1 (31 October 2017)</h1>
<ul>
<li><p>Fixed regression in parsing of HTML comments in markdown and other non-HTML formats (<code>Text.Pandoc.Readers.HTML.htmlTag</code>) (#4019). The parser stopped at the first <code>&gt;</code> character, even if it wasn’t the end of the comment.</p></li>
<li><p>Creole reader (Sascha Wilde):</p>
<ul>
<li>Fix some minor typos and formatting.</li>
<li>Add additional test on nowiki-block after para.</li>
<li>Fix lists with trailing white space.</li>
</ul></li>
<li><p>LaTeX reader: handle <code>%</code> comment right after command. For example, <code>\emph%</code>.</p></li>
<li><p>Markdown reader: make sure fenced div closers work in lists. Previously the following failed:</p>
<pre><code>::: {.class}
1. one
2. two
:::</code></pre>
<p>and you needed a blank line before the closing <code>:::</code>.</p></li>
<li><p>Make <code>fenced_divs</code> affect the Markdown writer. If <code>fenced_divs</code> is enabled, Divs will be rendered as fenced divs.</p></li>
<li><p>LaTeX/Beamer writer: support “blocks” inside columns and other Divs (#4016).</p></li>
<li><p>HTML Writer: consistently use dashed class-names (Mauro Bieg, #3556). Note: this change may require some changes in CSS rules. <code>footnoteRef</code> has become <code>footnote-ref</code>, <code>titleslide</code> has become <code>title-slide</code>, and <code>footnoteBack</code> has become <code>footnote-back</code>.</p></li>
<li><p>JATS writer: Properly pass through author metadata (#4020).</p></li>
<li><p>FB2 writer (Alexander Krotov):</p>
<ul>
<li>Write blocks outside of <code>&lt;p&gt;</code> in definitions.</li>
<li>Make bullet lists consistent with ordered lists, repeating the marker for the outer list rather than indenting sublists, since indentation does not work in readers.</li>
<li>Add new style FB2 tests.</li>
</ul></li>
<li><p><code>Text.Pandoc.ImageSize</code>: Add <code>Millimeter</code> constructor to <code>Dimension</code> (#4012) [API change]. Now sizes given in ‘mm’ are no longer converted to ‘cm’.</p></li>
<li><p>Revise documentation of small caps syntax (Andrew Dunning, #4013).</p></li>
<li><p>Fix broken reference links in manual (Andrew Dunning, #4014)</p></li>
<li><p>Fixed example of slide columns structure in changelog (#4015). Also documented this feature in MANUAL.txt.</p></li>
</ul>
<h1 id="pandoc-2.0.0.1-30-oct-2017">pandoc 2.0.0.1 (30 Oct 2017)</h1>
<ul>
<li><p>EPUB writer:</p>
<ul>
<li>Fixed filepaths for nonstandard epub-subdirectory values.</li>
<li>Ensure that epub2 is recognized as a non-text format, so that a template is used.</li>
<li>Don’t include “prefix” attribute for ibooks for epub2. It doesn’t validate.</li>
<li>Fix stylesheet paths; previously we had an incorrect stylesheet path for the cover page and nav page.</li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Insert space when needed in macro expansion (#4007). Sometimes we need to insert a space after a control sequence to prevent it merging with a following letter.</li>
<li>Allow unbraced arguments for macros (#4007).</li>
<li>Allow body of macro definition to be unbraced (#4007).</li>
</ul></li>
<li><p>Linux package build: ensure that pandoc-citeproc is statically linked.</p></li>
<li><p>trypandoc: add native, ms.</p></li>
</ul>
<h1 id="pandoc-2.0-29-oct-2017">pandoc 2.0 (29 Oct 2017)</h1>
<h2 id="new-features">New features</h2>
<ul>
<li><p>New output format <code>ms</code> (groff ms). Complete support, including tables, math, syntax highlighting, and PDF bookmarks. The writer uses texmath’s new eqn writer to convert math to eqn format, so a ms file produced with this writer should be processed with <code>groff -ms -e</code> if it contains math.</p></li>
<li><p>New output format <code>jats</code> (Journal Article Tag Suite). This is an XML format used in archiving and publishing articles. Note that a URI-encoded CSL stylesheet (<code>data/jats.csl</code>) is added automatically unless a stylesheet is specified using <code>--css</code>.</p></li>
<li><p>New output format <code>gfm</code> (GitHub-flavored CommonMark) (#3841). This uses bindings to GitHub’s fork of cmark, so it should parse gfm exactly as GitHub does (excepting certain postprocessing steps, involving notifications, emojis, etc.). <code>markdown_github</code> has been deprecated in favor of <code>gfm</code>.</p></li>
<li><p>New output format <code>muse</code> (Emacs Muse) (Alexander Krotov, #3489).</p></li>
<li><p>New input format <code>gfm</code> (GitHub-flavored CommonMark) (#3841). This uses bindings to GitHub’s fork of cmark. <code>markdown_github</code> has been deprecated in favor of <code>gfm</code>.</p></li>
<li><p>New input format <code>muse</code> (Emacs Muse) reader (Alexander Krotov, #3620).</p></li>
<li><p>New input format <code>tikiwiki</code> (TikiWiki markup) (rlpowell, #3800).</p></li>
<li><p>New input format <code>vimwiki</code> (Vimwiki markup) (Yuchen Pei, #3705). Note that there is a new data file, <code>data/vimwiki.css</code>, which can be used to display the HTML produced by this reader and pandoc’s HTML writer in the style of vimwiki’s own HTML export.</p></li>
<li><p>New input format <code>creole</code> (Creole 1.0) (#3994, Sascha Wilde).</p></li>
<li><p>New syntax for Divs, with <code>fenced_divs</code> extension enabled by default (#168). This gives an attractive, plain-text way to create containers for block-level content.</p></li>
<li><p>Added new syntax for including raw content in any output format, enabled by the <code>raw_attribute</code> extension (which is on by default for <code>markdown</code> and <code>multimarkdown</code>). The syntax is the same as for fenced code blocks or code inlines, only with <code>{=FORMAT}</code> for attributes, where <code>FORMAT</code> is the name of the output format (e.g., <code>ms</code>, <code>html</code>).</p></li>
<li><p>Implement multicolumn support for slide formats (#1710). The structure expected is:</p>
<pre><code>:::::::::::::: {.columns}
::: {.column width=&quot;40%&quot;}
contents...
:::
::: {.column width=&quot;60%&quot;}
contents...
:::
::::::::::::::</code></pre>
<p>Support has been added for beamer and all HTML slide formats.</p></li>
<li><p>Allows line comments in templates, beginning with <code>$--</code> (#3806). (Requires doctemplates 0.2.1.)</p></li>
<li><p>Add <code>--eol=crlf|lf|native</code> flag and writer option to control line endings (Stefan Dresselhaus, #3663, #2097).</p></li>
<li><p>Add <code>--log</code> option to save log messages in JSON format to a file (#3392).</p></li>
<li><p>Add <code>--request-header</code> option, to set request headers when pandoc makes HTTP requests to fetch external resources. For example: <code>--request-header User-Agent:blah</code>.</p></li>
<li><p>Added lua filters (Albert Krewinkel, #3514). The new <code>--lua-filter</code> option works like <code>--filter</code> but takes pathnames of special lua filters and uses the lua interpreter baked into pandoc, so that no external interpreter is needed. Note that lua filters are all applied after regular filters, regardless of their position on the command line. For documentation of lua filters, see <code>doc/lua-filters.md</code>.</p></li>
<li><p>Set <code>PANDOC_READER_OPTIONS</code> in environment where filters are run. This contains a JSON representation of <code>ReaderOptions</code>, so filters can access it.</p></li>
<li><p>Support creation of pdf via groff <code>ms</code> and pdfroff. <code>pandoc -t ms -o output.pdf input.txt</code>.</p></li>
<li><p>Support for PDF generation via HTML and <code>weasyprint</code> or <code>prince</code> (Mauro Bieg, #3909). <code>pandoc -t html5 -o output.pdf --pdf-engine=prince</code>.</p></li>
<li><p>Added <code>--epub-subdirectory</code> option (#3720). This specifies the subdirectory in the OCF container that holds the EPUB specific content. We now put all EPUB related content in an <code>EPUB/</code> subdirectory by default (later this will be configurable).</p>
<pre><code>  mimetype
  META-INF/
    com.apple.ibooks.display-options.xml
    container.xml
  EPUB/ &lt;&lt;--configurable--&gt;&gt;
    fonts/ &lt;&lt;--static--&gt;&gt;
    font.otf
  media/ &lt;&lt;--static--&gt;&gt;
    cover.jpg
    fig1.jpg
  styles/ &lt;&lt;--static--&gt;&gt;
    stylesheet.css
  content.opf
  toc.ncx
  text/ &lt;&lt;--static--&gt;&gt;
    ch001.xhtml</code></pre></li>
<li><p>Added <code>--resource-path=SEARCHPATH</code> command line option (#852). SEARCHPATH is separated by the usual character, depending on OS (: on unix, ; on windows). Default resource path is just working directory. However, the working directory must be explicitly specified if the <code>--resource-path</code> option is used.</p></li>
<li><p>Added –abbreviations=FILE option for custom abbreviations file (#256). Dfault abbreviations file (<code>data/abbreviations</code>) contains a list of strings that will be recognized by pandoc’s Markdown parser as abbreviations. (A nonbreaking space will be inserted after the period, preventing a sentence space in formats like LaTeX.) Users can override the default by putting a file abbreviations in their user data directory (<code>~/.pandoc</code> on *nix).</p></li>
<li><p>Allow a theme file as argument to <code>--highlight-style</code>. Also include a sample, <code>default.theme</code>, in <code>data/</code>.</p></li>
<li><p>Allow <code>--syntax-definition</code> option for dynamic loading of syntax highlighting definitions (#3334).</p></li>
<li><p>Lists in <code>markdown</code> by default now use the CommonMark variable nesting rules (#3511). The indentation required for a block-level item to be included in a list item is no longer fixed, but is determined by the first line of the list item. To be included in the list item, a block must be indented to the level of the first non-space content after the list marker. Exception: if are 5 or more spaces after the list marker, then the content is interpreted as an indented code block, and continuation paragraphs must be indented two spaces beyond the end of the list marker. See the CommonMark spec for more details and examples.</p>
<p>Documents that adhere to the four-space rule should, in most cases, be parsed the same way by the new rules. Here are some examples of texts that will be parsed differently:</p>
<pre><code>- a
  - b</code></pre>
<p>will be parsed as a list item with a sublist; under the four-space rule, it would be a list with two items.</p>
<pre><code>- a

      code</code></pre>
<p>Here we have an indented code block under the list item, even though it is only indented six spaces from the margin, because it is four spaces past the point where a continuation paragraph could begin. With the four-space rule, this would be a regular paragraph rather than a code block.</p>
<pre><code>- a

        code</code></pre>
<p>Here the code block will start with two spaces, whereas under the four-space rule, it would start with <code>code</code>. With the four-space rule, indented code under a list item always must be indented eight spaces from the margin, while the new rules require only that it be indented four spaces from the beginning of the first non-space text after the list marker (here, <code>a</code>).</p>
<p>This change was motivated by a slew of bug reports from people who expected lists to work differently (#3125, #2367, #2575, #2210, #1990, #1137, #744, #172, #137, #128) and by the growing prevalance of CommonMark (now used by GitHub, for example). Those who prefer the old behavior can use <code>-f markdown+four_space_rule</code>.</p></li>
<li><p>Added <code>four_space_rule</code> extension. This triggers the old pandoc parsing rule for content nested under list items (the “four space rule”).</p></li>
<li><p>Added <code>spaced_reference_links</code> extension (#2602). It allows whitespace between the two parts of a reference link: e.g.</p>
<pre><code>[a] [b]

[b]: url</code></pre>
<p>This was previously enabled by default; now it is now forbidden by default.</p></li>
<li><p>Add <code>space_in_atx_header</code> extension (#3512). This is enabled by default in pandoc and GitHub markdown but not the other flavors. This requirse a space between the opening #’s and the header text in ATX headers (as CommonMark does but many other implementations do not). This is desirable to avoid falsely capturing things ilke</p>
<pre><code>#hashtag</code></pre>
<p>or</p>
<pre><code>#5</code></pre></li>
<li><p>Add <code>sourcefile</code> and <code>outputfile</code> template variables (Roland Hieber, #3431).</p></li>
<li><p>Allow ibooks-specific metadata in epubs (#2693). You can now have the following fields in your YAML metadata, and it will be treated appropriately in the generated EPUB:</p>
<pre><code>  ibooks:
    version: 1.3.4
    specified-fonts: false
    ipad-orientation-lock: portrait-only
    iphone-orientation-lock: landscape-only
    binding: true
    scroll-axis: vertical</code></pre></li>
</ul>
<h2 id="behavior-changes">Behavior changes</h2>
<ul>
<li><p>Reader functions no longer presuppose that CRs have been stripped from the input. (They strip CRs themselves, before parsing, to simplify the parsers.)</p></li>
<li><p>Added support for translations (localization) (#3559). Currently this only affects the LaTeX reader, for things like <code>\figurename</code>. Translation data files for 46 languages can be found in <code>data/translations</code>.</p></li>
<li><p>Make <code>--ascii</code> work with DocBook output too.</p></li>
<li><p>Rename <code>--latex-engine</code> to <code>--pdf-engine</code>, and <code>--latex-engine-opt</code> to <code>--pdf-engine-opt</code>.</p></li>
<li><p>Removed <code>--parse-raw</code> and <code>readerParseRaw</code>. These were confusing. Now we rely on the <code>+raw_tex</code> or <code>+raw_html</code> extension with latex or html input. Thus, instead of <code>--parse-raw -f latex</code> we use <code>-f latex+raw_tex</code>, and instead of <code>--parse-raw -f html</code> we use <code>-f html+raw_html</code>.</p></li>
<li><p>With <code>--filter</code> R filters are now recognized, even if they are not executable (#3940, #3941, Andrie de Vries).</p></li>
<li><p>Support SVG in PDF output, converting with <code>rsvg2pdf</code> (#1793).</p></li>
<li><p>Make epub an alias for epub3, not epub2.</p></li>
<li><p>Removed <code>--epub-stylesheet</code>; use <code>--css</code> instead (#3472, #847). Multiple stylesheets may be used. Stylesheets will be taken both from <code>--css</code> and from the <code>stylesheet</code> metadata field (which can contain either a file path or a list of them).</p></li>
<li><p><code>--mathml</code> and MathML in HTMLMathMethod no longer take an argument. The argument was for a bridge JavaScript that used to be necessary in 2004. We have removed the script already.</p></li>
<li><p><code>--katex</code> improvements. The latest version is used, and the autoload script is loaded by default.</p></li>
<li><p>Change MathJax CDN default since old one is shutting down (#3544). Note: The new URL requires a version number, which we’ll have to update manually in subsequent pandoc releases in order to take advantage of mathjax improvements.</p></li>
<li><p><code>--self-contained</code>: don’t incorporate elements with <code>data-external=&quot;1&quot;</code> (#2656). You can leave an external link as it is by adding the attribute data-external=“1” to the element. Pandoc will then not try to incorporate its content when <code>--self-contained</code> is used. This is similar to a feature already supported by the EPUB writer.</p></li>
<li><p>Allow <code>--extract-media</code> to work with non-binary input formats (#1583, #2289). If <code>--extract-media</code> is supplied with a non-binary input format, pandoc will attempt to extract the contents of all linked images, whether in local files, data: uris, or external uris. They will be named based on the sha1 hash of the contents.</p></li>
<li><p>Make <code>papersize: a4</code> work regardless of the case of <code>a4</code>. It is converted to <code>a4</code> in LaTeX and <code>A4</code> in ConTeXt.</p></li>
<li><p>Make <code>east_asian_line_breaks</code> affect all readers/writers (#3703).</p></li>
<li><p>Underlined elements are now treated consistently by readers (#2270, hftf); they are always put in a Span with class <code>underline</code>. This allows the user to treat them differently from other emphasis, using a filter. Docx, Org, Textile, Txt2Tags, and HTML readers have been changed.</p></li>
<li><p>Improved behavior of <code>auto_identifiers</code> when there are explicit ids (#1745). Previously only autogenerated ids were added to the list of header identifiers in state, so explicit ids weren’t taken into account when generating unique identifiers. Duplicated identifiers could result. This simple fix ensures that explicitly given identifiers are also taken into account.</p></li>
<li><p>Use <code>table-of-contents</code> for contents of toc, make <code>toc</code> a boolean (#2872). Changed markdown, rtf, and HTML-based templates accordingly. This allows you to set <code>toc: true</code> in the metadata; this previously produced strange results in some output formats. For backwards compatibility, <code>toc</code> is still set to the toc contents. But it is recommended that you update templates to use <code>table-of-contents</code> for the toc contents and <code>toc</code> for a boolean flag.</p></li>
<li><p>Change behavior with binary format output to stdout. Previously, for binary formats, output to stdout was disabled unless we could detect that the output was being piped (and not sent to the terminal). Unfortunately, such detection is not possible on Windows, leaving windows users no way to pipe binary output. So we have changed the behavior in the following way:</p>
<ul>
<li>Output to stdout is allowed when it can be determined that the output is being piped (on non-Windows platforms).</li>
<li>If the <code>-o</code> option is not used, binary output is never sent to stdout by default; instead, an error is raised.</li>
<li>If <code>-o -</code> is used, binary output is sent to stdout, regardless of whether it is being piped. This works on Windows too.</li>
</ul></li>
<li><p>Better error behavior: uses of <code>error</code> have been replaced by raising of <code>PandocError</code>, which can be trapped and handled by the calling program.</p></li>
<li><p>Removed <code>hard_line_breaks</code> extension from <code>markdown_github</code> (#3594). GitHub has two Markdown modes, one for long-form documents like READMEs and one for short things like issue coments. In issue comments, a line break is treated as a hard line break. In README, wikis, etc., it is treated as a space as in regular Markdown. Since pandoc is more likely to be used to convert long-form documents from GitHub Markdown, <code>-hard_line_breaks</code> is a better default.</p></li>
<li><p>Include <code>backtick_code_blocks</code> extension in <code>mardkown_mmd</code> (#3637).</p></li>
<li><p>Escape <code>MetaString</code> values (as added with <code>-M/--metadata</code> flag) (#3792). Previously they would be transmitted to the template without any escaping. Note that <code>--M title='*foo*'</code> yields a different result from</p>
<pre><code>---
title: *foo*
---</code></pre>
<p>In the latter case, we have emphasis; in the former case, just a string with literal asterisks (which will be escaped in formats, like Markdown, that require it).</p></li>
<li><p>Allow <code>em</code>, <code>cm</code>, <code>in</code> for image height/width in HTML, LaTeX (#3450).</p></li>
<li><p>HTML writer: Insert <code>data-</code> in front of unsupported attributes. Thus, a span with attribute <code>foo</code> gets written to HTML5 with <code>data-foo</code>, so it is valid HTML5. HTML4 is not affected. This will allow us to use custom attributes in pandoc without producing invalid HTML. (With help from Wandmalfarbe, #3817.)</p></li>
<li><p>Plain writer: improved super/subscript rendering. We now handle more non-digit characters for which there are sub/superscripted unicode characters. When unicode sub/superscripted characters are not available, we use <code>_(..)</code> or <code>^(..)</code> (#3518).</p></li>
<li><p>Docbook, JATS, TEI writers: print INFO message when omitting interior header (#3750). This only applies to section headers inside list items, e.g., which were otherwise silently omitted.</p></li>
<li><p>Change to <code>--reference-links</code> in Markdown writer (#3701). With <code>--reference-location</code> of <code>section</code> or <code>block</code>, pandoc will now repeat references that have been used in earlier sections. The Markdown reader has also been modified, so that <em>exactly</em> repeated references do not generate a warning, only references with the same label but different targets. The idea is that, with references after every block, one might want to repeat references sometimes.</p></li>
<li><p>ODT/OpenDocument writer:</p>
<ul>
<li>Support <code>lang</code> attribute (#1667).</li>
<li>Added support for <code>--toc</code> (#2836). Thanks to <span class="citation" data-cites="anayrat">@anayrat</span>.</li>
</ul></li>
<li><p>Docx writer:</p>
<ul>
<li><code>lang</code> meta, see #1667 (Mauro Bieg, #3515).</li>
<li>Change <code>FigureWithCaption</code> to <code>CaptionedFigure</code> (iandol, #3658).</li>
<li>Use <code>Table</code> rather than <code>Table Normal</code> for table style (#3275). <code>Table Normal</code> is the default table style and can’t be modified.</li>
<li><p>Pass through comments (#2994). We assume that comments are defined as parsed by the docx reader:</p>
<p>I want <span id="0" class="comment-start" data-author="Jesse Rosenthal" data-date="2016-05-09T16:13:00Z">I left a comment.</span>some text to have a comment <span id="0" class="comment-end"></span>on it.</p>
We assume also that the id attributes are unique and properly matched between comment-start and comment-end.</li>
<li>Bookmark improvements. Bookmark start/end now surrounds content rather than preceding it. Bookmarks generated for Div with id (jgm/pandoc-citeproc#205).</li>
<li><p>Add <code>keywords</code> metadata to docx document properties (Ian).</p></li>
</ul></li>
<li><p>RST writer: support unknown interpreted text roles by parsing them as <code>Span</code> with <code>role</code> attributes (#3407). This way they can be manipulated in the AST.</p></li>
<li><p>HTML writer:</p>
<ul>
<li>Line block: Use class instead of style attribute (#1623). We now issue <code>&lt;div class=&quot;line-block&quot;&gt;</code> and include a default definition for <code>line-block</code> in the default templates, instead of hard-coding a <code>style</code> on the div.</li>
<li>Add class <code>footnoteBack</code> to footnote back references (Timm Albers). This allows for easier CSS styling.</li>
<li>Render SmallCaps as span with smallcaps class (#1592), rather than using a style attribute directly. This gives the user more flexibility in styling small caps in CSS.</li>
<li>With reveal.js we use <code>data-src</code> instead of <code>src</code> for images for lazy loading.</li>
<li>Special-case <code>.stretch</code> class for images in reveal.js (#1291). Now in reveal.js, an image with class <code>stretch</code> in a paragraph by itself will stretch to fill the whole screen, with no caption or figure environment.</li>
</ul></li>
<li><p>Added warnings for non-rendered blocks to writers.</p></li>
<li><p>Writers now raise an error on template failure.</p></li>
<li><p>When creating a PDF via LaTeX, warn if the font is missing some characters (#3742).</p></li>
<li><p>Remove initial check for PDF-creating program (#3819). Instead, just try running it and raise the exception if it isn’t found at that point. This improves things for users of Cygwin on Windows, where the executable won’t be found by <code>findExecutable</code> unless <code>.exe</code> is added. The same exception is raised as before, but at a later point.</p></li>
<li><p>Readers issue warning for duplicate header identifiers (#1745). Autogenerated header identifiers are given suffixes so as not to clash with previously used header identifiers. But they may still coincide with an explicit identifier that is given for a header later in the document, or with an identifier on a div, span, link, or image. We now issue a warning in this case, so users can supply an explicit identifier.</p></li>
<li><p>CommonMark reader now supports <code>emoji</code>, <code>hard_line_breaks</code>, <code>smart</code>, and <code>raw_html</code> extensions.</p></li>
<li><p>Markdown reader:</p>
<ul>
<li><p>Don’t allow backslash + newline to affect block structure (#3730). Note that as a result of this change, the following, which formerly produced a header with two lines separated by a line break, will now produce a header followed by a paragraph:</p>
<p># Hi<br />
there</p>
<p>This may affect some existing documents that relied on this undocumented and unintended behavior. This change makes pandoc more consistent with other Markdown implementations, and with itself (since the two-space version of a line break doesn’t work inside ATX headers, and neither version works inside Setext headers).</p></li>
</ul></li>
<li><p>Org reader (Albert Krewinkel, unless noted):</p>
<ul>
<li>Support <code>table.el</code> tables (#3314).</li>
<li>Support macros (#3401).</li>
<li>Support the <code>#+INCLUDE:</code> file inclusion mechanism (#3510). Recognized include types are <code>example</code>, <code>export</code>, <code>src</code>, and normal org file inclusion. Advanced features like line numbers and level selection are not implemented yet.</li>
<li>Interpret more meta value as inlines. The values of the following meta variables are now interpreted using org-markup instead of treating them as pure strings: <code>keywords</code> (comma-separated list of inlines), <code>subtitle</code> (inline values), <code>nocite</code> (inline values, can be repeated).</li>
<li>Support <code>\n</code> export option (#3940). This turns all newlines in the text into hard linebreaks.</li>
</ul></li>
<li><p>RST reader:</p>
<ul>
<li>Improved admonition support (#223). We no longer add an <code>admonition</code> class, we just use the class for the type of admonition, <code>note</code> for example. We put the word corresponding to the label in a paragraph inside a <code>Div</code> at the beginning of the admonition with class <code>admonition-title</code>. This is about as close as we can get to RST’s own output.</li>
<li>Initial support of <code>.. table</code> directive. This allows adding captions to tables.</li>
<li>Support <code>.. line-block</code> directive. This is deprecated but may still be in older documents.</li>
<li>Support scale and align attributes of images (#2662).</li>
<li>Implemented implicit internal header links (#3475).</li>
<li>Support RST-style citations (#853). The citations appear at the end of the document as a definition list in a special div with id <code>citations</code>. Citations link to the definitions.</li>
<li>Recurse into bodies of unknown directives (#3432). In most cases it’s better to preserve the content than to emit it. This isn’t guaranteed to have good results; it will fail spectacularly for unknown raw or verbatim directives.</li>
<li><p>Handle chained link definitions (#262). For example,</p>
<pre><code>.. _hello:
.. _goodbye: example.com</code></pre>
Here both <code>hello</code> and <code>goodbye</code> should link to <code>example.com</code>.</li>
<li><p>Support anchors (#262). E.g.</p>
<pre><code>`hello`

.. _hello:

paragraph</code></pre>
This is supported by putting “paragraph” in a <code>Div</code> with id <code>hello</code>.</li>
<li>Support <code>:widths:</code> attribute for table directive.</li>
<li>Implement csv-table directive (#3533). Most attributes are supported, including <code>:file:</code> and <code>:url:</code>.</li>
<li><p>Support unknown interpreted text roles by parsing them as Span with “role” attributes (#3407). This way they can be manipulated in the AST.</p></li>
</ul></li>
<li><p>HTML reader: parse a span with class <code>smallcaps</code> as <code>SmallCaps</code>.</p></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Implemented <code>\graphicspath</code> (#736).</li>
<li>Properly handle column prefixes/suffixes. For example, in <code>\begin{tabular}{&gt;{$}l&lt;{$}&gt;{$}l&lt;{$} &gt;{$}l&lt;{$}}</code> each cell will be interpreted as if it has a <code>$</code> before its content and a <code>$</code> after (math mode).</li>
<li>Handle komascript <code>\dedication</code> (#1845). It now adds a <code>dedication</code> field to metadata. It is up to the user to supply a template that uses this variable.</li>
<li>Support all <code>\textXX</code> commands, where XX = <code>rm</code>, <code>tt</code>, <code>up</code>, <code>md</code>, <code>sf</code>, <code>bf</code> (#3488). Spans with a class are used when there is nothing better.</li>
<li>Expand <code>\newenvironment</code> macros (#987).</li>
<li>Add support for LaTeX subfiles package (Marc Schreiber, #3530).</li>
<li>Better support for subfigure package (#3577). A figure with two subfigures turns into two pandoc figures; the subcaptions are used and the main caption ignored, unless there are no subcaptions.</li>
<li>Add support for (Marc Schreiber, #3607).</li>
<li>Add basic support for hyphenat package (Marc Schreiber, #3603).</li>
<li>Add basic <code>\textcolor</code> support (Marc Schreiber).</li>
<li>Add support for <code>tabularx</code> environment (Marc Schreiber, #3632).</li>
<li>Better handling of comments inside math environments (#3113). This solves a problem with commented out <code>\end{eqnarray}</code> inside an eqnarray (among other things).</li>
<li>Parse tikzpicture as raw verbatim environment if <code>raw_tex</code> extension is selected (#3692). Otherwise skip with a warning. This is better than trying to parse it as text!</li>
<li>Add <code>\colorbox</code> support (Marc Schreiber).</li>
<li>Set identifiers on Spans used for <code>\label</code>.</li>
<li>Have <code>\setmainlanguage</code> set <code>lang</code> in metadata.</li>
<li>Support etoolbox’s <code>\ifstrequal</code>.</li>
<li>Support <code>plainbreak</code>, <code>fancybreak</code> et al from the memoir class (bucklereed, #3833).</li>
<li>Support <code>\let</code>. Also, fix regular macros so they’re expanded at the point of use, and NOT also the point of definition. <code>\let</code> macros, by contrast, are expanded at the point of definition. Added an <code>ExpansionPoint</code> field to <code>Macro</code> to track this difference.</li>
<li>Support simple <code>\def</code> macros. Note that we still don’t support macros with fancy parameter delimiters, like <code>\def\foo#1..#2{...}</code>.</li>
<li>Support , , , etc. (#3559, obsoletes #3560).</li>
<li>Put content of <code>\ref</code>, <code>\label</code>, <code>\eqref</code> commands into <code>Span</code> with attributes, so they can be handled in filters (Marc Schreiber, #3639)</li>
<li>Add Support for <code>glossaries</code> and <code>acronym</code> package (Marc Schreiber, #3589). Acronyms are not resolved by the reader, but acronym and glossary information is put into attributes on Spans so that they can be processed in filters.</li>
<li>Use <code>Link</code> instead of <code>Span</code> for <code>\ref</code>. This makes more sense semantically and avoids unnecessary <code>Span [Link]</code> nestings when references are resolved.</li>
<li>Rudimentary support for <code>\hyperlink</code>.</li>
<li>Support <code>\textquoteleft|right</code>, <code>\textquotedblleft|right</code> (#3849).</li>
<li>Support <code>\lq</code>, <code>\rq</code>.</li>
<li>Implement <code>\newtoggle</code>, <code>\iftoggle</code>, <code>\toggletrue|false</code> from etoolbox (#3853).</li>
<li>Support <code>\RN</code> and <code>\Rn</code>, from biblatex (bucklereed, #3854).</li>
<li>Improved support for <code>\hyperlink</code>, <code>\hypertarget</code> (#2549).</li>
<li>Support <code>\k</code> ogonek accent.</li>
<li>Improve handling of accents. Handle ogonek, and fall back correctly with forms like <code>\&quot;{}</code>.</li>
<li>Better support for ogonek accents.</li>
<li>Support for <code>\faCheck</code> and <code>\faClose</code> (Marc Schreiber, #3727).</li>
<li>Support for <code>xspace</code> (Marc Schreiber, #3797).</li>
<li>Support <code>\setmainlanguage</code> or <code>\setdefaultlanguage</code> (polyglossia) and <code>\figurename</code>.</li>
<li>Better handling of <code>\part</code> in LaTeX (#1905). Now we parse chapters as level 0 headers, and parts as level -1 headers. After parsing, we check for the lowest header level, and if it’s less than 1 we bump everything up so that 1 is the lowest header level. So <code>\part</code> will always produce a header; no command-line options are needed.</li>
<li>Add block version of <code>\textcolor</code> (Marc Schreiber).</li>
<li><code>\textcolor</code> works as inline and block command (Marc Schreiber).</li>
<li><code>\textcolor</code> will be parse as span at the beginning of a paragraph (Marc Schreiber).</li>
<li>Read polyglossia/babel <code>\text(LANG){...}</code> (bucklereed)</li>
<li>Improved handling of include files in LaTeX reader (#3971). Previously <code>\include</code> wouldn’t work if the included file contained, e.g., a begin without a matching end.</li>
<li>Support <code>\expandafter</code> (#3983).</li>
<li>Handle <code>\DeclareRobustCommand</code> (#3983). Currently it’s just treated as a synonym for <code>\newcommand</code>.</li>
<li>Handle <code>\lettrine</code> (Mauro Bieg).</li>
</ul></li>
<li><p>Math improvements due to updates in texmath:</p>
<ul>
<li>Improved handling of accents and upper/lower delimiters.</li>
<li>Support for output in GNU eqn format (used with *roff).</li>
<li>Allow <code>\boldsymbol</code> + a token without braces, and similarly with other styling commands.</li>
<li>Improve parsing of <code>\mathop</code> to allow multi-character operator names.</li>
<li>Add thin space after math operators when “faking it with unicode.”</li>
</ul></li>
<li><p><code>walk</code> is now used instead of <code>bottomUp</code> in the <code>ToJSONFilter</code> instance for <code>a -&gt; [a]</code> (pandoc-types). Note that behavior will be slightly different, since <code>bottomUp</code>’s treatment of a function <code>[a] -&gt; [a]</code> is to apply it to each sublist of a list, while walk applies it only to maximal sublists. Usually the latter behavior is what is wanted, and the former can be simulated when needed. But there may be existing filters that need to be rewritten in light of the new behavior. Performance should be improved.</p></li>
<li><p>There are some changes to syntax highlighting due to revisions in the <code>skylighting</code> library:</p>
<ul>
<li>Support for <code>powershell</code> has been added, and many syntax definitions have been updated.</li>
<li>Background colors have been added to the <code>kate</code> style.</li>
<li>The way highlighted code blocks are formatted in HTML has been changed (David Baynard), in ways that may require changes in hard-coded CSS affecting highlighting. (If you haven’t included hard-coded highlighting CSS in your template, you needn’t change anything.)</li>
</ul></li>
</ul>
<h2 id="api-changes">API changes</h2>
<ul>
<li><p>New module <code>Text.Pandoc.Class</code> (Jesse Rosenthal, John MacFarlane). This contains definitions of the <code>PandocMonad</code> typeclass, the <code>PandocIO</code> and <code>PandocPure</code> monads, and associated functions.</p></li>
<li><p>Changed types of all writers and readers.</p>
<ul>
<li>We now use <code>Text</code> instead of <code>String</code> in the interface (#3731). (We have not yet changed the internals of most readers to work with <code>Text</code>, but making this change in the API now opens up a path to doing that.)</li>
<li>The result is now of form <code>m a</code> with constraint <code>PandocMonad m</code>. Readers and writers can be combined to form monadic values which can be run using either <code>runIO</code> or <code>runPure</code>. If <code>runIO</code> is used, then both readers and writers will be able to do IO when needed (for include files, for example); if <code>runPure</code> is used, then the functions are pure and will not touch IO.</li>
<li>Where previously you used <code>writeRST def (readMarkdown def &quot;[foo](url)&quot;)</code>, now you would use <code>runPure $ readMarkdown def (pack &quot;[foo](url)&quot;) &gt;&gt;= writeRST def</code>.</li>
</ul></li>
<li><p>New module <code>Text.Pandoc.Readers</code> (Albert Krewinkel). This contains reader helper functions formerly defined in the top-level <code>Text.Pandoc</code> module.</p>
<ul>
<li>Changed <code>StringReader</code> -&gt; <code>TextReader</code>.</li>
<li><code>getReader</code> now returns a pair of a reader and <code>Extensions</code>, instead of building the extensions into the reader (#3659). The calling code must explicitly set <code>readerExtensions</code> using the <code>Extensions</code> returned. The point of the change is to make it possible for the calling code to determine what extensions are being used.</li>
</ul></li>
<li><p>New module <code>Text.Pandoc.Writers</code> (Albert Krewinkel). This contains writer helper functions formerly defined in the top-level <code>Text.Pandoc</code> module.</p>
<ul>
<li>Changed <code>StringWriter</code> -&gt; <code>TextWriter</code>.</li>
<li><code>getWriter</code> now retuns a pair of a reader and <code>Extensions</code>, instead of building the extensions into the reader (#3659). The calling code must explicitly set <code>readerExtensions</code> using the <code>Extensions</code> returned. The point of the change is to make it possible for the calling code to determine what extensions are being used.</li>
</ul></li>
<li><p>New module <code>Text.Pandoc.Lua</code>, exporting <code>runLuaFilter</code> (Albert Krewinkel, #3514).</p></li>
<li><p>New module <code>Text.Pandoc.App</code>. This abstracts out the functionality of the command line program (<code>convertWithOpts</code>), so it can be reproduced e.g. in a desktop or web application. Instead of exiting, we throw errors (#3548), which are caught (leading to exit) in pandoc.hs, but allow other users of <code>Text.Pandoc.App</code> to recover. <code>pandoc.hs</code> is now a 2-liner. The module also exports some utility functions for parsing options and running filters.</p></li>
<li><p>New module <code>Text.Pandoc.Logging</code> (exported module) (#3392). This now contains the <code>Verbosity</code> definition previously in <code>Text.Pandoc.Options</code>, as well as a new <code>LogMessage</code> datatype that will eventually be used instead of raw strings for warnings. This will enable us, among other things, to provide machine-readable warnings if desired. Include ToJSON instance and showLogMessage. This gives us the possibility of both machine-readable and human-readable output for log messages.</p></li>
<li><p>New module <code>Text.Pandoc.BCP47</code>, with <code>getLang</code>, <code>Lang(..)</code>, <code>parseBCP47</code>.</p></li>
<li><p>New module <code>Text.Pandoc.Translations</code>, exporting <code>Term</code>, <code>Translations</code>, <code>readTranslations</code>.</p></li>
<li><p>New module <code>Text.Pandoc.Readers.LaTeX.Types', exporting</code>Macro<code>,</code>Tok<code>,</code>TokType<code>,</code>Line<code>,</code>Column`.</p></li>
<li><p><code>Text.Pandoc.Error</code>: added many new constructors for <code>PandocError</code>.</p></li>
<li><p>Expose some previously private modules (#3260). These are often helpful to people writing their own reader or writer modules:</p>
<ul>
<li><code>Text.Pandoc.Writers.Shared</code></li>
<li><code>Text.Pandoc.Parsing</code></li>
<li><code>Text.Pandoc.Asciify</code></li>
<li><code>Text.Pandoc.Emoji</code></li>
<li><code>Text.Pandoc.ImageSize</code></li>
<li><code>Text.Pandoc.Highlighting</code> `</li>
</ul></li>
<li><p>New module <code>Text.Pandoc.Extensions</code> (Albert Krewinkel): Extension parsing and processing functions were defined in the top-level <code>Text.Pandoc</code> module. These functions are moved to the Extensions submodule as to enable reuse in other submodules.</p></li>
<li><p>Add <code>Ext_raw_attribute</code> constructor for <code>Extension</code>.</p></li>
<li><p>Add <code>Ext_fenced_divs</code> constructor for `Extension’.</p></li>
<li><p>Add <code>Ext_four_space_rule</code> constructor in <code>Extension</code>.</p></li>
<li><p>Add <code>Ext_gfm_auto_identifiers</code> constructor for <code>Extension</code>.</p></li>
<li><p>Add <code>Monoid</code> instance for <code>Extensions</code>.</p></li>
<li><p>Add <code>Text.Pandoc.Writers.Ms</code>, exporting <code>writeMs</code>.</p></li>
<li><p>Add <code>Text.Pandoc.Writers.JATS</code>, exporting <code>writeJATS</code>.</p></li>
<li><p>Add <code>Text.Pandoc.Writers.Muse</code>, exporting <code>writeMuse</code>.</p></li>
<li><p>Add <code>Text.Pandoc.Readers.Muse</code>, exporting <code>readMuse</code>.</p></li>
<li><p>Add <code>Text.Pandoc.Readers.TikiWiki</code>, exporting <code>readTikiWiki</code>.</p></li>
<li><p>Add <code>Text.Pandoc.Readers.Vimwiki</code>, exporting <code>readVimwiki</code>.</p></li>
<li><p>Add <code>Text.Pandoc.Readers.Creole</code>, exporting <code>readCreole</code>.</p></li>
<li><p>Export <code>setVerbosity</code> from <code>Text.Pandoc</code>.</p></li>
<li><p><code>Text.Pandoc.Pretty</code>: Add <code>Eq</code> instance for <code>Doc</code>.</p></li>
<li><p><code>Text.Pandoc.XML</code>: <code>toEntities</code>: changed type to <code>Text -&gt; Text</code>.</p></li>
<li><p><code>Text.Pandoc.UTF8</code>:</p>
<ul>
<li>Export <code>fromText</code>, <code>fromTextLazy</code>, <code>toText</code>, <code>toTextLazy</code>. Define <code>toString</code>, <code>toStringLazy</code> in terms of them.</li>
<li>Add new functions parameterized on <code>Newline</code>: <code>writeFileWith</code>, <code>putStrWith</code>, <code>putStrLnWith</code>, <code>hPutStrWith</code>, <code>hPutStrLnWith</code>.</li>
</ul></li>
<li><p><code>Text.Pandoc.MediaBag</code>: removed <code>extractMediaBag</code>.</p></li>
<li><p><code>Text.Pandoc.Highlighting</code>:</p>
<ul>
<li><code>highlighting</code> now returns an Either rather than Maybe. This allows us to display error information returned by the skylighting library. Display a warning if the highlighting library throws an error.</li>
<li>Add parameter for <code>SyntaxMap</code> to <code>highlight</code>.</li>
</ul></li>
<li><p><code>Text.Pandoc.Writers.Math</code>:</p>
<ul>
<li>Export <code>defaultMathJaxURL</code>, <code>defaultKaTeXURL</code>. This will ensure that we only need to update these in one place.</li>
</ul></li>
<li><p><code>Text.Pandoc.SelfContained</code>:</p>
<ul>
<li>Removed <code>WriterOptions</code> parameter from <code>makeSelfContained</code>.</li>
<li>Put <code>makeSelfContained</code> in PandocMonad instead of IO. This removes the need to pass MediaBag around and improves exceptions. It also opens up the possibility of using makeSelfContained purely.</li>
<li>Export <code>makeDataURI</code>.</li>
</ul></li>
<li><p><code>Text.Pandoc.ImageSize</code>:</p>
<ul>
<li>Export <code>lengthToDim</code>, new function <code>scaleDimension</code>.</li>
<li>Export <code>inEm</code> from ImageSize (#3450).</li>
<li>Change <code>showFl</code> and <code>show</code> instance for <code>Dimension</code> so extra decimal places are omitted.</li>
<li>Added <code>Em</code> as a constructor of <code>Dimension</code>.</li>
<li>Add <code>WriterOptions</code> parameter to <code>imageSize</code> signature (Mauro Bieg).</li>
</ul></li>
<li><p><code>Text.Pandoc.Templates</code>:</p>
<ul>
<li>Change type of <code>renderTemplate'</code>. Now it runs in <code>PandocMonad</code> and raises a proper <code>PandocTemplateError</code> if there are problems, rather than failing with uncatchable <code>error</code>.</li>
<li>Change signature of <code>getDefaultTemplate</code>. Now it runs in any instance of <code>PandocMonad</code>, and returns a <code>String</code> rather than an <code>Either</code> value. And it no longer takes a <code>datadir</code> parameter, since this can be retrieved from <code>CommonState</code>.</li>
</ul></li>
<li><p><code>Text.Pandoc.Options</code>:</p>
<ul>
<li>Added <code>writerEpubSubdirectory</code> to <code>WriterOptions</code> (#3720). The EPUB writer now takes its EPUB subdirectory from this option.</li>
<li>In <code>WriterOptions</code>, rename <code>writerLaTeXEngine</code> to <code>writerPdfEngine</code> and <code>writerLaTeXArgs</code> to <code>writerPdfArgs</code> (Mauro Bieg, #3909).</li>
<li>Add <code>writerSyntaxMap</code> to <code>WriterOptions</code>.</li>
<li>Removed <code>writerEpubStylesheet</code> from <code>WriterOptions</code>.</li>
<li>Remove <code>writerUserDataDir</code> from <code>WriterOptions</code>. It is now carried in <code>CommonState</code> in <code>PandocMonad</code> instances. (And thus it can be used by readers too.)</li>
<li>Changed <code>writerEpubMetadata</code> to a <code>Maybe String</code>.</li>
<li>Removed <code>readerApplyMacros</code> from <code>ReaderOptions</code>. Now we just check the <code>latex_macros</code> reader extension.</li>
<li>FromJSON/ToJSON instances for <code>ReaderOptions</code>.</li>
<li>In <code>HTMLMathMethod</code>, the <code>KaTeX</code> contsructor now takes only one string (for the KaTeX base URL), rather than two.</li>
<li>Removed <code>writerSourceURL</code> from <code>WriterOptions</code>. We now use <code>stSourceURL</code> in <code>CommonState</code>, which is set by <code>setInputFiles</code>.</li>
</ul></li>
<li><p><code>Text.Pandoc.Shared</code>:</p>
<ul>
<li><code>tabFilter</code> now takes a <code>Text</code>, not <code>String</code>.</li>
<li><code>openURL</code>: Changed type from an Either. Now it will just raise an exception to be trapped later.</li>
<li>Remove <code>normalizeSpaces</code> (#1530).</li>
<li>Remove <code>warn</code>. (Use <code>report</code> from <code>Text.Pandoc.Class</code> instead.)</li>
<li>Export a new function <code>crFilter</code>.</li>
<li>Add <code>eastAsianLineBreakFilter</code> (previously in Markdown reader).</li>
<li>Provide custom <code>isURI</code> that rejects unknown schemes. (Albert Krewinkel, #2713). We also export the set of known <code>schemes</code>. The new function replaces the function of the same name from <code>Network.URI</code>, as the latter did not check whether a scheme is well-known. All official IANA schemes (as of 2017-05-22) are included in the set of known schemes. The four non-official schemes <code>doi</code>, <code>isbn</code>, <code>javascript</code>, and <code>pmid</code> are kept.</li>
<li>Remove <code>err</code>.</li>
<li>Remove <code>readDataFile</code>, <code>readDefaultDataFile</code>, <code>getReferenceDocx</code>, <code>getReferenceODT</code>. These now live in <code>Text.Pandoc.Class</code>, where they are defined in terms of <code>PandocMonad</code> primitives and have different signatures.</li>
<li>Remove <code>openURL</code>. Use <code>openURL</code> from <code>Text.Pandoc.Class</code> instead.</li>
<li>Add <code>underlineSpan</code>.</li>
</ul></li>
<li><p><code>Text.Pandoc.Readers.HTML</code>: export new <code>NamedTag</code> class.</p></li>
<li><p><code>Text.Pandoc.Readers.Markdown</code>: remove <code>readDocxWithWarnings</code>. With the new API one can simply use <code>getLog</code> after running the reader.</p></li>
<li><p><code>Text.Pandoc.Readers.LaTeX</code>: Changed types for <code>rawLaTeXInline</code> and <code>rawLaTeXBlock</code>. (Both now return a <code>String</code>, and they are polymorphic in state.)</p></li>
</ul>
<h2 id="bug-fixes-and-under-the-hood-improvements">Bug fixes and under-the-hood improvements</h2>
<ul>
<li><p>TEI writer: Added identifiers on <code>&lt;div&gt;</code> elements.</p></li>
<li><p>DokuWiki reader: Better handling for code block in list item (#3824).</p></li>
<li><p>Custom writer: Remove old preprocesesor conditionals (Albert Krewinkel).</p></li>
<li><p>ZimWiki writer: Removed internal formatting from note and table cells, because ZimWiki does not support it (Alex Ivkin, #3446).</p></li>
<li><p>MediaWiki writer:</p>
<ul>
<li>Updated list of syntax highlighting languages (#3461). Now <code>r</code> gets you <code>&lt;source&gt;</code> rather than <code>&lt;code&gt;</code> (among others).</li>
<li>Add display attribute on <code>&lt;math&gt;</code> tags (#3452). This allows display math to be rendered properly.</li>
<li>Remove newline before <code>&lt;/ref&gt;</code> (#2652).</li>
<li>Don’t softbreak lines inside list items (#3531).</li>
</ul></li>
<li><p>Org writer:</p>
<ul>
<li>Reduce to two spaces after bullets (#3417, Albert Krewinkel).</li>
<li>Add unit tests (Alexander Krotov).</li>
<li>Stop using raw HTML to wrap divs (Albert Krewinkel, #3771).</li>
<li>Do not strip <code>#</code> from Org anchor links (Alexander Krotov).</li>
</ul></li>
<li><p>CommonMark writer:</p>
<ul>
<li>Avoid excess blank lines at end of output.</li>
<li>Prefer pipe tables to HTML tables even if it means losing relative column width information (#3734).</li>
<li>Support table, strikethrough extensions, when enabled (as with gfm). Note that we bypass the commonmark writer from cmark and construct our own pipe tables, with better results.</li>
<li>Properly support <code>--wrap=none</code>.</li>
<li>Use smallcaps class for <code>SmallCaps</code> (#1592).</li>
<li>Omit “fig:” prefix in image titles. This is used internally to indicate internal figures.</li>
</ul></li>
<li><p>RST writer:</p>
<ul>
<li>Properly handle table captions.</li>
<li>Don’t wrap lines in in definition list terms. Wrapping is not allowed.</li>
<li>Implemented <code>+/-smart</code> and improved escaping with <code>+smart</code>.</li>
<li>Add empty comments when needed to avoid including a blockquote in the indented content of a preceding block (#3675).</li>
<li>Improve grid table output, fix bug with empty rows (#3516). Uses the new <code>gridTable</code> in Writers.Shared, which is here improved to better handle 0-width cells.</li>
<li>Remove space at beginning/end of RST code span (#3496). Otherwise we get invalid RST. There seems to be no way to escape the space.</li>
<li>Add header anchors when header has non-standard id (#3937).</li>
<li>Correctly handle inline code containing backticks, using a <code>:literal:</code> role (#3974).</li>
<li>Don’t backslash-escape word-internal punctuation (#3978).</li>
</ul></li>
<li><p>Markdown writer:</p>
<ul>
<li>Don’t include variables in metadata blocks. Previously variables set on the command line were included in e.g. YAML metadata, contrary to documentation and intentions.</li>
<li>Improved escaping with <code>+smart</code>.</li>
<li>Fixed grid tables embedded in grid tables (#2834).</li>
<li>Use span with class ‘smallcaps’ for SmallCaps, instead of a style attribute as before (#1592).</li>
<li>Escape initial <code>%</code> in a paragraph if the <code>pandoc_title_blocks</code> extension is enabled (#3454). Otherwise in a document starting with a literal <code>%</code> the first line is wrongly interpreted as a title.</li>
<li><p>Fixed false ordered lists in YAML metadata (#3492, #1685). Now we properly escape things that would otherwise start ordered lists, such as</p>
<pre><code>---
title: 1. inline
...</code></pre></li>
<li>Better handling of tables with empty columns (#3337). We now calculate the number of columns based on the longest row (or the length of aligns or widths).</li>
<li>Escape unordered list markers at beginning of paragraph (#3497), to avoid false interpretation as a list.</li>
<li>Escape <code>|</code> appropriately.</li>
<li>Ensure space before list at top level (#3487).</li>
<li>Avoid spurious blanklines at end of document after tables and list, for example.</li>
<li>Fixed bugs in simple/multiline list output (#3384). Previously we got overlong lists with <code>--wrap=none</code>. This is fixed. Previously a multiline list could become a simple list (and would always become one with <code>--wrap=none</code>).</li>
<li>Don’t emit a simple table if <code>simple_tables</code> disabled (#3529).</li>
<li>Case-insensitive reference links (David A Roberts, #3616). Ensure that we do not generate reference links whose labels differ only by case. Also allow implicit reference links when the link text and label are identical up to case.</li>
<li>Put space before reference link definitions (Mauro Bieg, #3630).</li>
<li>Better escaping for links (David A. Roberts, #3619). Previously the Markdown writer would sometimes create links where there were none in the source. This is now avoided by selectively escaping bracket characters when they occur in a place where a link might be created.</li>
<li>Added missing <code>\n</code> (David A. Roberts, #3647).</li>
<li>Fixed duplicated reference links with <code>--reference-links</code> and <code>--reference-location=section</code> (#3674). Also ensure that there are no empty link references <code>[]</code>.</li>
<li>Avoid inline surround-marking with empty content (#3715). E.g. we don’t want <code>&lt;strong&gt;&lt;/strong&gt;</code> to become <code>****</code>. Similarly for emphasis, super/subscript, strikeout.</li>
<li>Don’t allow soft break in header (#3736).</li>
<li>Make sure <code>plain</code>, <code>markdown_github</code>, etc. work for raw. Previously only <code>markdown</code> worked. Note: currently a raw block labeled <code>markdown_github</code> will be printed for any <code>markdown</code> format.</li>
<li>Ensure that <code>+</code> and <code>-</code> are escaped properly so they don’t cause spurious lists (#3773). Previously they were only if succeeded by a space, not if they were at end of line.</li>
<li>Use pipe tables if <code>raw_html</code> disabled and <code>pipe_tables</code> enabled, even if the table has relative width information (#3734).</li>
<li>Markdown writer: don’t crash on <code>Str &quot;&quot;</code>.</li>
<li>Make <code>Span</code> with null attribute transparent. That is, we don’t use brackets or <code>&lt;span&gt;</code> tags to mark spans when there are no attributes; we simply output the contents.</li>
<li>Escape pipe characters when <code>pipe_tables</code> enabled (#3887).</li>
<li>Better escaping of <code>&lt;</code> and <code>&gt;</code>. If <code>all_symbols_escapable</code> is set, we backslash escape these. Otherwise we use entities as before.</li>
<li>When writing plain, don’t use <code>&amp;nbsp;</code> to separate list and indented code. There’s no need for it in this context, since this isn’t to be interpreted using Markdown rules.</li>
<li>Preserve classes in JS obfuscated links (Timm Albers, #2989). HTML links containing classes originally now preserve them when using javascript email obfuscation.</li>
<li>Render <code>SmallCaps</code> as a native span when <code>native_spans</code> are enabled.</li>
<li><p>Always write attributes with <code>bracketed_spans</code> (d-dorazio).</p></li>
</ul></li>
<li><p>Man writer:</p>
<ul>
<li>Fix handling of nested font commands (#3568). Previously pandoc emitted incorrect markup for bold + italic, for example, or bold + code.</li>
<li>Avoid error for definition lists with no definitions (#3832).</li>
</ul></li>
<li><p>DocBook writer:</p>
<ul>
<li>Fix internal links with <code>writerIdentifierPrefix opt</code> (#3397, Mauro Bieg).</li>
</ul></li>
<li><p>Docx writer:</p>
<ul>
<li>Don’t include bookmarks on headers unless non-null id (#3476).</li>
<li>Support 9 levels of headers (#1642).</li>
<li>Allow 9 list levels (#3519).</li>
<li>Don’t take <code>distArchive</code> from datadir (#3322). The docx writer takes components from the distribution’s version of <code>reference.docx</code> when it can’t find them in a user’s custom <code>reference.docx</code>. Previously, we allowed a <code>reference.docx</code> in the data directory (e.g. <code>~/.pandoc</code>) to be used as the distribution’s reference.docx. This led to a bizarre situation where pandoc would produce a good docx using <code>--template ~/.pandoc/ref.docx</code>, but if <code>ref.docx</code> were moved to <code>~/.pandoc/reference.docx</code>, it would then produce a corrupted docx.</li>
<li>Fixed handling of soft hyphen (0173) (#3691).</li>
<li>Better handling of keywords (#3719).</li>
<li>Cleaner code for handling dir and style attributes for <code>Div</code>.</li>
<li>Use <code>Set</code> for dynamic styles to avoid duplicates.</li>
<li>Removed redundant element from data/docx/word/numbering.xml. The elements we need are generated when the document is compiled; this didn’t do anything.</li>
<li>Activate <code>evenAndOddHeaders</code> from reference docx (#3901, Augustín Martín Barbero).</li>
</ul></li>
<li><p>ODT/OpenDocument writer:</p>
<ul>
<li>Calculate aspect ratio for percentage-sized images (Mauro Bieg, #3239).</li>
<li>Use more widely available bullet characters (#1400). The old characters weren’t available in some font sets. These seem to work well on Windows and Linux versions of LibreOffice.</li>
<li>Wider labels for lists (#2421). This avoids overly narrow labels for ordered lists with <code>()</code> delimiters. However, arguably it creates overly wide labels for bullets. Also, lists now start flush with the margin, rather than indented.</li>
<li>Fixed dropped elements in some ordered lists (#2434).</li>
</ul></li>
<li><p>FB2 writer:</p>
<ul>
<li>Don’t render <code>RawBlock</code> as code.</li>
<li>Don’t fail with an error on interior headers (e.g. in list) (#3750). Instead, omit them with an INFO message.</li>
<li>Add support for “lang” metadata (Alexander Krotov, #3625).</li>
<li>Format <code>LineBlock</code> as poem (Alexander Krotov). Previously writer produced one paragraph with <code>&lt;empty-line/&gt;</code> elements, which are not allowed inside <code>&lt;p&gt;</code> according to FB2 schema.</li>
<li>Replace <code>concatMap</code> with <code>cMap</code> (Alexander Krotov).</li>
<li>Write FB2 lists without nesting blocks inside <code>&lt;p&gt;</code> (Alexander Krotov, #4004)</li>
</ul></li>
<li><p>HTML writer:</p>
<ul>
<li>Make sure <code>html4</code>, <code>html5</code> formats work for raw blocks/inlines.</li>
<li>Render raw inline environments when <code>--mathjax</code> used (#3816). We previously did this only with raw blocks, on the assumption that math environments would always be raw blocks. This has changed since we now parse them as inline environments.</li>
<li>Ensure we don’t get two style attributes for width and height.</li>
<li>Report when not rendering raw inline/block.</li>
<li>Issue warning if no title specified and template used (#3473).</li>
<li>Info message if <code>lang</code> is unspecified (#3486).</li>
<li>Removed unused parameter in <code>dimensionsToAttributeList</code>.</li>
<li>Avoid two class attributes when adding <code>uri</code> class (#3716).</li>
<li>Fix internal links with <code>writerIdentifierPrefix opt</code> (#3397, Mauro Bieg).</li>
<li>Use revealjs’s math plugin for mathjax (#3743). This is a thin wrapper around mathjax that makes math look better on revealjs.</li>
<li>Slidy: use h1 for all slides, even if they were originally level 2 headers (#3566). Otherwise the built-in table of contents in Slidy breaks.</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Don’t render LaTeX images with data: URIs (#3636). Note that <code>--extract-media</code> can be used when the input contains data: URIs.</li>
<li>Make highlighted code blocks work in footnotes (Timm Albers).</li>
<li>Don’t use figure inside table cell (#3836).</li>
<li>Use proper code for list enumerators (#3891). This should fix problems with lists that don’t use arabic numerals.</li>
<li>Always add hypertarget when there’s a non-empty identifier (#2719). Previously the hypertargets were only added when there was actually a link to that identifier.</li>
<li>Use <code>%</code> after hypertarget before code block.</li>
<li>Add <code>\leavevmode</code> before hypertarget at start of paragraph (#2704, fixes formatting problems in beamer citations).</li>
<li>Don’t use <code>lstinline</code> in
(#645). If you do, the contents of item disappear or are misplaced. Use <code>\texttt</code> instead.</li>
<li>Fix problem with escaping in <code>lstinline</code> (#1629). Previously the LaTeX writer created invalid LaTeX when <code>--listings</code> was specified and a code span occured inside emphasis or another construction.</li>
<li>Fix error with line breaks after empty content (#2874). LaTeX requires something before a line break, so we insert a <code>~</code> if no printable content has yet been emitted.</li>
<li>Use BCP47 parser.</li>
<li>Fixed detection of otherlangs (#3770). We weren’t recursing into inline contexts.</li>
<li>Handle language in inline code with <code>--listings</code> (#3422).</li>
<li>Write euro symbol directly in LaTeX (Andrew Dunning, #3801). The textcomp package allows pdfLaTeX to parse <code>€</code> directly, making the <code>\euro</code> command unneeded.</li>
<li>Fixed footnotes in table captions (#2378). Note that if the table has a first page header and a continuation page header, the notes will appear only on the first occurrence of the header.</li>
<li>In <code>writeBeamer</code> output, allow hyperlinks to frames (#3220). Previously you could link to a header above or below slide level but not <em>to</em> slide level. This commit changes that. Hypertargets are inserted inside frame titles; technically the reference is to just after the title, but in normal use (where slides are viewed full screen in a slide show), this does not matter.</li>
<li>Remove <code>\strut</code> at beginning of table cells (#3436). This fixes a problem with alignment of lists in table cells. The <code>\strut</code> at the end seems to be enough to avoid the too-close spacing that motivated addition of the strut in #1573.</li>
<li>Add partial siunitx Support (Marc Schreiber, #3588).</li>
</ul></li>
<li><p>ConTeXt writer:</p>
<ul>
<li>Refactored to use BCP47 module.</li>
<li>Remove unnecessary <code>$</code> (Alexander Krotov, #3482).</li>
<li>Use header identifiers for chapters (#3968).</li>
</ul></li>
<li><p>EPUB writer:</p>
<ul>
<li><code>title_page.xhtml</code> is now put in <code>text/</code>.</li>
<li>Don’t strip formatting in TOC (#1611).</li>
</ul></li>
<li><p>Textile reader:</p>
<ul>
<li>Fix bug for certain links in table cells (#3667).</li>
<li>Allow ‘pre’ code in list item (#3916).</li>
</ul></li>
<li><p>HTML reader:</p>
<ul>
<li>Added warnings for ignored material (#3392).</li>
<li>Better sanity checks to avoid parsing unintended things as raw HTML in the Markdown reader (#3257).</li>
<li>Revise treatment of <code>li</code> with <code>id</code> attribute (#3596). Previously we always added an empty div before the list item, but this created problems with spacing in tight lists. Now we do this: If the list item contents begin with a <code>Plain</code> block, we modify the <code>Plain</code> block by adding a <code>Span</code> around its contents. Otherwise, we add a <code>Div</code> around the contents of the list item (instead of adding an empty <code>Div</code> to the beginning, as before).</li>
<li>Add <code>details</code> tag to list of block tags (#3694).</li>
<li>Removed <code>button</code> from block tag list (#3717). It is already in the <code>eitherBlockOrInlineTag</code> list, and should be both places.</li>
<li>Use <code>Set</code>s instead of lists for block tag lookup.</li>
<li>Rewrote to use <code>Text</code> throughout. Effect on memory usage is modest (&lt; 10%).</li>
<li>Use the lang value of <code>&lt;html&gt;</code> to set the lang meta value (bucklereed, #3765).</li>
<li>Ensure that paragraphs are closed properly when the parent block element closes, even without <code>&lt;/p&gt;</code> (#3794).</li>
<li>Parse <code>&lt;figure&gt;</code> and <code>&lt;figcaption&gt;</code> (Mauro Bieg, #3813).</li>
<li>Parse <code>&lt;main&gt;</code> like <code>&lt;div role=main&gt;</code> (bucklereed, #3791). <code>&lt;main&gt;</code> closes <code>&lt;p&gt;</code> and behaves like a block element generally</li>
<li>Support column alignments (#1881). These can be set either with a <code>width</code> attribute or with <code>text-width</code> in a <code>style</code> attribute.</li>
<li>Modified state type to be an instance of <code>HasLogMessages</code>, so <code>registerHeader</code> can issue warnings.</li>
<li><code>&lt;/td&gt;</code> or <code>&lt;/th&gt;</code> should close any open block tag (#3991).</li>
<li><code>&lt;td&gt;</code> should close an open <code>&lt;th&gt;</code> or <code>&lt;td&gt;</code>.</li>
<li><code>htmlTag</code> improvements (#3989). We previously failed on cases where an attribute contained a <code>&gt;</code> character. This patch fixes the bug, which especially affects raw HTML in Markdown.</li>
</ul></li>
<li><p>Txt2Tags reader:</p>
<ul>
<li>Newline is not indentation (Alexander Krotov).</li>
</ul></li>
<li><p>MediaWiki reader:</p>
<ul>
<li>Allow extra hyphens after <code>|-</code> in tables (#2649).</li>
<li>Allow blank line after table start (#2649).</li>
<li>Fixed more table issues (#2649).</li>
<li>Ensure that list starts begin at left margin (#2606). Including when they’re in tables or other list items.</li>
<li>Make smart double quotes depend on <code>smart</code> extension (#3585).</li>
<li>Don’t do curly quotes inside <code>&lt;tt&gt;</code> contexts (#3585). Even if <code>+smart</code>.</li>
<li>Modified state type to be an instance of <code>HasLogMessages</code>, so <code>registerHeader</code> can issue warnings.</li>
</ul></li>
<li><p>TWiki reader (Alexander Krotov):</p>
<ul>
<li>Remove unnecessary <code>$</code> (#3597).</li>
<li>Simplify <code>linkText</code> (#3605).</li>
</ul></li>
<li><p>EPUB reader:</p>
<ul>
<li>Minor refactoring, avoiding explicit MediaBag handling. This all works behind the scenes in CommonState plumbing.</li>
</ul></li>
<li><p>Docx reader:</p>
<ul>
<li>Don’t drop smartTag contents (#2242).</li>
<li>Handle local namespace declarations (#3365). Previously we didn’t recognize math, for example, when the xmlns declaration occured on the element and not the root.</li>
<li>More efficient trimSps (#1530). Replacing <code>trimLineBreaks</code>. This does the work of <code>normalizeSpaces</code> as well, so we avoid the need for that function here.</li>
<li>Avoid 0-level headers (Jesse Rosenthal, #3830). We used to parse paragraphs styled with “HeadingN” as “nth-level header.” But if a document has a custom style named “Heading0”, this will produce a 0-level header, which shouldn’t exist. We only parse this style if N&gt;0. Otherwise we treat it as a normal style name, and follow its dependencies, if any.</li>
<li>Add tests for avoiding zero-level header (Jesse Rosenthal).</li>
</ul></li>
<li><p>ODT reader:</p>
<ul>
<li>Replaced <code>collectRights</code> with Rights from <code>Data.Either</code>.</li>
<li>Remove dead code (Albert Krewinkel).</li>
</ul></li>
<li><p>Org reader (Albert Krewinkel, unless noted).</p>
<ul>
<li>Don’t allow tables inside list items (John MacFarlane, #3499).</li>
<li>Disallow tables on list marker lines (#3499).</li>
<li>Convert markup at beginning of footnotes (John MacFarlane, #3576).</li>
<li>Allow emphasized text to be followed by <code>[</code> (#3577).</li>
<li>Handle line numbering switch for src blocks. The line-numbering switch that can be given to source blocks (<code>-n</code> with an start number as an optional parameter) is parsed and translated to a class/key-value combination used by highlighting and other readers and writers.</li>
<li>Stop adding rundoc prefix to src params. Source block parameter names are no longer prefixed with <code>rundoc</code>. This was intended to simplify working with the rundoc project, a babel runner. However, the rundoc project is unmaintained, and adding those markers is not the reader’s job anyway. The original language that is specified for a source element is now retained as the <code>data-org-language</code> attribute and only added if it differs from the translated language.</li>
<li>Allow multi-word arguments to src block params (#3477). The reader now correctly parses src block parameter list even if parameter arguments contain multiple words.</li>
<li>Avoid creating <code>nullMeta</code> by applying <code>setMeta</code> directly (Alexander Krotov).</li>
<li>Replace <code>sequence . map</code> with <code>mapM</code>.</li>
<li>Fix smart parsing behavior. Parsing of smart quotes and special characters can either be enabled via the <code>smart</code> language extension or the <code>'</code> and <code>-</code> export options. Smart parsing is active if either the extension or export option is enabled. Only smart parsing of special characters (like ellipses and en and em dashes) is enabled by default, while smart quotes are disabled. Previously, all smart parsing was disabled unless the language extension was enabled.</li>
<li>Subject full doc tree to headline transformations (Albert Krewinkel, #3695). Emacs parses org documents into a tree structure, which is then post-processed during exporting. The reader is changed to do the same, turning the document into a single tree of headlines starting at level 0.</li>
<li>Fix cite parsing behaviour (Herwig Stuetz). Until now, <code>org-ref</code> cite keys included special characters also at the end. This caused problems when citations occur right before colons or at the end of a sentence. With this change, all non alphanumeric characters at the end of a cite key are ignored. This also adds <code>,</code> to the list of special characters that are legal in cite keys to better mirror the behaviour of org-export.</li>
<li>Fix module names in haddock comments. Copy-pasting had lead to haddock module descriptions containing the wrong module names.</li>
<li>Recognize babel result blocks with attributes (#3706). Babel result blocks can have block attributes like captions and names. Result blocks with attributes were not recognized and were parsed as normal blocks without attributes.</li>
<li>Include tags in headlines. The Emacs default is to include tags in the headline when exporting. Instead of just empty spans, which contain the tag name as attribute, tags are rendered as small caps and wrapped in those spans. Non-breaking spaces serve as separators for multiple tags.</li>
<li>Respect export option for tags (#3713). Tags are appended to headlines by default, but will be omitted when the <code>tags</code> export option is set to nil.</li>
<li>Use <code>tag-name</code> attribute instead of <code>data-tag-name</code>.</li>
<li>Use <code>org-language</code> attribute rather than <code>data-org-language</code>.</li>
<li>Modified state type to be an instance of <code>HasLogMessages</code>, so <code>registerHeader</code> can issue warnings.</li>
<li>End footnotes after two blank lines. Footnotes can not only be terminated by the start of a new footnote or a header, but also by two consecutive blank lines.</li>
<li>Update emphasis border chars (#3933). The org reader was updated to match current org-mode behavior: the set of characters which are acceptable to occur as the first or last character in an org emphasis have been changed and now allows all non-whitespace chars at the inner border of emphasized text (see <code>org-emphasis-regexp-components</code>).</li>
</ul></li>
<li><p>RST reader:</p>
<ul>
<li><p>Fixed small bug in list parsing (#3432). Previously the parser didn’t handle properly this case:</p>
<pre><code>* - a
  - b
* - c
  - d</code></pre></li>
<li>Handle multiline cells in simple tables (#1166).</li>
<li>Parse list table directive (Keiichiro Shikano, #3432).</li>
<li>Make use of <code>anyLineNewline</code> (Alexander Krotov, #3686).</li>
<li>Use <code>anyLineNewline</code> in <code>rawListItem</code> (Alexander Krotov, #3702).</li>
<li>Reorganize block parsers for ~20% faster parsing.</li>
<li>Fixed <code>..include::</code> directive (#3880).</li>
<li>Handle blank lines correctly in line blocks (Alexander Krotov, #3881). Previously pandoc would sometimes combine two line blocks separated by blanks, and ignore trailing blank lines within the line block.</li>
<li><p>Fix indirect hyperlink targets (#512).</p></li>
</ul></li>
<li><p>Markdown reader:</p>
<ul>
<li>Allow attributes in reference links to start on next line (#3674).</li>
<li>Parse YAML metadata in a context that sees footnotes defined in the body of the document (#1279).</li>
<li>When splitting pipe table cells, skip tex math (#3481). You might have a <code>|</code> character inside math. (Or for that matter something that the parser might mistake for raw HTML.)</li>
<li>Treat span with class <code>smallcaps</code> as SmallCaps. This allows users to specify small caps in Markdown this way: <code>[my text]{.smallcaps}</code> (#1592).</li>
<li>Fixed internal header links (#2397). This patch also adds <code>shortcut_reference_links</code> to the list of mmd extensions.</li>
<li>Treat certain environments as inline when they occur without space surrounding them (#3309, #2171). E.g. equation, math. This avoids incorrect vertical space around equations.</li>
<li>Optimized <code>nonindentSpaces</code>. Makes the benchmark go from 40 to 36 ms.</li>
<li>Allow latex macro definitions indented 1-3 spaces. Previously they only worked if nonindented.</li>
<li>Improved parsing of indented raw HTML blocks (#1841). Previously we inadvertently interpreted indented HTML as code blocks. This was a regression. We now seek to determine the indentation level of the contents of an HTML block, and (optionally) skip that much indentation. As a side effect, indentation may be stripped off of raw HTML blocks, if <code>markdown_in_html_blocks</code> is used. This is better than having things interpreted as indented code blocks.</li>
<li>Fixed smart quotes after emphasis (#2228). E.g. in <code>*foo*'s 'foo'</code>.</li>
<li>Warn for notes defined but not used (#1718).</li>
<li>Use <code>anyLineNewline</code> (Alexander Krotov).</li>
<li>Interpret YAML metadata as Inlines when possible (#3755). If the metadata field is all on one line, we try to interpret it as Inlines, and only try parsing as Blocks if that fails. If it extends over one line (including possibly the <code>|</code> or <code>&gt;</code> character signaling an indented block), then we parse as Blocks. This was motivated by some German users finding that <code>date: '22. Juin 2017'</code> got parsed as an ordered list.</li>
<li>Fixed spurious parsing as citation as reference def (#3840). We now disallow reference keys starting with <code>@</code> if the <code>citations</code> extension is enabled.</li>
<li>Parse <code>-@roe</code> as suppress-author citation (pandoc-citeproc#237). Previously only <code>[-@roe]</code> (with brackets) was recognized as suppress-author, and <code>-@roe</code> was treated the same as <code>@roe</code>.</li>
<li>Fixed parsing of fenced code after list when there is no intervening blank line (#3733).</li>
<li>Allow raw latex commands starting with <code>\start</code> (#3558). Previously these weren’t allowed because they were interpreted as starting ConTeXt environments, even without a corresponding <code>\stop</code>…</li>
<li>Added <code>inlines</code>, <code>inlines1</code>.</li>
<li>Require nonempty alt text for <code>implicit_figures</code> (#2844). A figure with an empty caption doesn’t make sense.</li>
<li>Removed texmath macro material; now all this is handled in the LaTeX reader functions.</li>
<li>Fixed bug with indented code following raw LaTeX (#3947).</li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Rewrote LaTeX reader with proper tokenization (#1390, #2118, #3236, #3779, #934, #982). This rewrite is primarily motivated by the need to get macros working properly. A side benefit is that the reader is significantly faster. We now tokenize the input text, then parse the token stream. Macros modify the token stream, so they should now be effective in any context, including math. Thus, we no longer need the clunky macro processing capacities of texmath.</li>
<li>Parse <code>\,</code> to <code>\8198</code> (six-per-em space) (Henri Werth).</li>
<li>Allow <code>\newcommand\foo{blah}</code> without braces.</li>
<li>Support <code>\lstinputlisting</code> (#2116).</li>
<li>Issue warnings when skipping unknown latex commands (#3392).</li>
<li>Include contents of <code>\parbox</code>.</li>
<li>Allow <code>\hspace</code> and <code>\vspace</code> to count as raw block or inline. Previously we would refuse to parse anything as raw inline if it was in the <code>blockCommands</code> list. Now we allow exceptions if they’re listed under ignoreInlines in inlineCommands. This should make it easier e.g. to include an <code>\hspace</code> between two side-by-side raw LaTeX tables.</li>
<li>Don’t drop contents of <code>\hypertarget</code>.</li>
<li>Handle spaces before <code>\cite</code> arguments.</li>
<li>Allow newpage, clearpage, pagebreak in inline contexts as well as block contexts (#3494).</li>
<li>Treat <code>{{xxx}}</code> the same as <code>{xxx}</code> (#2115).</li>
<li>Use <code>pMacroDefinition</code> in macro (for more direct parsing). Note that this means that <code>macro</code> will now parse one macro at a time, rather than parsing a whole group together.</li>
<li>Fixed failures on ,  with <code>+raw_tex</code>. Now these commands are parsed as raw if <code>+raw_tex</code>; otherwise, their argument is parsed as a bracketed string.</li>
<li>Don’t crash on empty <code>enumerate</code> environment (#3707).</li>
<li>Handle escaped <code>&amp;</code> inside table cell (#3708).</li>
<li>Handle block structure inside table cells (#3709). <code>minipage</code> is no longer required.</li>
<li>Handle some width specifiers on table columns (#3709). Currently we only handle the form <code>0.9\linewidth</code>. Anything else would have to be converted to a percentage, using some kind arbitrary assumptions about line widths.</li>
<li>Make sure <code>\write18</code> is parsed as raw LaTeX. The change is in the LaTeX reader’s treatment of raw commands, but it also affects the Markdown reader.</li>
<li>Fixed regression with starred environment names (#3803).</li>
<li>Handle optional args in raw <code>\titleformat</code> (#3804).</li>
<li>Improved heuristic for raw block/inline. An unknown command at the beginning of the line that could be either block or inline is treated as block if we have a sequence of block commands followed by a newline or a <code>\startXXX</code> command (which might start a raw ConTeXt environment).</li>
<li>Don’t remove macro definitions from the output, even if <code>Ext_latex_macros</code> is set, so that macros will be applied. Since they’re only applied to math in Markdown, removing the macros can have bad effects. Even for math macros, keeping them should be harmless.</li>
<li>Removed <code>macro</code>. It is no longer necessary, since the <code>rawLaTeXBlock</code> parser will parse macro definitions. This also avoids the need for a separate <code>latexMacro</code> parser in the Markdown reader.</li>
<li>Use <code>label</code> instead of <code>data-label</code> for label in caption (#3639).</li>
<li>Fixed space after etc.</li>
<li>Resolve references to section numbers.</li>
<li>Fix <code>\let\a=0</code> case, with single character token.</li>
<li>Allow <code>@</code> as a letter in control sequences. <code>@</code> is commonly used in macros using <code>\makeatletter</code>. Ideally we’d make the tokenizer sensitive to <code>\makeatletter</code> and <code>\makeatother</code>, but until then this seems a good change.</li>
<li>Track header numbers and correlate with labels.</li>
<li>Allow <code>]</code> inside group in option brackets (#3857).</li>
<li>lstinline with braces can be used (verb cannot be used with braces) (Marc Schreiber, #3535).</li>
<li>Fix keyval funtion: pandoc did not parse options in braces correctly (Marc Schreiber, #3642).</li>
<li>When parsing raw LaTeX commands, include trailing space (#1773). Otherwise things like <code>\noindent foo</code> break and turn into <code>\noindentfoo</code>. Affects <code>-f latex+raw_tex</code> and <code>-f markdown</code> (and other formats that allow <code>raw_tex</code>).</li>
<li>Don’t treat “…” as Quoted (#3958). This caused quotes to be omitted in <code>\texttt</code> contexts.</li>
<li>Add tests for existing <code>\includegraphics</code> behaviour (Ben Firshman).</li>
<li>Allow space before <code>=</code> in bracketd options (Ben Firshman).</li>
<li>Be more forgiving in parsing command options. This was needed, for example, to make some minted options work.</li>
<li>Strip off quotes in <code>\include</code> filenames.</li>
</ul></li>
<li><p>Added <code>Text.Pandoc.CSV</code>, simple (unexported) CSV parser.</p></li>
<li><p><code>Text.Pandoc.PDF</code>:</p>
<ul>
<li>Got <code>--resource-path</code> working with PDF output (#852).</li>
<li>Fetch images when generating PDF via context (#3380). To do this, we create the temp directory as a subdirectory of the working directory. Since context mk IV by default looks for images in the parent directory, this works.</li>
<li>Use <code>report</code> instead of <code>warn</code>, make it sensitive to verbosity settings.</li>
<li>Use <code>fillMediaBag</code> and <code>extractMedia</code> to extract media to temp dir. This reduces code duplication.</li>
<li><code>html2pdf</code>: use stdin instead of intermediate HTML file</li>
<li>Removed useless <code>TEXINPUTS</code> stuff for <code>context2pdf</code>. mkiv context doesn’t use <code>TEXINPUTS</code>.</li>
</ul></li>
<li><p><code>Text.Pandoc.Pretty</code>:</p>
<ul>
<li>Simplified definition of <code>realLength</code>.</li>
<li>Don’t error for blocks of size &lt; 1. Instead, resize to 1 (see #1785).</li>
</ul></li>
<li><p><code>Text.Pandoc.MIME</code>:</p>
<ul>
<li>Use <code>application/javascript</code> (not <code>application/x-javascript</code>).</li>
<li>Added <code>emf</code> to mimeTypes with type <code>application/x-msmetafile</code> (#1713).</li>
</ul></li>
<li><p><code>Text.Pandoc.ImageSize</code>:</p>
<ul>
<li>Improve SVG image size code (Marc Schreiber, #3580).</li>
<li>Make <code>imageSize</code> recognize basic SVG dimensions (Mauro Bieg, #3462).</li>
</ul></li>
<li><p>Use <code>Control.Monad.State.Strict</code> throughout. This gives 20-30% speedup and reduction of memory usage in most of the writers.</p></li>
<li><p>Use <code>foldrWithKey</code> instead of deprecated <code>foldWithKey</code>.</p></li>
<li><p><code>Text.Pandoc.SelfContained</code>:</p>
<ul>
<li>Fixed problem with embedded fonts (#3629).</li>
<li>Refactored getData from <code>getDataURI</code> in <code>SelfContained</code>.</li>
<li>Don’t use data URIs for script or style (#3423). Instead, just use script or style tags with the content inside. The old method with data URIs prevents certain optimizations outside pandoc. Exception: data URIs are still used when a script contains <code>&lt;/script&gt;</code> or a style contains <code>&lt;/</code>.</li>
<li>SelfContained: Handle URL inside material retrieved from a URL (#3629). This can happen e.g. with an <span class="citation" data-cites="import">@import</span> of a google web font. (What is imported is some CSS which contains an url reference to the font itself.) Also, allow unescaped pipe (|) in URL.</li>
<li>Load resources from <code>data-src</code> (needed for lazy loading in reveal.js slide shows).</li>
<li>Handle <code>data-background-image</code> attribute on section (#3979).</li>
</ul></li>
<li><p><code>Text.Pandoc.Parsing</code>:</p>
<ul>
<li>Added <code>indentWith</code> (Alexander Krotov, #3687).</li>
<li>Added <code>stateCitations</code> to <code>ParserState</code>.</li>
<li>Removed <code>stateChapters</code> from <code>ParserState</code>.</li>
<li>In <code>ParserState</code>, make <code>stateNotes'</code> a Map, add <code>stateNoteRefs</code>.</li>
<li>Added <code>gobbleSpaces</code> and <code>gobbleAtMostSpaces</code>.</li>
<li>Adjusted type of <code>insertIncludedFile</code> so it can be used with token parser.</li>
<li>Replace old texmath macro stuff from Parsing. Use Macro from Text.Pandoc.Readers.LaTeX.Types instead.</li>
<li>Export <code>insertIncludedFile</code>.</li>
<li>Added <code>HasLogMessages</code>, <code>logMessage</code>, <code>reportLogMessages</code> (#3447).</li>
<li>Replace partial with total function (Albert Krewinkel).</li>
<li>Introduce <code>HasIncludeFiles</code> type class (Albert Krewinkel). The <code>insertIncludeFile</code> function is generalized to work with all parser states which are instances of that class.</li>
<li>Add <code>insertIncludedFilesF</code> which returns F blocks (Albert Krewinkel). The <code>insertIncludeFiles</code> function was generalized and renamed to <code>insertIncludedFiles'</code>; the specialized versions are based on that.</li>
<li><code>many1Till</code>: Check for the end condition before parsing (Herwig Stuetz). By not checking for the end condition before the first parse, the parser was applied too often, consuming too much of the input. This only affects <code>many1Till p end</code> where <code>p</code> matches on a prefix of <code>end</code>.</li>
<li>Provide <code>parseFromString</code> (#3690). This is a verison of <code>parseFromString</code> specialied to ParserState, which resets <code>stateLastStrPos</code> at the end. This is almost always what we want. This fixes a bug where <code>_hi_</code> wasn’t treated as emphasis in the following, because pandoc got confused about the position of the last word: <code>- [o] _hi_</code>.</li>
<li>Added <code>takeP</code>, <code>takeWhileP</code> for efficient parsing of <code>[Char]</code>.</li>
<li>Fix <code>blanklines</code> documentation (Alexander Krotov, #3843).</li>
<li>Give less misleading line information with <code>parseWithString</code>. Previously positions would be reported past the end of the chunk. We now reset the source position within the chunk and report positions “in chunk.”</li>
<li>Add <code>anyLineNewline</code> (Alexander Krotov).</li>
<li>Provide shared F monad functions for Markdown and Org readers (Albert Krewinkel). The <code>F</code> monads used for delayed evaluation of certain values in the Markdown and Org readers are based on a shared data type capturing the common pattern of both <code>F</code> types.</li>
<li>Add <code>returnF</code> (Alexander Krotov).</li>
<li>Avoid parsing <code>Notes:**</code> as a bare URI (#3570). This avoids parsing bare URIs that start with a scheme + colon + <code>*</code>, <code>_</code>, or <code>]</code>.</li>
<li>Added <code>readerAbbreviations</code> to <code>ParserState</code>. Markdown reader now consults this to determine what is an abbreviation.</li>
<li>Combine grid table parsers (Albert Krewinkel, #3638). The grid table parsers for markdown and rst was combined into one single parser <code>gridTable</code>, slightly changing parsing behavior of both parsers: (1) The markdown parser now compactifies block content cell-wise: pure text blocks in cells are now treated as paragraphs only if the cell contains multiple paragraphs, and as plain blocks otherwise. Before, this was true only for single-column tables. (2) The rst parser now accepts newlines and multiple blocks in header cells.</li>
<li>Generalize tableWith, gridTableWith (Albert Krewinkel). The parsing functions <code>tableWith</code> and <code>gridTableWith</code> are generalized to work with more parsers. The parser state only has to be an instance of the <code>HasOptions</code> class instead of requiring a concrete type. Block parsers are required to return blocks wrapped into a monad, as this makes it possible to use parsers returning results wrapped in <code>Future</code>s.</li>
</ul></li>
<li><p><code>Text.Pandoc.Shared</code>:</p>
<ul>
<li>Simplify <code>toRomanNumeral</code> using guards (Alexander Krotov, #3445)</li>
<li><code>stringify</code>: handle Quoted better (#3958). Previously we were losing the quotation marks in Quoted elements.</li>
</ul></li>
<li><p><code>Text.Pandoc.Writers.Shared</code>:</p>
<ul>
<li>Export <code>metaToJSON'</code>, <code>addVariablesToJSON</code> (#3439). This allows us to add the variables AFTER using the metadata to generate a YAML header (in the Markdown writer).</li>
<li>Added <code>unsmartify</code> (previously in RST writer). Undo literal double curly quotes. Previously we left these.</li>
<li>Generalize type of <code>metaToJSON</code> so it can take a Text. Previously a String was needed as argument; now any ToJSON instance will do.</li>
<li>Added <code>gridTable</code> (previously in Markdown writer).</li>
<li><code>gridTable</code>: Refactored to use widths in chars.</li>
<li><code>gridTable</code>: remove unnecessary extra space in cells.</li>
<li>Fixed <code>addVariablesToJSON</code>. It was previously not allowing multiple values to become lists.</li>
<li>Pipe tables: impose minimum cell size (see #3526).</li>
</ul></li>
</ul>
<h2 id="default-template-changes">Default template changes</h2>
<ul>
<li><p>HTML templates (including EPUB and HTML slide show templates):</p>
<ul>
<li>Make default.html5 polyglot markup conformant (John Luke Bentley, #3473). Polyglot markup is HTML5 that is also valid XHTML. See <a href="https://www.w3.org/TR/html-polyglot" class="uri">https://www.w3.org/TR/html-polyglot</a>. With this change, pandoc’s html5 writer creates HTML that is both valid HTML5 and valid XHTML.</li>
<li>Regularized CSS in html/epub/html slide templates (#3485). All templates now include <code>code{white-space: pre-wrap}</code> and CSS for <code>q</code> if <code>--html-q-tags</code> is used. Previously some templates had <code>pre</code> and others <code>pre-wrap</code>; the <code>q</code> styles were only sometimes included.</li>
<li>CSS for <code>.smallcaps</code>, (Mauro Bieg, #1592)</li>
<li><code>default.revealjs</code>: make <code>history</code> default to true.</li>
<li><code>default.revealjs</code>: use lazy loading (#2283).</li>
<li><code>default.revealjs</code>: add <code>mathjax</code> variable and some conditional code to use the MathJaX plugin.</li>
<li><code>default.slidy</code> uses <code>https</code> instead of <code>http</code> (ickc, #3848).</li>
<li><code>default.dzslides</code>: Load Google Font using HTTPS by default (Yoan Blanc).</li>
</ul></li>
<li><p>DocBook5 template: Use <code>lang</code> and <code>subtitle</code> variables (Jens Getreu, #3855).</p></li>
<li><p>LaTeX/Beamer template:</p>
<ul>
<li>Combine LaTeX/Beamer templates (Andrew Dunning, #3878). <code>default.beamer</code> has been removed; beamer now uses the <code>default.latex</code> template. Beamer-specific parts are conditional on the <code>beamer</code> variable set by the writer. Note that <code>pandoc -D beamer</code> will return this (combined) template.</li>
<li>Use <code>xcolor</code> for <code>colorlinks</code> option (Andrew Dunning, #3877). Beamer loads <code>xcolor</code> rather than <code>color</code>, and thus the <code>dvipsnames</code> option doesn’t take effect. This also provides a wider range of colour selections with the <code>svgnames</code> option.</li>
<li>Use starred versions of <code>xcolor</code> names (Andrew Dunning). Prevents changes to documents defined using the <code>dvipsnames</code> list (e.g. <code>Blue</code> gives a different result with svgnames enabled).</li>
<li>Load <code>polyglossia</code> after header-includes (#3898). It needs to be loaded as late as possible.</li>
<li>Use <code>unicode-math</code> (Vaclav Haisman). Use <code>mathspec</code> with only XeLaTeX on request.</li>
<li>Don’t load <code>fontspec</code> before <code>unicode-math</code> (over there). The <code>unicode-math</code> package loads <code>fontspec</code> so explict loading of <code>fontspec</code> before <code>unicode-math</code> is not necessary.</li>
<li>Use <code>unicode-math</code> by default in default.latex template. mathspec will be used in xelatex if the <code>mathspec</code> variable is set; otherwise unicode-math will be used (Václav Haisman).</li>
<li>Use <code>dvipsnames</code> options when <code>colorlinks</code> specified (otherwise we get an error for <code>maroon</code>) (Thomas Hodgson).</li>
<li>Added beamer <code>titlegraphic</code> and <code>logo</code> variables (Thomas Hodgson).</li>
<li>Fix typo in fix for notes in tables (#2378, zeeMonkeez).</li>
<li>Fix <code>hyperref</code> options clash (Andrew Dunning, #3847) Avoids an options clash when loading a package (e.g. <code>tufte-latex</code>) that uses <code>hyperref</code> settings different from those in the template.</li>
<li>Add <code>natbiboptions</code> variable (#3768).</li>
<li>Fix links inside captions in LaTeX output with links-as-notes (Václav Haisman, #3651). Declare our redefined <code>\href</code> robust.</li>
<li>Load <code>parskip</code> before <code>hyperref</code> (Václav Haisman, #3654).</li>
<li>Allow setting Japanese fonts when using LuaLaTeX (Václav Haisman, #3873). by using the <code>luatexja-fontspec</code> and <code>luatexja-preset</code> packages. Use existing <code>CJKmainfont</code> and <code>CJKoptions</code> template variables. Add <code>luatexjafontspecoptions</code> for <code>luatexja-fontspec</code> and <code>luatexjapresetoptions</code> for <code>luatexja-preset</code>.</li>
<li>Added <code>aspectratio</code> variable to beamer template (Václav Haisman, #3723).</li>
<li>Modified template.latex to fix XeLaTex being used with tables (lwolfsonkin, #3661). Reordered <code>lang</code> variable handling to immediately before <code>bidi</code>.</li>
</ul></li>
<li><p>ConTeXt template: Improved font handling: <code>simplefonts</code> is now obsolete in ConTeXt (Pablo Rodríguez).</p></li>
</ul>
<h2 id="documentation-improvements">Documentation improvements</h2>
<ul>
<li><p>MANUAL.txt:</p>
<ul>
<li>Add URL for Prince HTML &gt; PDF engine (Ian, #3919).</li>
<li>Document that content above slide-level will be omitted in slide shows. See #3460, #2265.</li>
<li>Explain <code>--webtex</code> SVG url (Mauro Bieg, #3471)</li>
<li>Small clarification in YAML metadata section.</li>
<li>Document that html4 is technically XHTML 1.0 transitional.</li>
<li>Remove refs to highlighting-kate (#3672).</li>
<li>Document ibooks specific epub metadata.</li>
<li>Clarify that mathml is used for ODT math.</li>
<li>Mention limitations of Literate Haskell Support (#3410, Joachim Breitner).</li>
<li>Add documentation of limitations of grid tables (Stephen McDowell, #3864).</li>
<li>Clarify that meta-json contains transformed values (Jakob Voß, #3491) Make clear that template variable <code>meta-json</code> does not contain plain text values or JSON output format but field values transformed to the selected output format.</li>
</ul></li>
<li><p>COPYRIGHT:</p>
<ul>
<li>Clarify that templates are dual-licensed.</li>
<li>Clarify that pandoc-types is BSD3 licensed.</li>
<li>List new files not written by jgm (Albert Krewinkel).</li>
<li>Update dates in copyright notices (Albert Krewinkel). This follows the suggestions given by the FSF for GPL licensed software. <a href="https://www.gnu.org/prep/maintain/html_node/Copyright-Notices.html" class="uri">https://www.gnu.org/prep/maintain/html_node/Copyright-Notices.html</a></li>
</ul></li>
<li><p>INSTALL.md:</p>
<ul>
<li>Improved instructions for tests with patterns.</li>
<li>Put RPM-based distros on separate point (Mauro Bieg, #3449)</li>
</ul></li>
<li><p>CONTRIBUTING.md:</p>
<ul>
<li>Fixed typos (Wandmalfarbe, #3479).</li>
<li>Add “ask on pandoc-discuss” (Mauro Bieg).</li>
</ul></li>
<li><p>Add lua filter documentation in <code>doc/lua-filters.md</code>. Note that the end of this document is autogenerated from <code>data/pandoc.lua</code> using <code>make doc/lua-filters.md</code>, which uses <code>tools/ldoc.ltp</code> (Albert Krewinkel).</p></li>
<li><p>Add <code>doc/filters.md</code>. This is the old scripting tutorial from the website.</p></li>
<li><p>Add <code>doc/using-the-pandoc-api.md</code> (#3289). This gives an introduction to using pandoc as a Haskell library.</p></li>
</ul>
<h2 id="build-infrastructure-improvements">Build infrastructure improvements</h2>
<ul>
<li><p>Removed <code>data/templates</code> submodule. Templates are now a subtree in <code>data/templates</code>. This removes the need to do <code>git submodule update</code>.</p></li>
<li><p>Renamed <code>tests</code> -&gt; <code>test</code>.</p></li>
<li><p>Remove <code>https</code> flag. Always build with HTTPS support.</p></li>
<li><p>Use <code>file-embed</code> instead of <code>hsb2hs</code> to embed data files when <code>embed_data_files</code> flag is set. <code>file-embed</code> gives us better dependency tracking: if a data file changes, ghc/stack/cabal know to recompile the Data module. This also removes <code>hsb2hs</code> as a build dependency.</p></li>
<li><p>Add <code>custom-setup</code> stanza to pandoc, lowercase field names.</p></li>
<li><p>Add <code>static</code> Cabal flag.</p></li>
<li><p>Name change OSX -&gt; MacOS. Add a -MacOS suffix to mac package rather than -OSX. Changed local names from osx to macos.</p></li>
<li><p>make_macos_package.sh - Use strip to reduce executable size.</p></li>
<li><p>Revised binary linux package. Now a completely static executable is created, using Docker and alpine. We create both a deb and a tarball. The old <code>deb</code> directory has been replaced with a <code>linux</code> directory. Running <code>make</code> in the <code>linux</code> directory should perform the build, putting the binary packages in <code>artifacts/</code>.</p></li>
<li><p><code>linux/control.in</code>: add <code>Replaces:</code>, so existing pandoc-citeproc and pandoc-data packages will be uninstalled; this package provides both (#3822). Add latex packages as ‘suggested’, update description.</p></li>
<li><p>Remove cpphs build requirement – it is no longer needed.</p></li>
<li><p>Replaced <code>{deb,macos,windows}/stack.yaml</code> with <code>stack.pkg.yaml</code>.</p></li>
<li><p>Name change OSX -&gt; macOS (ickc, #3869).</p></li>
<li><p>Fix casing of Linux, UNIX, and Windows (ickc).</p></li>
<li><p><code>.travis.yml</code>: create a source dist and do cabal build and test there. That way we catch errors due to files missing from the data section of pandoc.cabal.</p></li>
<li><p>Makefile:</p>
<ul>
<li>Split <code>make haddock</code> from <code>make full</code>.</li>
<li>Add BRANCH variable for winpkg.</li>
<li>Add <code>lint</code> target.</li>
<li>Improve <code>make full</code>. Disable optimizations. Build everything, inc. trypandoc and benchmarks. Use parallel build.</li>
<li>Allow <code>make test</code> to take <code>TESTARGS</code>.</li>
</ul></li>
<li><p>Added new command tests (<code>Tests.Command</code>), using small text files in <code>test/command/</code>. Any files added in this directory will be treated as shell tests (see smart.md for an example). This makes it very easy to add regression tests etc.</p></li>
<li><p>Test fixes so we can find data files. In old tests &amp; command tests, we now set the environment variable <code>pandoc_datadir</code>. In lua tests, we set the datadir explicitly.</p></li>
<li><p>Refactored <code>compareOutput</code> in docx writer test.</p></li>
<li><p>Consolidated some common functions in <code>Tests.Helper</code>.</p></li>
<li><p>Small change to unbalanced bracket test to speed up test suite.</p></li>
<li><p>Speed up Native writer quickcheck tests.</p></li>
<li><p>Use tasty for tests rather than test-framework.</p></li>
<li><p>Add simple Emacs mode to help with Pandoc templates editing. (Václav Haisman, #3889). <code>tools/pandoc-template-mode.el</code></p></li>
</ul>
<h1 id="pandoc-1.19.2.4-10-sep-2017">pandoc 1.19.2.4 (10 Sep 2017)</h1>
<ul>
<li>Add dependencies on texmath and skylighting to the executable. This is needed for dependency version numbers to be available, with Cabal &gt; 2.</li>
</ul>
<h1 id="pandoc-1.19.2.3-09-sep-2017">pandoc 1.19.2.3 (09 Sep 2017)</h1>
<ul>
<li>Add CPP to Setup.hs so it works with Cabal &gt;= 2 and &lt; 2.</li>
</ul>
<h1 id="pandoc-1.19.2.2-08-sep-2017">pandoc 1.19.2.2 (08 Sep 2017)</h1>
<ul>
<li>Fix build with GHC 8.2.1 (#3876, Peter Simons). Setup.hs does not compile with Cabal 2.x, so we require an earlier version via setup-depends. The following packages need newer versions with GHC 8.2.1 and had their constraints relaxed accordingly: executable-path, process, syb, and time.</li>
</ul>
<h1 id="pandoc-1.19.2.1-31-jan-2017">pandoc 1.19.2.1 (31 Jan 2017)</h1>
<ul>
<li>Require skylighting &gt;= 0.1.1.4.</li>
<li>Adjust test output for skylighting version.</li>
<li>Relax upper bounds on blaze-html and blaze-markup.</li>
</ul>
<h1 id="pandoc-1.19.2-29-jan-2017">pandoc 1.19.2 (29 Jan 2017)</h1>
<ul>
<li><p>Use skylighting library instead of highlighting-kate for syntax highlighting. Skylighting is faster and more accurate (#3363). Later we’ll be able to add features like warning messages, dynamic loading of xml syntax definitions, and dynamic loading of themes.</p></li>
<li><p>Added a new highlight style, <code>breezeDark</code>.</p></li>
<li><p>Text.Pandoc.Highlighting: Update list of <code>listings</code> languages (#3374). This allows more languages to be used when using the <code>--listings</code> option.</p></li>
<li><p>OpenDocument writer:</p>
<ul>
<li>Small refactoring. Removed separate ‘parent’ parameter in paraStyle.</li>
<li>Don’t profilerate text styles unnecessarily (#3371). This change makes the writer create only as many temporary text styles as are absolutely necessary. It also consolidates adjacent nodes with the same style.</li>
</ul></li>
<li><p>Org reader (Albert Krewinkel):</p>
<ul>
<li>Allow short hand for single-line raw blocks (Albert Krewinkel, #3366). Single-line raw blocks can be given via <code>#+FORMAT: raw line</code>, where <code>FORMAT</code> must be one of <code>latex</code>, <code>beamer</code>, <code>html</code>, or <code>texinfo</code>.</li>
<li>Accept org-ref citations followed by commas (Albert Krewinkel). Bugfix for an issue which, whenever the citation was immediately followed by a comma, prevented correct parsing of org-ref citations.</li>
<li>Ensure emphasis markup can be nested. Nested emphasis markup (e.g. <code>/*strong and emphasized*/</code>) was interpreted incorrectly in that the inner markup was not recognized.</li>
<li>Remove pipe char irking the haddock coverage tool (Albert Krewinkel).</li>
</ul></li>
<li><p>Docx reader: Empty header should be list of lists (Jesse Rosenthal). In the past, the docx reader wrote an empty header as an empty list. It should have the same width as a row (and be filled with empty cells).</p></li>
<li><p>MediaWiki reader:</p>
<ul>
<li>Improved handling of display math (#3362). Sometimes display math is indented with more than one colon. Previously we handled these cases badly, generating definition lists and missing the math.</li>
<li>Fix quotation mark parsing (#3336, tgkokk). Change MediaWiki reader’s behavior when the smart option is parsed to match other readers’ behavior.</li>
</ul></li>
<li><p>Markdown reader:</p>
<ul>
<li>Fixed <code>-f markdown_github-hard_line_breaks+escaped_line_breaks</code> (#3341). Previously this did not properly enable escaped line breaks.</li>
<li>Disallow space between inline code and attributes (#3326, #3323, Mauro Bieg).</li>
</ul></li>
<li><p>DocBook5 writer: make id attribute xml:id, fixes #3329 (#3330, Mauro Bieg).</p></li>
<li><p>Added some test cases for ODT reader (#3306, #3308, Hubert Plociniczak).</p></li>
<li><p>LaTeX writer: allow tables with empty cells to count as “plain.” This addresses a problem of too-wide tables when empty cells are used. Thanks to Joost Kremers for reporting the issue.</p></li>
<li><p>Org writer: prefix footnote numbers with <code>fn:</code> (Albert Krewinkel). Unprefixed numbers where used by older org-mode versions, but are no longer supported.</p></li>
<li><p>HTML writer: don’t process pars with empty RawInline, (#1040, #3327, Mauro Bieg).</p></li>
<li><p>Markdown writer: Fix display math with <code>--webtex</code> (#3298).</p></li>
<li><p>Fix sample.lua so it properly handles raw blocks/inlines (#3358, bumper314).</p></li>
<li><p>Templates:</p>
<ul>
<li>default.latex: Moved geometry after hyperref (Václav Haisman). Otherwise PDF sizes can be wrong in some circumstances.</li>
<li>Copied a few changes from default.latex to default.beamer (Wandmalfarbe).</li>
<li>default.latex, default.beamer: Changed position of <code>\VerbatimNotes</code> and <code>fancyvrb</code>. This fixes hyperlinks on footnotes in documents that contain verbatim in notes (#3361). (Note: the beamer template was updated to match the LaTeX template, but at this point verbatim in notes seems not to work in beamer.)</li>
<li>default.latex: Allow passing <code>microtypeoptions</code> to microtype (Václav Haisman).</li>
<li>default.latex: Add hyphen option to url package.</li>
<li>default.docbook5: Fix namespace declarations (Mauro Bieg).</li>
</ul></li>
<li><p>Moved <code>make_osx_package.sh</code> to <code>osx/</code> directory.</p></li>
<li><p>Travis continuous integration:</p>
<ul>
<li>Fix false positives with dist build.</li>
<li>Speed improvements (Kolen Cheung, #3304, #3357).</li>
</ul></li>
<li><p>MANUAL.txt:</p>
<ul>
<li>Clarify that blank space is needed around footnotes (#3352).</li>
<li>Fixed typo (#3351, Alexey Rogechev).</li>
<li>Note that <code>--wrap=auto</code> does not work in HTML output.</li>
<li>Default <code>--columns</code> width is 72, not 80.</li>
<li>Fixed broken links (#3316, Kolen Cheung).</li>
<li>Document usage of <code>@*</code> in nocite section (#3333, John Muccigrosso).</li>
</ul></li>
<li><p>INSTALL.md:</p>
<ul>
<li>Indent code so it’s properly formatted (#3335, Bheesham Persaud).</li>
<li>Added instructions for extracting binary from OSX, Windows packages.</li>
</ul></li>
<li><p>CONTRIBUTING.md: Describe labels currently used in issue tracker (Albert Krewinkel). The labels have changed over time, the list of labels is updated to reflect the current set of labels used in the issue tracker.</p></li>
<li><p>Rearrange and extend badges in README (Albert Krewinkel, #3354)</p></li>
<li><p>Bumped version bounds for dependencies.</p></li>
</ul>
<h1 id="pandoc-1.19.1-10-dec-2016">pandoc 1.19.1 (10 Dec 2016)</h1>
<ul>
<li><p>Set <code>PANDOC_VERSION</code> environment variable for filters (#2640). This allows filters to check the pandoc version that produced the JSON they are receiving.</p></li>
<li><p>Docx reader: Ensure one-row tables don’t have header (#3285, Jesse Rosenthal). Tables in MS Word are set by default to have special first-row formatting, which pandoc uses to determine whether or not they have a header. This means that one-row tables will, by default, have only a header – which we imagine is not what people want. This change ensures that a one-row table is not understood to be a header only. Note that this means that it is impossible to produce a header-only table from docx, even though it is legal pandoc. But we believe that in nearly all cases, it will be an accidental (and unwelcome) result</p></li>
<li><p>HTML reader:</p>
<ul>
<li>Fixed some bad regressions in HTML table parser (#3280). This regression leads to the introduction of empty rows in some circumstances.</li>
<li>Understand <code>style=width:</code> as well as <code>width</code> in <code>col</code> (#3286).</li>
</ul></li>
<li><p>RST reader:</p>
<ul>
<li><p>Print warnings when keys, substitition, notes not found. Previously the parsers failed and we got raw text. Now we get a link with an empty URL, or empty inlines in the case of a note or substitution.</p></li>
<li><p>Fix hyperlink aliases (#3283).</p></li>
</ul></li>
<li><p>Man writer: Ensure that periods are escaped at beginning of line (#3270).</p></li>
<li><p>LaTeX writer: Fix unnumbered headers when used with <code>--top-level</code> (#3272, Albert Krewinkel). Fix interaction of top-level divisions <code>part</code> or <code>chapter</code> with unnumbered headers when emitting LaTeX. Headers are ensured to be written using stared commands (like <code>\subsection*{}</code>).</p></li>
<li><p>LaTeX template: use comma not semicolon to separate keywords for <code>pdfkeywords</code>. Thanks to Wandmalfarbe.</p></li>
<li><p>Markdown writer: Fixed incorrect word wrapping (#3277). Previously pandoc would sometimes wrap lines too early due to this bug.</p></li>
<li><p>Text.Pandoc.Pretty: Added <code>afterBreak</code> [API change]. This makes it possible to insert escape codes for content that needs escaping at the beginning of a line.</p></li>
<li><p>Removed old MathMLInHTML.js from 2004, which should no longer be needed for MathML with modern browsers.</p></li>
<li><p>Fixed tests with dynamic linking (#2709).</p></li>
<li><p>Makefile: Use stack instead of cabal for targets. This is just a convenience for developers.</p></li>
<li><p>Fixed bash completion of filenames with space (#2749).</p></li>
<li><p>MANUAL: improved documentation on how to create a custom <code>reference.docx</code>.</p></li>
<li><p>Fix minor spelling typos in the manual (#3273, Anthony Geoghegan)</p></li>
</ul>
<h1 id="pandoc-1.19-01-dec-2016">pandoc 1.19 (01 Dec 2016)</h1>
<ul>
<li><p>Changed resolution of filter paths.</p>
<ul>
<li>We now first treat the argument of <code>--filter</code> as a full (absolute or relative) path, looking for a program there. If it’s found, we run it.</li>
<li>If not, and if it is a simple program name or a relative path, we try resolving it relative to <code>$DATADIR/filters</code>.</li>
<li>If this fails, then we treat it as a program name and look in the user’s PATH.</li>
<li>Removed a hardcoded ‘/’ that may have caused problems with Windows paths.</li>
</ul>
<p>Previously if you did <code>--filter foo</code> and you had <code>foo</code> in your path and also an executable <code>foo</code> in your working directory, the one in the path would be used. Now the one in the working directory is used.</p>
<p>In addition, when you do <code>--filter foo/bar.hs</code>, pandoc will now find a filter <code>$DATADIR/filters/foo/bar.hs</code> – assuming there isn’t a <code>foo/bar.hs</code> relative to the working directory.</p></li>
<li><p>Allow <code>file://</code> URIs as arguments (#3196). Also improved default reader format detection. Previously with a URI ending in .md or .markdown, pandoc would assume HTML input. Now it treats these as markdown.</p></li>
<li><p>Allow to overwrite top-level division type heuristics (#3258, Albert Krewinkel). Pandoc uses heuristics to determine the most reasonable top-level division type when emitting LaTeX or Docbook markup. It is now possible to overwrite this implicitly set top-level division via the <code>top-level-division</code> command line parameter.</p></li>
<li><p>Text.Pandoc.Options [API changes]:</p>
<ul>
<li>Removed <code>writerStandalone</code> field in <code>WriterOptions</code>, made <code>writerTemplate</code> a <code>Maybe</code> value. Previously setting <code>writerStandalone = True</code> did nothing unless a template was provided in writerTemplate. Now a fragment will be generated if <code>writerTemplate</code> is <code>Nothing</code>; otherwise, the specified template will be used and standalone output generated.</li>
<li><code>Division</code> has been renamed <code>TopLevelDivision</code> (#3197). The <code>Section</code>, <code>Chapter</code>, and <code>Part</code> constructors were renamed to <code>TopLevelSection</code>, <code>TopLevelChapter</code>, and <code>TopLevelPart</code>, respectively. An additional <code>TopLevelDefault</code> constructor was added, which is now also the new default value of the <code>writerTopLevelDivision</code> field in <code>WriterOptions</code>.</li>
</ul></li>
<li><p>Improved error if they give wrong arg to <code>--top-level-division</code>.</p></li>
<li><p>Use new module from texmath to lookup MS font codepoints in Docx reader. Removed unexported module Text.Pandoc.Readers.Docx.Fonts. Its code now lives in texmath (0.9).</p></li>
<li><p>DocBook reader: Fixed xref lookup (#3243). It previously only worked when the qnames lacked the docbook namespace URI.</p></li>
<li><p>HTML reader:</p>
<ul>
<li>Improved table parsing (#3027). We now check explicitly for non-1 rowspan or colspan attributes, and fail when we encounter them. Previously we checked that each row had the same number of cells, but that could be true even with rowspans/colspans. And there are cases where it isn’t true in tables that we can handle fine – e.g. when a tr element is empty. So now we just pad rows with empty cells when needed.</li>
<li>Treat <code>&lt;math&gt;</code> as MathML by default unless something else is explicitly specified in xmlns. Provided it parses as MathML, of course. Also fixed default which should be to inline math if no display attribute is used.</li>
<li>Only treat “a” element as link if it has href (#3226). Otherwise treat as span.</li>
</ul></li>
<li><p>Docx reader (Jesse Rosenthal):</p>
<ul>
<li>Add a placeholder value for CHART. We wrap <code>[CHART]</code> in a <code>&lt;span class=&quot;chart&quot;&gt;</code>. Note that it maps to inlines because, in docx, anything in a drawing tag can be part of a larger paragraph.</li>
<li>Be more specific in parsing images We not only want <code>w:drawing</code>, because that could also include charts. Now we specify <code>w:drawing/pic:pic</code>. This shouldn’t change behavior at all, but it’s a first step toward allowing other sorts of drawing data as well.</li>
<li>Abstract out function to avoid code repetition.</li>
<li>Update tests for img title and alt (#3204).</li>
<li>Handle Alt text and titles in images. We use the “description” field as alt text and the “title” field as title. These can be accessed through the “Format Picture” dialog in Word.</li>
<li>Docx reader utils: handle empty namespace in <code>elemName</code>. Previously, if given an empty namespace <code>(elemName ns &quot;&quot; &quot;foo&quot;)</code> <code>elemName</code> would output a QName with a <code>Just &quot;&quot;</code> namespace. This is never what we want. Now we output a <code>Nothing</code>. If someone <em>does</em> want a <code>Just &quot;&quot;</code> in the namespace, they can enter the QName value explicitly.</li>
</ul></li>
<li><p>ODT reader/writer:</p>
<ul>
<li>Inline code when text has a special style (Hubert Plociniczak). When a piece of text has a text <code>Source_Text</code> then we assume that this is a piece of the document that represents a code that needs to be inlined. Adapted the writer to also reflect that change. Previously it was just writing a ‘preformatted’ text using a non-distinguishable font style. Code blocks are still not recognized by the ODT reader. That’s a separate issue.</li>
<li><p>Infer table’s caption from the paragraph (#3224, Hubert Plociniczak). ODT’s reader always put empty captions for the parsed tables. This commit</p>
<ol type="1">
<li>checks paragraphs that follow the table definition</li>
<li>treats specially a paragraph with a style named ‘Table’</li>
<li>does some postprocessing of the paragraphs that combines tables followed immediately by captions</li>
</ol>
<p>The ODT writer used the <code>TableCaption</code> style for the caption paragraph. This commit follows the OpenOffice approach which allows for appending captions to table but uses a built-in style named <code>Table</code> instead of <code>TableCaption</code>. Users of a custom <code>reference.odt</code> should change the style’s name from <code>TableCaption</code> to <code>Table</code>.</p></li>
</ul></li>
<li><p>ODT reader: Infer tables’ header props from rows (#3199, Hubert Plociniczak). ODT reader simply provided an empty header list which meant that the contents of the whole table, even if not empty, was simply ignored. While we still do not infer headers we at least have to provide default properties of columns.</p></li>
<li><p>Markdown reader:</p>
<ul>
<li><p>Allow reference link labels starting with <code>@...</code> if <code>citations</code> extension disabled (#3209). Example: in</p>
<pre><code>\[link text\]\[@a\]</code></pre>
<code>link text</code> isn’t hyperlinked because <code>[@a]</code> is parsed as a citation. Previously this happened whether or not the <code>citations</code> extension was enabled. Now it happens only if the <code>citations</code> extension is enabled.</li>
<li><p>Allow alignments to be specified in Markdown grid tables. For example,</p>
<pre><code>+-------+---------------+--------------------+
| Right    | Left                 | Centered |
+=========:+:=================+:=============:+
| Bananas | $1.34         | built-in wrapper |
+-------+---------------+--------------------+</code></pre></li>
<li><p>Allow Small Caps elements to be created using bracketed spans (as they already can be using HTML-syntax spans) (#3191, Kolen Cheung).</p></li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Don’t treat <code>\vspace</code> and <code>\hspace</code> as block commands (#3256). Fixed an error which came up, for example, with <code>\vspace</code> inside a caption. (Captions expect inlines.)</li>
<li>Improved table handling. We can now parse all of the tables emitted by pandoc in our tests. The only thing we don’t get yet are alignments and column widths in more complex tables. See #2669.</li>
<li>Limited support for minipage.</li>
<li>Allow for <code>[]</code>s inside LaTeX optional args. Fixes cases like:</li>
<li>Handle BVerbatim from fancyvrb (#3203).</li>
<li>Handle hungarumlaut (#3201).</li>
<li>Allow beamer-style <code>&lt;...&gt;</code> options in raw LaTeX (also in Markdown) (#3184). This allows use of things like <code>\only&lt;2,3&gt;{my content}</code> in Markdown that is going to be converted to beamer.</li>
</ul></li>
<li><p>Use pre-wrap for code in dzslides template (Nicolas Porcel). Otherwise overly long code will appear on every slide.</p></li>
<li><p>Org reader (Albert Krewinkel):</p>
<ul>
<li>Respect column width settings (#3246). Table column properties can optionally specify a column’s width with which it is displayed in the buffer. Some exporters, notably the ODT exporter in org-mode v9.0, use these values to calculate relative column widths. The org reader now implements the same behavior. Note that the org-mode LaTeX and HTML exporters in Emacs don’t support this feature yet, which should be kept in mind by users who use the column widths parameters.</li>
<li><p>Allow HTML attribs on non-figure images (#3222). Images which are the only element in a paragraph can still be given HTML attributes, even if the image does not have a caption and is hence not a figure. The following will add set the <code>width</code> attribute of the image to <code>50%</code>:</p>
<pre><code>+ATTR\_HTML: :width 50%
=======================

\[\[file:image.jpg\]\]</code></pre></li>
<li>Support <code>ATTR_HTML</code> for special blocks (#3182). Special blocks (i.e. blocks with unrecognized names) can be prefixed with an <code>ATTR_HTML</code> block attribute. The attributes defined in that meta-directive are added to the <code>Div</code> which is used to represent the special block.</li>
<li>Support the <code>todo</code> export option. The <code>todo</code> export option allows to toggle the inclusion of TODO keywords in the output. Setting this to <code>nil</code> causes TODO keywords to be dropped from headlines. The default is to include the keywords.</li>
<li><p>Add support for todo-markers. Headlines can have optional todo-markers which can be controlled via the <code>#+TODO</code>, <code>#+SEQ_TODO</code>, or <code>#+TYP_TODO</code> meta directive. Multiple such directives can be given, each adding a new set of recognized todo-markers. If no custom todo-markers are defined, the default <code>TODO</code> and <code>DONE</code> markers are used. Todo-markers are conceptually separate from headline text and are hence excluded when autogenerating headline IDs. The markers are rendered as spans and labelled with two classes: One class is the markers name, the other signals the todo-state of the marker (either <code>todo</code> or <code>done</code>).</p></li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Use <code>\autocites*</code> when “suppress-author” citation used.</li>
<li>Ensure that simple tables have simple cells (#2666). If cells contain more than a single Plain or Para, then we need to set nonzero widths and put contents into minipages.</li>
<li>Remove invalid inlines in sections (#3218, Hubert Plociniczak).</li>
</ul></li>
<li><p>Markdown writer:</p>
<ul>
<li>Fix calculation of column widths for aligned multiline tables (#1911, Björn Peemöller). This also fixes excessive CPU and memory usage for tables when <code>--columns</code> is set in such a way that cells must be very tiny. Now cells are guaranteed to be big enough so that single words don’t need to line break, even if this pushes the line length above the column width.</li>
<li>Use bracketed form for native spans when <code>bracketed_spans</code> enabled (#3229).</li>
<li>Fixed inconsistent spacing issue (#3232). Previously a tight bullet sublist got rendered with a blank line after, while a tight ordered sublist did not. Now we don’t get the blank line in either case.</li>
<li>Fix escaping of spaces in super/subscript (#3225). Previously two backslashes were inserted, which gave a literal backslash.</li>
<li>Adjust widths in Markdown grid tables so that they match on round-trip.</li>
</ul></li>
<li><p>Docx writer:</p>
<ul>
<li>Give full detail when there are errors converting tex math.</li>
<li>Handle title text in images (Jesse Rosenthal). We already handled alt text. This just puts the image “title” into the docx “title” attr.</li>
<li>Fixed XML markup for empty cells (#3238). Previously the Compact style wasn’t being applied properly to empty cells.</li>
</ul></li>
<li><p>HTML writer:</p>
<ul>
<li>Updated <code>renderHtml</code> import from blaze-html.</li>
</ul></li>
<li><p>Text.Pandoc.Pretty:</p>
<ul>
<li>Fixed some bugs that caused blank lines in tables (#3251). The bugs caused spurious blank lines in grid tables when we had things like <code>blankline $$ blankline</code>.</li>
<li>Add exported function <code>minOffet</code> [API change] (Björn Peemöller).</li>
<li>Added error message for illegal call to <code>block</code> (Björn Peemöller).</li>
</ul></li>
<li><p>Text.Pandoc.Shared:</p>
<ul>
<li>Put <code>warn</code> in MonadIO.</li>
<li><code>fetchItem</code>: Better handling of protocol-relative URL (#2635). If URL starts with <code>//</code> and there is no “base URL” (as there would be if a URL were used on the command line), then default to http:.</li>
</ul></li>
<li><p>Export Text.Pandoc.getDefaultExtensions [API change] (#3178).</p></li>
<li><p>In –version, trap error in <code>getAppUserDataDirectory</code> (#3241). This fixes a crash with <code>pandoc --version</code> on unusual systems with no real user (e.g. SQL Server 2016).</p></li>
<li><p>Added weigh-pandoc for memory usage diagnostics (#3169).</p></li>
<li><p>Use correct mime types for woff and woff2 (#3228).</p></li>
<li><p>Remove make_travis_yml.hs (#3235, Kolen Cheung).</p></li>
<li><p>changelog: Moved an item that was misplaced in the 1.17.2 section to the 1.18 section where it belongs.</p></li>
<li><p>CONTRIBUTING.md: minor change in wording and punctuation (#3252, Kolen Cheung).</p></li>
<li><p>Further revisions to manual for <code>--version</code> changes (#3244).</p></li>
</ul>
<h1 id="pandoc-1.18-26-oct-2016">pandoc 1.18 (26 Oct 2016)</h1>
<ul>
<li><p>Added <code>--list-input-formats</code>, <code>--list-output-formats</code>, <code>--list-extensions</code>, <code>--list-highlight-languages</code>, and <code>--list-highlight-styles</code> (#3173). Removed list of highlighting languages from <code>--version</code> output. Removed list of input and output formats from default <code>--help</code> output.</p></li>
<li><p>Added <code>--reference-location=block|section|document</code> option (Jesse Rosenthal). This determines whether Markdown link references and footnotes are placed at the end of the document, the end of the section, or the end of the top-level block.</p></li>
<li><p>Added <code>--top-level-division=section|chapter|part</code> (Albert Krewinkel). This determines what a level-1 header corresponds to in LaTeX, ConTeXt, DocBook, and TEI output. The default is <code>section</code>. The <code>--chapters</code> option has been deprecated in favor of <code>--top-level-division=chapter</code>.</p></li>
<li><p>Added <code>LineBlock</code> constructor for <code>Block</code> (Albert Krewinkel). This is now used in parsing RST and Markdown line blocks, DocBook <code>linegroup</code>/<code>line</code> combinations, and Org-mode <code>VERSE</code> blocks. Previously <code>Para</code> blocks with hard linebreaks were used. <code>LineBlock</code>s are handled specially in the following ouput formats: AsciiDoc (as <code>[verse]</code> blocks), ConTeXt (<code>\startlines</code>/<code>\endlines</code>), HTML (<code>div</code> with a style), Markdown (line blocks if <code>line_blocks</code> is enabled), Org-mode (<code>VERSE</code> blocks), RST (line blocks). In other output formats, a paragraph with hard linebreaks is emitted.</p></li>
<li><p>Allow binary formats to be written to stdout (but not to tty) (#2677). Only works on posix, since we use the unix library to check whether output is to tty. On Windows, pandoc works as before and always requires an output file parameter for binary formats.</p></li>
<li><p>Changed JSON output format (Jesse Rosenthal). Previously we used generically generated JSON, but this was subject to change depending on the version of aeson pandoc was compiled with. To ensure stability, we switched to using manually written ToJSON and FromJSON instances, and encoding the API version. <strong>Note:</strong> pandoc filter libraries will need to be revised to handle the format change. Here is a summary of the essential changes:</p>
<ul>
<li>The toplevel JSON format is now <code>{&quot;pandoc-api-version&quot; : [MAJ, MIN, REV], &quot;meta&quot; : META, &quot;blocks&quot;: BLOCKS}</code> instead of <code>[{&quot;unMeta&quot;: META}, [BLOCKS]]</code>. Decoding fails if the major and minor version numbers don’t match.</li>
<li>Leaf nodes no longer have an empty array for their “c” value. Thus, for example, a <code>Space</code> is encoded as <code>{&quot;t&quot;:&quot;Space&quot;}</code> rather than <code>{&quot;t&quot;:&quot;Space&quot;,&quot;c&quot;:[]}</code> as before.</li>
</ul></li>
<li><p>Removed <code>tests/Tests/Arbitrary.hs</code> and added a <code>Text.Pandoc.Arbitrary</code> module to pandoc-types (Jesse Rosenthal). This makes it easier to use QuickCheck with pandoc types outside of pandoc itself.</p></li>
<li><p>Add <code>bracketed_spans</code> Markdown extension, enabled by default in pandoc <code>markdown</code>. This allows you to create a native span using this syntax: <code>[Here is my span]{#id .class key=&quot;val&quot;}</code>.</p></li>
<li><p>Added <code>angle_brackets_escapable</code> Markdown extension (#2846). This is needed because github flavored Markdown has a slightly different set of escapable symbols than original Markdown; it includes angle brackets.</p></li>
<li><p>Export <code>Text.Pandoc.Error</code> in <code>Text.Pandoc</code> [API change].</p></li>
<li><p>Print highlighting-kate version in <code>--version</code>.</p></li>
<li><p><code>Text.Pandoc.Options</code>:</p>
<ul>
<li><code>Extension</code> has new constructors <code>Ext_brackted_spans</code> and <code>Ext_angle_brackets_escapable</code> [API change].</li>
<li>Added <code>ReferenceLocation</code> type [API change] (Jesse Rosenthal).</li>
<li>Added <code>writerReferenceLocation</code> field to <code>WriterOptions</code> (Jesse Rosenthal).</li>
</ul></li>
<li><p><code>--filter</code>: we now check <code>$DATADIR/filters</code> for filters before looking in the path (#3127, Jesse Rosenthal, thanks to Jakob Voß for the idea). Filters placed in this directory need not be executable; if the extension is <code>.hs</code>, <code>.php</code>, <code>.pl</code>, <code>.js</code>, or <code>.rb</code>, pandoc will run the right interpreter.</p></li>
<li><p>For <code>--webtex</code>, replace deprecated Google Chart API by CodeCogs as default (Kolen Cheung).</p></li>
<li><p>Removed <code>raw_tex</code> extension from <code>markdown_mmd</code> defaults (Kolen Cheung).</p></li>
<li><p>Execute .js filters with node (Jakob Voß).</p></li>
<li><p>Textile reader:</p>
<ul>
<li>Support <code>bc..</code> extended code blocks (#3037). Also, remove trailing newline in code blocks (consistently with Markdown reader).</li>
<li>Improve table parsing. We now handle cell and row attributes, mostly by skipping them. However, alignments are now handled properly. Since in pandoc alignment is per-column, not per-cell, we try to devine column alignments from cell alignments. Table captions are also now parsed, and textile indicators for thead and tfoot no longer cause parse failure. (However, a row designated as tfoot will just be a regular row in pandoc.)</li>
<li>Improve definition list parsing. We now allow multiple terms (which we concatenate with linebreaks). An exponential parsing bug (#3020) is also fixed.</li>
<li>Disallow empty URL in explicit link (#3036).</li>
</ul></li>
<li><p>RST reader:</p>
<ul>
<li>Use Div instead of BlockQuote for admonitions (#3031). The Div has class <code>admonition</code> and (if relevant) one of the following: <code>attention</code>, <code>caution</code>, <code>danger</code>, <code>error</code>, <code>hint</code>, <code>important</code>, <code>note</code>, <code>tip</code>, <code>warning</code>. <strong>Note:</strong> This will change the rendering of some RST documents! The word (“Warning”, “Attention”, etc.) is no longer added; that must be done with CSS or a filter.</li>
<li>A Div is now used for <code>sidebar</code> as well.</li>
<li>Skip whitespace before note (Jesse Rosenthal, #3163). RST requires a space before a footnote marker. We discard those spaces so that footnotes will be adjacent to the text that comes before it. This is in line with what rst2latex does.</li>
<li>Allow empty lines when parsing line blocks (Albert Krewinkel).</li>
</ul></li>
<li><p>Markdown reader:</p>
<ul>
<li>Allow empty lines when parsing line blocks (Albert Krewinkel).</li>
<li>Allow attributes on autolinks (#3183, Daniele D’Orazio).</li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>More robust parsing of unknown environments (#3026). We no longer fail on things like <code>^</code> inside options for tikz.</li>
<li>Be more forgiving of non-standard characters, e.g. <code>^</code> outside of math. Some custom environments give these a meaning, so we should try not to fall over when we encounter them.</li>
<li>Drop duplicate <code>*</code> in bibtexKeyChars (Albert Krewinkel)</li>
</ul></li>
<li><p>MediaWiki reader:</p>
<ul>
<li>Fix for unquoted attribute values in mediawiki tables (#3053). Previously an unquoted attribute value in a table row could cause parsing problems.</li>
<li>Improved treatment of verbatim constructions (#3055). Previously these yielded strings of alternating Code and Space elements; we now incorporate the spaces into the Code. Emphasis etc. is still possible inside these.</li>
<li>Properly interpret XML tags in pre environments (#3042). They are meant to be interpreted as literal text.</li>
</ul></li>
<li><p>EPUB reader: don’t add root path to data: URIs (#3150). Thanks to <span class="citation" data-cites="lep">@lep</span> for the bug report and patch.</p></li>
<li><p>Org reader (Albert Krewinkel):</p>
<ul>
<li>Preserve indentation of verse lines (#3064). Leading spaces in verse lines are converted to non-breaking spaces, so indentation is preserved.</li>
<li>Ensure image sources are proper links. Image sources as those in plain images, image links, or figures, must be proper URIs or relative file paths to be recognized as images. This restriction is now enforced for all image sources. This also fixes the reader’s usage of uncleaned image sources, leading to <code>file:</code> prefixes not being deleted from figure images. Thanks to <span class="citation" data-cites="bsag">@bsag</span> for noticing this bug.</li>
<li>Trim verse lines properly (Albert Krewinkel).</li>
<li>Extract meta parsing code to module. Parsing of meta-data is well separable from other block parsing tasks. Moving into new module to get small files and clearly arranged code.</li>
<li>Read markup only for special meta keys. Most meta-keys should be read as normal string values, only a few are interpreted as marked-up text.</li>
<li>Allow multiple, comma-separated authors. Multiple authors can be specified in the <code>#+AUTHOR</code> meta line if they are given as a comma-separated list.</li>
<li>Give precedence to later meta lines. The last meta-line of any given type is the significant line. Previously the value of the first line was kept, even if more lines of the same type were encounterd.</li>
<li>Read LaTeX_header as header-includes. LaTeX-specific header commands can be defined in <code>#+LaTeX_header</code> lines. They are parsed as format-specific inlines to ensure that they will only show up in LaTeX output.</li>
<li>Set documentclass meta from LaTeX_class.</li>
<li>Set classoption meta from LaTeX_class_options.</li>
<li>Read HTML_head as header-includes. HTML-specific head content can be defined in <code>#+HTML_head</code> lines. They are parsed as format-specific inlines to ensure that they will only show up in HTML output.</li>
<li>Respect <code>author</code> export option. The <code>author</code> option controls whether the author should be included in the final markup. Setting <code>#+OPTIONS: author:nil</code> will drop the author from the final meta-data output.</li>
<li>Respect <code>email</code> export option. The <code>email</code> option controls whether the email meta-field should be included in the final markup. Setting <code>#+OPTIONS: email:nil</code> will drop the email field from the final meta-data output.</li>
<li>Respect <code>creator</code> export option. The <code>creator</code> option controls whether the creator meta-field should be included in the final markup. Setting <code>#+OPTIONS: creator:nil</code> will drop the creator field from the final meta-data output. Org-mode recognizes the special value <code>comment</code> for this field, causing the creator to be included in a comment. This is difficult to translate to Pandoc internals and is hence interpreted the same as other truish values (i.e. the meta field is kept if it’s present).</li>
<li>Respect unnumbered header property (#3095). Sections the <code>unnumbered</code> property should, as the name implies, be excluded from the automatic numbering of section provided by some output formats. The Pandoc convention for this is to add an “unnumbered” class to the header. The reader treats properties as key-value pairs per default, so a special case is added to translate the above property to a class instead.</li>
<li>Allow figure with empty caption (Albert Krewinkel, #3161). A <code>#+CAPTION</code> attribute before an image is enough to turn an image into a figure. This wasn’t the case because the <code>parseFromString</code> function, which processes the caption value, would fail on empty values. Adding a newline character to the caption value fixes this.</li>
</ul></li>
<li><p>Docx reader:</p>
<ul>
<li>Use XML convenience functions (Jesse Rosenthal). The functions <code>isElem</code> and <code>elemName</code> (defined in Docx/Util.hs) make the code a lot cleaner than the original XML.Light functions, but they had been used inconsistently. This puts them in wherever applicable.</li>
<li>Handle anchor spans with content in headers. Previously, we would only be able to figure out internal links to a header in a docx if the anchor span was empty. We change that to read the inlines out of the first anchor span in a header.</li>
<li>Let headers use exisiting id. Previously we always generated an id for headers (since they wouldn’t bring one from Docx). Now we let it use an existing one if possible. This should allow us to recurs through anchor spans.</li>
<li>Use all anchor spans for header ids. Previously we only used the first anchor span to affect header ids. This allows us to use all the anchor spans in a header, whether they’re nested or not (#3088).</li>
<li>Test for nested anchor spans in header. This ensures that anchor spans in header with content (or with other anchor spans inside) will resolve to links to a header id properly.</li>
</ul></li>
<li><p>ODT reader (Hubert Plociniczak)</p>
<ul>
<li>Include list’s starting value. Previously the starting value of the lists’ items has been hardcoded to 1. In reality ODT’s list style definition can provide a new starting value in one of its attributes.</li>
<li>Infer caption from the text following the image. Frame can contain other frames with the text boxes.</li>
<li>Add <code>fig:</code> to title for Image with a caption (as expected by pandoc’s writers).</li>
<li>Basic support for images in ODT documents.</li>
<li>Don’t duplicate text for anchors (#3143). When creating an anchor element we were adding its representation as well as the original content, leading to text duplication.</li>
</ul></li>
<li><p>DocBook writer:</p>
<ul>
<li>Include an anchor element when a div or span has an id (#3102). Note that DocBook does not have a class attribute, but at least this provides an anchor for internal links.</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Don’t use * for unnumbered paragraph, subparagraph. The starred variants don’t exist. This helps with part of #3058…it gets rid of the spurious <code>*</code>s. But we still have numbers on the 4th and 5th level headers.</li>
<li>Properly escape backticks in verbatim (#3121, Jesse Rosenthal). Otherwise they can cause unintended ligatures like <code>?`</code>.</li>
<li>Handle NARRAOW NO-BREAK SPACE into LaTeX (Vaclav Zeman) as <code>\,</code>.</li>
<li>Don’t include <code>[htbp]</code> placement for figures (#3103, Václav Haisman). This allows figure placement defaults to be changed by the user in the template.</li>
</ul></li>
<li><p>TEI writer: remove heuristic to detect book template (Albert Krewinkel). TEI doesn’t have <code>&lt;book&gt;</code> elements but only generic <code>&lt;divN&gt;</code> division elements. Checking the template for a trailing <code>&lt;/book&gt;</code> is nonsensical.</p></li>
<li><p>MediaWiki writer: transform filename with underscores in images (#3052). <code>foo bar.jpg</code> becomes <code>foo_bar.jpg</code>. This was already done for internal links, but it also needs to happen for images.</p></li>
<li><p>ICML writer: replace partial function (!!) in table handling (#3175, Mauro Bieg).</p></li>
<li><p>Man writer: allow section numbers that are not a single digit (#3089).</p></li>
<li><p>AsciiDoc writer: avoid unnecessary use of “unconstrained” emphasis (#3068). In AsciiDoc, you must use a special form of emphasis (double <code>__</code>) for intraword emphasis. Pandoc was previously using this more than necessary.</p></li>
<li><p>EPUB writer: use stringify instead of plain writer for metadata (#3066). This means that underscores won’t be used for emphasis, or CAPS for bold. The metadata fields will just have unadorned text.</p></li>
<li><p>Docx Writer:</p>
<ul>
<li>Implement user-defined styles (Jesse Rosenthal). Divs and Spans with a <code>custom-style</code> key in the attributes will apply the corresponding key to the contained blocks or inlines.</li>
<li>Add ReaderT env to the docx writer (Jesse Rosenthal).</li>
<li>Clean up and streamline RTL behavior (Jesse Rosenthal, #3140). You can set <code>dir: rtl</code> in YAML metadata, or use <code>-M dir=rtl</code> on the command line. For finer-grained control, you can set the <code>dir</code> attribute in Div or Span elements.</li>
</ul></li>
<li><p>Org writer (Albert Krewinkel):</p>
<ul>
<li>Remove blank line after figure caption. Org-mode only treats an image as a figure if it is directly preceded by a caption.</li>
<li>Ensure blank line after figure. An Org-mode figure should be surrounded by blank lines. The figure would be recognized regardless, but images in the following line would unintentionally be treated as figures as well.</li>
<li>Ensure link targets are paths or URLs. Org-mode treats links as document internal searches unless the link target looks like a URL or file path, either relative or absolute. This change ensures that this is always the case.</li>
<li>Translate language identifiers. Pandoc and Org-mode use different programming language identifiers. An additional translation between those identifiers is added to avoid unexpected behavior. This fixes a problem where language specific source code would sometimes be output as example code.</li>
<li>Drop space before footnote markers (Albert Krewinkel, #3162). The writer no longer adds an extra space before footnote markers.</li>
</ul></li>
<li><p>Markdown writer:</p>
<ul>
<li>Don’t emit HTML for tables unless <code>raw_html</code> extension is set (#3154). Emit <code>[TABLE]</code> if no suitable table formats are enabled and raw HTML is disabled.</li>
<li>Check for the <code>raw_html</code> extension before emiting a raw HTML block.</li>
<li>Abstract out note/ref function (Jesse Rosenthal).</li>
<li>Add ReaderT monad for environment variables (Jesse Rosenthal).</li>
</ul></li>
<li><p>HTML, EPUB, slidy, revealjs templates: Use <code>&lt;p&gt;</code> instead of <code>&lt;h1&gt;</code> for subtitle, author, date (#3119). Note that, as a result of this change, authors may need to update CSS.</p></li>
<li><p>revealjs template: Added <code>notes-server</code> option (jgm/pandoc-templates#212, Yoan Blanc).</p></li>
<li><p>Beamer template:</p>
<ul>
<li>Restore whitespace between paragraphs. This was a regression in the last release (jgm/pandoc-templates#207).</li>
<li>Added <code>themeoptions</code> variable (Carsten Gips).</li>
<li>Added <code>beamerarticle</code> variable. This causes the <code>beamerarticle</code> package to be loaded in beamer, to produce an article from beamer slides. (Carsten Gips)</li>
<li>Added support for <code>fontfamilies</code> structured variable (Artem Klevtsov).</li>
<li>Added hypersetup options (Jake Zimmerman).</li>
</ul></li>
<li><p>LaTeX template:</p>
<ul>
<li>Added dummy definition for <code>\institute</code>. This isn’t a standard command, and we want to avoid a crash when <code>institute</code> is used with the default template.</li>
<li>Define default figure placement (Václav Haisman), since pandoc no longer includes <code>[htbp]</code> for figures. Users with custom templates will want to add this. See #3103.</li>
<li>Use footnote package to fix notes in tables (jgm/pandoc-templates#208, Václav Haisman).</li>
</ul></li>
<li><p>Moved template compiling/rendering code to a separate library. <code>doctemplates</code>. This allows the pandoc templating system to be used independently.</p></li>
<li><p>Text.Pandoc.Error: Fix out of index error in <code>handleError</code> (Matthew Pickering). The fix is to not try to show the exact line when it would cause an out-of-bounds error as a result of included files.</p></li>
<li><p>Text.Pandoc.Shared: Add <code>linesToBlock</code> function (Albert Krewinkel).</p></li>
<li><p>Text.Pandoc.Parsing.emailAddress: tighten up parsing of email addresses. Technically <code>**@user</code> is a valid email address, but if we allow things like this, we get bad results in markdown flavors that autolink raw email addresses (see #2940). So we exclude a few valid email addresses in order to avoid these more common bad cases.</p></li>
<li><p>Text.Pandoc.PDF: Don’t crash with nonexistent image (#3100). Instead, emit the alt text, emphasized. This accords with what the ODT writer currently does. The user will still get a warning about a nonexistent image.</p></li>
<li><p>Fix example in API documentation (#3176, Thomas Weißschuh).</p></li>
<li><p>Tell where to get tarball in INSTALL (#3062).</p></li>
<li><p>Rename README to MANUAL.txt and add GitHub-friendly README.md (Albert Krewinkel, Kolen Cheung).</p></li>
<li><p>Replace COPYING with Markdown version COPYING.md from GNU (Kolen Cheung).</p></li>
<li><p>MANUAL.txt:</p>
<ul>
<li>Put note on structured vars in separate paragraph (#2148, Albert Krewinkel). Make it clearer that structured author variables require a custom template</li>
<li>Note that <code>--katex</code> works best with <code>html5</code> (#3077).</li>
<li>Fix the LaTeX and EPUB links in manual (Morton Fox).</li>
<li>Document <code>biblio-title</code> variable.</li>
</ul></li>
<li><p>Improve spacing of footnotes in <code>--help</code> output (Waldir Pimenta).</p></li>
<li><p>Update KaTeX to v0.6.0 (Kolen Cheung).</p></li>
<li><p>Allow latest dependencies.</p></li>
<li><p>Use texmath 0.8.6.6 (#3040).</p></li>
<li><p>Allow http-client 0.4.30, which is the version in stackage lts. Previously we required 0.5. Remove CPP conditionals for earlier versions.</p></li>
<li><p>Remove support for GHC &lt; 7.8 (Jesse Rosenthal).</p>
<ul>
<li>Remove Compat.Monoid.</li>
<li>Remove an inline monad compatibility macro.</li>
<li>Remove Text.Pandoc.Compat.Except.</li>
<li>Remove directory compat.</li>
<li>Change constraint on mtl.</li>
<li>Remove unnecessary CPP condition in UTF8.</li>
<li>Bump base lower bound to 4.7.</li>
<li>Remove 7.6 build from .travis.yaml.</li>
<li>Bump supported ghc version in CONTRIBUTING.md.</li>
<li>Add note about GHC version support to INSTALL.</li>
<li>Remove GHC 7.6 from list of tested versions (Albert Krewinkel).</li>
<li>Remove TagSoup compat.</li>
<li>Add EOL note to time compat module. Because time 1.4 is a boot library for GHC 7.8, we will support the compatibility module as long as we support 7.8. But we should be clear about when we will no longer need it.</li>
<li>Remove blaze-html CPP conditional.</li>
<li>Remove unnecessary CPP in custom Prelude.</li>
</ul></li>
</ul>
<h1 id="pandoc-1.17.2-17-jul-2016">pandoc 1.17.2 (17 Jul 2016)</h1>
<ul>
<li><p>Added Zim Wiki writer, template and tests. <code>zimwiki</code> is now a valid output format. (Alex Ivkin)</p></li>
<li>Changed email-obfuscation default to no obfuscation (#2988).
<ul>
<li><code>writerEmailObfuscation</code> in <code>defaultWriterOptions</code> is now <code>NoObfuscation</code>.</li>
<li>the default for the command-line <code>--email-obfuscation</code> option is now <code>none</code>.</li>
</ul></li>
<li><p>Docbook writer: Declare xlink namespace in Docbook5 output (Ivo Clarysse).</p></li>
<li><p>Org writer:</p>
<ul>
<li>Support arbitrary raw inlines (Albert Krewinkel). Org mode allows arbitrary raw inlines (“export snippets” in Emacs parlance) to be included as <code>@@format:raw foreign format text@@</code>.</li>
<li>Improve Div handling (Albert Krewinkel). Div blocks handling is changed to make the output look more like idiomatic org mode:
<ul>
<li>Div-wrapped content is output as-is if the div’s attribute is the null attribute.</li>
<li>Div containers with an id but neither classes nor key-value pairs are unwrapped and the id is added as an anchor.</li>
<li>Divs with classes associated with greater block elements are wrapped in a <code>#+BEGIN</code>…<code>#+END</code> block.</li>
<li>The old behavior for Divs with more complex attributes is kept.</li>
</ul></li>
</ul></li>
<li><p>HTML writer: Better support for raw LaTeX environments (#2758). Previously we just passed all raw TeX through when MathJax was used for HTML math. This passed through too much. With this patch, only raw LaTeX environments that MathJax can handle get passed through. This patch also causes raw LaTeX environments to be treated as math, when possible, with MathML and WebTeX output.</p></li>
<li><p>Markdown writer: use raw HTML for simple, pipe tables with linebreaks (#2993). Markdown line breaks involve a newline, and simple and pipe tables can’t contain one.</p></li>
<li><p>Make –webtex work with the Markdown writer (#1177). This is a convenient option for people using websites whose Markdown flavors don’t provide for math.</p></li>
<li><p>Docx writer:</p>
<ul>
<li>Set paragraph to FirstPara after display math (Jesse Rosenthal). We treat display math like block quotes, and apply FirstParagraph style to paragraphs that follow them. These can be styled as the user wishes. (But, when the user is using indentation, this allows for paragraphs to continue after display math without indentation.)</li>
<li>Use actual creation time as doc prop (Jesse Rosenthal). Previously, we had used the user-supplied date, if available, for Word’s document creation metadata. This could lead to weird results, as in cases where the user post-dates a document (so the modification might be prior to the creation). Here we use the actual computer time to set the document creation.</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Don’t URI-escape image source (#2825). Usually this is a local file, and replacing spaces with <code>%20</code> ruins things.</li>
<li>Allow ‘standout’ as a beamer frame option (#3007). <code>## Slide title {.standout}</code>.</li>
</ul></li>
<li><p>RST reader: Fixed links with no explicit link text. The link <code>`&lt;foo&gt;`_</code> should have <code>foo</code> as both its link text and its URL. See RST spec at <a href="http://docutils.sourceforge.net/docs/ref/rst/restructuredtext.html#embedded-uris-and-aliases" class="uri">http://docutils.sourceforge.net/docs/ref/rst/restructuredtext.html#embedded-uris-and-aliases</a> Closes Debian #828167 – reported by Christian Heller.</p></li>
<li><p>Textile reader:</p>
<ul>
<li>Fixed attributes (#2984). Attributes can’t be followed by a space. So, <code>_(class)emph_</code> but <code>_(noclass) emph_</code>.</li>
<li>Fixed exponential parsing bug (#3020).</li>
<li>Fix overly aggressive interpretation as images (#2998). Spaces are not allowed in the image URL in textile.</li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Fix <code>\cite</code> so it is a NormalCitation not AuthorInText.</li>
<li>Strip off double quotes around image source if present (#2825). Avoids interpreting these as part of the literal filename.</li>
</ul></li>
<li><p>Org reader:</p>
<ul>
<li>Add semicolon to list of special chars (Albert Krewinkel) Semicolons are used as special characters in citations syntax. This ensures the correct parsing of Pandoc-style citations: <code>[prefix; @key; suffix]</code>. Previously, parsing would have failed unless there was a space or other special character as the last <prefix> character.</li>
<li>Add support for “Berkeley-style” cites (Albert Krewinkel, #1978). A specification for an official Org-mode citation syntax was drafted by Richard Lawrence and enhanced with the help of others on the orgmode mailing list. Basic support for this citation style is added to the reader.</li>
<li>Support arbitrary raw inlines (Albert Krewinkel). Org mode allows arbitrary raw inlines (“export snippets” in Emacs parlance) to be included as <code>@@format:raw foreign format text@@</code>.</li>
<li>Remove partial functions (Albert Krewinkel, #2991). Partial functions like <code>head</code> lead to avoidable errors and should be avoided. They are replaced with total functions.</li>
<li>Support figure labels (Albert Krewinkel, #2496, #2999). Figure labels given as <code>#+LABEL: thelabel</code> are used as the ID of the respective image. This allows e.g. the LaTeX to add proper <code>\label</code> markup.</li>
<li>Improve tag and properties type safety (Albert Krewinkel). Specific newtype definitions are used to replace stringly typing of tags and properties. Type safety is increased while readability is improved.</li>
<li>Parse as headlines, convert to blocks (Albert Krewinkel). Emacs org-mode is based on outline-mode, which treats documents as trees with headlines are nodes. The reader is refactored to parse into a similar tree structure. This simplifies transformations acting on document (sub-)trees.</li>
<li>Refactor comment tree handling (Albert Krewinkel). Comment trees were handled after parsing, as pattern matching on lists is easier than matching on sequences. The new method of reading documents as trees allows for more elegant subtree removal.</li>
<li>Support archived trees export options (Albert Krewinkel). Handling of archived trees can be modified using the <code>arch</code> option. Archived trees are either dropped, exported completely, or collapsed to include just the header when the <code>arch</code> option is nil, non-nil, or <code>headline</code>, respectively.</li>
<li>Put export setting parser into module (Albert Krewinkel). Export option parsing is distinct enough from general block parsing to justify putting it into a separate module.</li>
<li>Support headline levels export setting (Albert Krewinkel). The depths of headlines can be modified using the <code>H</code> option. Deeper headlines will be converted to lists.</li>
<li>Replace ugly code with view pattern (Albert Krewinkel). Some less-than-smart code required a pragma switching of overlapping pattern warnings in order to compile seamlessly. Using view patterns makes the code easier to read and also doesn’t require overlapping pattern checks to be disabled.</li>
<li>Fix parsing of verbatim inlines (Albert Krewinkel, #3016). Org rules for allowed characters before or after markup chars were not checked for verbatim text. This resultet in wrong parsing outcomes of if the verbatim text contained e.g. space enclosed markup characters as part of the text (<code>=is_substr = True=</code>). Forcing the parser to update the positions of allowed/forbidden markup border characters fixes this.</li>
</ul></li>
<li><p>LaTeX template: fix for obscure hyperref/xelatex issue. Here’s a minimal case:</p>
<pre><code>\documentclass[]{article}
\usepackage{hyperref}
\begin{document}
\section{\%á}
\end{document}</code></pre>
<p>Without this change, this fails on the second invocation of xelatex. This affects inputs this like <code># %á</code> with pdf output via xelatex.</p></li>
<li><p>trypandoc: call results ‘html’ instead of ‘result’. This is for better compatibility with babelmark2.</p></li>
<li><p>Document MultiMarkdown as input/output format (Albert Krewinkel, #2973). MultiMarkdown was only mentioned as a supported Markdown dialect but not as a possible input or output format. A brief mention is added everywhere the other supported markdown dialects are mentioned.</p></li>
<li><p>Document Org mode as a format containing raw HTML (Albert Krewinkel) Raw HTML is kept when the output format is Emacs Org mode.</p></li>
<li><p>Implement <code>RawInline</code> and <code>RawBlock</code> in sample lua custom writer (#2985).</p></li>
<li><p>Text.Pandoc.Shared:</p>
<ul>
<li>Introduce blocksToInlines function (Jesse Rosenthal). This is a lossy function for converting <code>[Block] -&gt; [Inline]</code>. Its main use, at the moment, is for docx comments, which can contain arbitrary blocks (except for footnotes), but which will be converted to spans. This is, at the moment, pretty useless for everything but the basic <code>Para</code> and <code>Plain</code> comments. It can be improved, but the docx reader should probably emit a warning if the comment contains more than this.</li>
<li>Add BlockQuote to blocksToInlines (Jesse Rosenthal).</li>
<li>Add further formats for <code>normalizeDate</code> (Jesse Rosenthal). We want to avoid illegal dates – in particular years with greater than four digits. We attempt to parse series of digits first as <code>%Y%m%d</code>, then <code>%Y%m</code>, and finally <code>%Y</code>.</li>
<li><code>normalizeDate</code> should reject illegal years (Jesse Rosenthal). We only allow years between 1601 and 9999, inclusive. The ISO 8601 actually says that years are supposed to start with 1583, but MS Word only allows 1601-9999. This should stop corrupted word files if the date is out of that range, or is parsed incorrectly.</li>
<li>Improve year sanity check in normalizeDate (Jesse Rosenthal). Previously we parsed a list of dates, took the first one, and then tested its year range. That meant that if the first one failed, we returned nothing, regardless of what the others did. Now we test for sanity before running <code>msum</code> over the list of Maybe values. Anything failing the test will be Nothing, so will not be a candidate.</li>
</ul></li>
<li><p>Docx reader:</p>
<ul>
<li>Add simple comment functionality. (Jesse Rosenthal). This adds simple track-changes comment parsing to the docx reader. It is turned on with <code>--track-changes=all</code>. All comments are converted to inlines, which can list some information. In the future a warning will be added for comments with formatting that seems like it will be excessively denatured. Note that comments can extend across blocks. For that reason there are two spans: <code>comment-start</code> and <code>comment-end</code>. <code>comment-start</code> will contain the comment. <code>comment-end</code> will always be empty. The two will be associated by a numeric id.</li>
<li>Enable warnings in top-level reader (Jesse Rosenthal). Previously we had only allowed for warnings in the parser. Now we allow for them in the <code>Docx.hs</code> as well. The warnings are simply concatenated.</li>
<li>Add warning for advanced comment formatting. (Jesse Rosenthal). We can’t guarantee we’ll convert every comment correctly, though we’ll do the best we can. This warns if the comment includes something other than Para or Plain.</li>
<li>Add tests for warnings. (Jesse Rosenthal).</li>
<li>Add tests for comments (Jesse Rosenthal). We test for comments, using all track-changes options. Note that we should only output comments if <code>--track-changes=all</code>. We also test for emitting warnings if there is complicated formatting.</li>
</ul></li>
<li><p>README: update to include track-changes comments. (Jesse Rosenthal)</p></li>
<li><p>Improved Windows installer - don’t ignore properties set on command-line. See #2708. Needs testing to see if this resolves the issue. Thanks to <span class="citation" data-cites="nkalvi">@nkalvi</span>.</p></li>
<li><p>Process markdown extensions on command line in L-&gt;R order (#2995). Previously they were processed, very unintuitively, in R-&gt;L order, so that <code>markdown-tex_math_dollars+tex_math_dollars</code> had <code>tex_math_dollars</code> disabled.</p></li>
<li><p>Added <code>secnumdepth</code> variable to LaTeX template (#2920).</p></li>
<li><p>Include table of contents in README.html in Windows package.</p></li>
<li><p>Writers: treat SoftBreak as space for stripping (Jesse Rosenthal) In Writers.Shared, we strip leading and trailing spaces for display math. Since SoftBreak’s are treated as spaces, we should strip those too.</p></li>
<li><p>beamer, latex templates: pass biblatexoptions directly in package load. This allows runtime optinos to be used. Fixes jgm/pandoc-citeproc#201</p></li>
<li><p>CPP workaround for deprecation of <code>parseUrl</code> in http-client.</p></li>
<li><p>Removed some redundant class constraints.</p></li>
<li><p>make_oxs_package.sh - use OSX env variable.</p></li>
<li><p>Added <code>winpkg</code> target to Makefile. This downloads the windows package from appveyor and signs it using the key.</p></li>
<li><p>Document Org mode as a format containing raw TeX (Albert Krewinkel). Raw TeX is kept verbatim when the output format is Emacs Org mode.</p></li>
<li><p>Support math with haddock-library &gt;= 1.4.</p></li>
<li><p>Removed <code>-rtsopts</code> from library stanza. It has no effect, and Hackage wouldn’t accept the package.</p></li>
<li><p>Update library dependency versions.</p></li>
</ul>
<h1 id="pandoc-1.17.1-4-jun-2016">pandoc 1.17.1 (4 Jun 2016)</h1>
<ul>
<li><p>New output format: <code>docbook5</code> (Ivo Clarysse).</p></li>
<li><p><code>Text.Pandoc.Options</code>: Add <code>writerDocBook5</code> to <code>WriterOptions</code> (API change).</p></li>
<li><p>Org writer:</p>
<ul>
<li>Add :PROPERTIES: drawer support (Albert Krewinkel, #1962). This allows header attributes to be added to org documents in the form of <code>:PROPERTIES:</code> drawers. All available attributes are stored as key/value pairs. This reflects the way the org reader handles <code>:PROPERTIES:</code> blocks.</li>
<li>Add drawer capability (Carlos Sosa). For the implementation of the Drawer element in the Org Writer, we make use of a generic Block container with attributes. The presence of a <code>drawer</code> class defines that the <code>Div</code> constructor is a drawer. The first class defines the drawer name to use. The key-value list in the attributes defines the keys to add inside the Drawer. Lastly, the list of Block elements contains miscellaneous blocks elements to add inside of the Drawer.</li>
<li>Use <code>CUSTOM_ID</code> in properties (Albert Krewinkel). The <code>ID</code> property is reserved for internal use by Org-mode and should not be used. The <code>CUSTOM_ID</code> property is to be used instead, it is converted to the <code>ID</code> property for certain export format.</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Ignore <code>--incremental</code> unless output format is beamer (#2843).</li>
<li>Fix polyglossia to babel env mapping (Mauro Bieg, #2728). Allow for optional argument in square brackets.</li>
<li>Recognize <code>la-x-classic</code> as Classical Latin (Andrew Dunning). This allows one to access the hyphenation patterns in CTAN’s hyph-utf8.</li>
<li>Add missing languages from hyph-utf8 (Andrew Dunning).</li>
<li>Improve use of <code>\strut</code> with <code>\minipage</code> inside tables (Jose Luis Duran). This improves spacing in multiline tables.</li>
<li>Use <code>{}</code> around options containing special chars (#2892).</li>
<li>Avoid lazy <code>foldl</code>.</li>
<li>Don’t escape underscore in labels (#2921). Previously they were escaped as <code>ux5f</code>.</li>
<li>brazilian -&gt; brazil for polyglossia (#2953).</li>
</ul></li>
<li><p>HTML writer: Ensure mathjax link is added when math appears in footnote (#2881). Previously if a document only had math in a footnote, the MathJax link would not be added.</p></li>
<li><p>EPUB writer: set <code>navpage</code> variable on nav page. This allows templates to treat it differently.</p></li>
<li><p>DocBook writer:</p>
<ul>
<li>Use docbook5 if <code>writerDocbook5</code> is set (Ivo Clarysse).</li>
<li>Properly handle <code>ulink</code>/<code>link</code> (Ivo Clarysse).</li>
</ul></li>
<li><p>EPUB reader:</p>
<ul>
<li>Unescape URIs in spine (#2924).</li>
<li>EPUB reader: normalise link id (Mauro Bieg).</li>
</ul></li>
<li><p>Docx Reader:</p>
<ul>
<li>Parse <code>moveTo</code> and <code>moveFrom</code> (Jesse Rosenthal). <code>moveTo</code> and <code>moveFrom</code> are track-changes tags that are used when a block of text is moved in the document. We now recognize these tags and treat them the same as <code>insert</code> and <code>delete</code>, respectively. So, <code>--track-changes=accept</code> will show the moved version, while <code>--track-changes=reject</code> will show the original version.</li>
<li>Tests for track-changes moving (Jesse Rosenthal).</li>
</ul></li>
<li><p>ODT, EPUB, Docx readers: throw <code>PandocError</code> on unzip failure (Jesse Rosenthal) Previously, <code>readDocx</code>, <code>readEPUB</code>, and <code>readOdt</code> would error out if zip-archive failed. We change the archive extraction step from <code>toArchive</code> to <code>toArchiveOrFail</code>, which returns an Either value.</p></li>
<li><p>Markdown, HTML readers: be more forgiving about unescaped <code>&amp;</code> in HTML (#2410). We are now more forgiving about parsing invalid HTML with unescaped <code>&amp;</code> as raw HTML. (Previously any unescaped <code>&amp;</code> would cause pandoc not to recognize the string as raw HTML.)</p></li>
<li><p>Markdown reader:</p>
<ul>
<li>Fix pandoc title blocks with lines ending in 2 spaces (#2799).</li>
<li>Added <code>-s</code> to markdown-reader-more test.</li>
</ul></li>
<li><p>HTML reader: fixed bug in <code>pClose</code>. This caused exponential parsing behavior in documnets with unclosed tags in <code>dl</code>, <code>dd</code>, <code>dt</code>.</p></li>
<li><p>MediaWiki reader: Allow spaces before <code>!</code> in MediaWiki table header (roblabla).</p></li>
<li><p>RST reader: Support <code>:class:</code> option for code block in RST reader (Sidharth Kapur).</p></li>
<li><p>Org reader (all Albert Krewinkel, except where noted otherwise):</p>
<ul>
<li>Stop padding short table rows. Emacs Org-mode doesn’t add any padding to table rows. The first row (header or first body row) is used to determine the column count, no other magic is performed.</li>
<li>Refactor rows-to-table conversion. This refactors the codes conversing a list table lines to an org table ADT. The old code was simplified and is now slightly less ugly.</li>
<li>Fix handling of empty table cells, rows (Albert Krewinkel, #2616). This fixes Org mode parsing of some corner cases regarding empty cells and rows. Empty cells weren’t parsed correctly, e.g. <code>|||</code> should be two empty cells, but would be parsed as a single cell containing a pipe character. Empty rows where parsed as alignment rows and dropped from the output.</li>
<li>Fix spacing after LaTeX-style symbols. The org-reader was droping space after unescaped LaTeX-style symbol commands: <code>\ForAll \Auml</code> resulted in <code>∀Ä</code> but should give <code>∀ Ä</code> instead. This seems to be because the LaTeX-reader treats the command-terminating space as part of the command. Dropping the trailing space from the symbol-command fixes this issue.</li>
<li>Print empty table rows. Empty table rows should not be dropped from the output, so row-height is always set to be at least 1.</li>
<li>Move parser state into separate module. The org reader code has become large and confusing. Extracting smaller parts into submodules should help to clean things up.</li>
<li>Add support for sub/superscript export options. Org-mode allows to specify export settings via <code>#+OPTIONS</code> lines. Disabling simple sub- and superscripts is one of these export options, this options is now supported.</li>
<li>Support special strings export option Parsing of special strings (like <code>...</code> as ellipsis or <code>--</code> as en dash) can be toggled using the <code>-</code> option.</li>
<li>Support emphasized text export option. Parsing of emphasized text can be toggled using the <code>*</code> option. This influences parsing of text marked as emphasized, strong, strikeout, and underline. Parsing of inline math, code, and verbatim text is not affected by this option.</li>
<li>Support smart quotes export option. Reading of smart quotes can be toggled using the <code>'</code> option.</li>
<li>Parse but ignore export options. All known export options are parsed but ignored.</li>
<li>Refactor block attribute handling. A parser state attribute was used to keep track of block attributes defined in meta-lines. Global state is undesirable, so block attributes are no longer saved as part of the parser state. Old functions and the respective part of the parser state are removed.</li>
<li>Use custom <code>anyLine</code>. Additional state changes need to be made after a newline is parsed, otherwise markup may not be recognized correctly. This fixes a bug where markup after certain block-types would not be recognized.</li>
<li>Add support for <code>ATTR_HTML</code> attributes (#1906). Arbitrary key-value pairs can be added to some block types using a <code>#+ATTR_HTML</code> line before the block. Emacs Org-mode only includes these when exporting to HTML, but since we cannot make this distinction here, the attributes are always added. The functionality is now supported for figures.</li>
<li>Add <code>:PROPERTIES:</code> drawer support (#1877). Headers can have optional <code>:PROPERTIES:</code> drawers associated with them. These drawers contain key/value pairs like the header’s <code>id</code>. The reader adds all listed pairs to the header’s attributes; <code>id</code> and <code>class</code> attributes are handled specially to match the way <code>Attr</code> are defined. This also changes behavior of how drawers of unknown type are handled. Instead of including all unknown drawers, those are not read/exported, thereby matching current Emacs behavior.</li>
<li>Use <code>CUSTOM_ID</code> in properties. See above on Org writer changes.</li>
<li>Respect drawer export setting. The <code>d</code> export option can be used to control which drawers are exported and which are discarded. Basic support for this option is added here.</li>
<li>Ignore leading space in org code blocks (Emanuel Evans, #2862). Also fix up tab handling for leading whitespace in code blocks.</li>
<li>Support new syntax for export blocks. Org-mode version 9 uses a new syntax for export blocks. Instead of <code>#+BEGIN_&lt;FORMAT&gt;</code>, where <code>&lt;FORMAT&gt;</code> is the format of the block’s content, the new format uses <code>#+BEGIN_export &lt;FORMAT&gt;</code> instead. Both types are supported.</li>
<li>Refactor <code>BEGIN...END</code> block parsing.</li>
<li>Fix handling of whitespace in blocks, allowing content to be indented less then the block header.</li>
<li>Support org-ref style citations. The <em>org-ref</em> package is an org-mode extension commonly used to manage citations in org documents. Basic support for the <code>cite:citeKey</code> and <code>[[cite:citeKey][prefix text::suffix text]]</code> syntax is added.</li>
<li>Split code into separate modules, making for cleaner code and better decoupling.</li>
</ul></li>
<li><p>Added <code>docbook5</code> template.</p></li>
<li><p><code>--mathjax</code> improvements:</p>
<ul>
<li>Use new CommonHTML output for MathJax (updated default MathJax URL, #2858).</li>
<li>Change default mathjax setup to use <code>TeX-AMS_CHTML</code> configuration. This is designed for cases where the input is always TeX and maximal conformity with TeX is desired. It seems to be smaller and load faster than what we used before. See #2858.</li>
<li>Load the full MathJax config to maximize loading speed (KolenCheung).</li>
</ul></li>
<li><p>Bumped upper version bounds to allow use of latest packages and compilation with ghc 8.</p></li>
<li><p>Require texmath 0.8.6.2. Closes several texmath-related bugs (#2775, #2310, #2310, #2824). This fixes behavior of roots, e.g. <code>\sqrt[3]{x}</code>, and issues with sub/superscript positioning and matrix column alignment in docx.</p></li>
<li><p>README:</p>
<ul>
<li>Clarified documentation of <code>implicit_header_references</code> (#2904).</li>
<li>Improved documentation of <code>--columns</code> option.</li>
</ul></li>
<li><p>Added appveyor setup, with artefacts (Jan Schulz).</p></li>
<li><p>stack.yaml versions: Use proper flags used for texmath, pandoc-citeproc.</p></li>
<li><p>LaTeX template: support for custom font families (vladipus). Needed for correct polyglossia operation with Cyrillic fonts and perhaps can find some other usages. Example usage in YAML metadata:</p>
<pre><code>  fontfamilies:
  - name: \cyrillicfont
    font: Liberation Serif
  - name: \cyrillicfonttt
    options: Scale=MatchLowercase
    font: Liberation</code></pre></li>
<li><p>Create unsigned msi as build artifact in appveyor build.</p></li>
<li><p>On travis, test with ghc 8.0.1; drop testing for ghc 7.4.1.</p></li>
</ul>
<h1 id="pandoc-1.17.0.3-24-mar-2016">pandoc 1.17.0.3 (24 Mar 2016)</h1>
<ul>
<li>LaTeX writer: Fixed position of label in figures (#2813). Previously the label wasn’t in the right place, and <code>\ref</code> wouldn’t work properly.</li>
<li>Added .tei test files to pandoc.cabal so they’ll be included in tarball (#2811).</li>
<li>Updated copyright dates.</li>
</ul>
<h1 id="pandoc-1.17.0.2-23-mar-2016">pandoc 1.17.0.2 (23 Mar 2016)</h1>
<ul>
<li>Fixed serious regression in <code>htmlInBalanced</code>, which caused newlines to be omitted in some raw HTML blocks in Markdown (#2804).</li>
</ul>
<h1 id="pandoc-1.17.0.1-21-mar-2016">pandoc 1.17.0.1 (21 Mar 2016)</h1>
<ul>
<li>File scope is no longer used when there are no input files (i.e., when input comes from stdin). Previously file scope was triggered when the <code>json</code> reader was specified and input came from <code>stdin</code>, and this caused no output to be produced. (Fix due to Jesse Rosenthal; thanks to Fedor Sheremetyev for calling the bug to our attention.)</li>
<li>Improved documentation of templates (#2797).</li>
</ul>
<h1 id="pandoc-1.17-20-mar-2016">pandoc 1.17 (20 Mar 2016)</h1>
<ul>
<li><p>Added <code>--file-scope</code> option (Jesse Rosenthal). By default pandoc operates on multiple files by first concatenating them (around extra line breaks) and then processing the joined file. So it only parses a multi-file document at the document scope. This has the benefit that footnotes and links can be in different files, but for some purposes it is useful to parse the individual files first and then combine their outputs (e.g. when the files use footnotes or links with the same labels). The <code>--file-scope</code> option causes pandoc to parse the files first, and then combine the parsed output, instead of combining before parsing. <code>--file-scope</code> is selected automatically for binary input files (which cannot be concatenated) and for pandoc json.</p></li>
<li><p>Add TEI Writer (Chris Forster) and <code>tei</code> output format.</p></li>
<li><p>Added a general <code>ByteStringReader</code> with warnings, used by the docx reader (API change, Jesse Rosenthal).</p></li>
<li><p>Add <code>readDocxWithWarnings</code> (API change, Jesse Rosenthal).</p></li>
<li><p>Changed type of <code>Shared.uniqueIdent</code> argument from <code>[String]</code> to <code>Set String</code>. This avoids performance problems in documents with many identically named headers (API change, #2671).</p></li>
<li><p>Removed <code>tex_math_single_backslash</code> from <code>markdown_github</code> options (#2707).</p></li>
<li><p>Make language extensions as well as full language names trigger syntax highlighting. For example, <code>py</code> will now work as well as <code>python</code> (jgm/highlighting-kate#83).</p></li>
<li><p>Added <code>institute</code> variable to latex, beamer templates (Fraser Tweedale, Josef Svenningsson).</p></li>
<li><p>Docx reader (Jesse Rosenthal):</p>
<ul>
<li>Handle alternate content. Some word functions (especially graphics) give various choices for content so there can be backwards compatibility.</li>
<li>Don’t turn numbered headers into lists.</li>
<li>Docx Reader: Add state to the parser, for warnings</li>
<li>Update feature checklist in source code.</li>
<li>Get rid of <code>Modifiable</code> typeclass.</li>
<li>Add tests for adjacent hyperlinks.</li>
<li>Add a “Link” modifier to <code>Reducible</code>. We want to make sure that links have their spaces removed, and are appropriately smushed together (#2689).</li>
</ul></li>
<li><p>HTML reader:</p>
<ul>
<li>Fixed behavior of base tag (#2777). If the base path does not end with slash, the last component will be replaced. E.g. base = <code>http://example.com/foo</code> combines with <code>bar.html</code> to give <code>http://example.com/bar.html</code>. If the href begins with a slash, the whole path of the base is replaced. E.g. base = <code>http://example.com/foo/</code> combines with <code>/bar.html</code> to give <code>http://example.com/bar.html</code>.</li>
<li>Rewrote <code>htmlInBalanced</code>. This version avoids an exponential performance problem with <code>&lt;script&gt;</code> tags, and it should be faster in general (#2730).</li>
<li>Properly handle an empty cell in a simple table (#2718).</li>
<li>Handle multiple <code>&lt;meta&gt;</code> tags with same name. Put them in a list in the metadata so they are all preserved, rather than (as before) throwing out all but one..</li>
</ul></li>
<li><p>Markdown reader:</p>
<ul>
<li>Improved pipe table parsing (#2765).</li>
<li>Allow <code>+</code> separators in pipe table cells. We already allowed them in the header, but not in the body rows, for some reason. This gives compatibility with org-mode tables.</li>
<li>Don’t cross line boundary parsing pipe table row. Previously an Emph element could be parsed across the newline at the end of the pipe table row.</li>
<li>Use <code>htmlInBalanced</code> for <code>rawVerbatimBlock</code>, for better performance (#2730).</li>
<li>Fixed bug with smart quotes around tex math.</li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Handle interior <code>$</code> characters in math (#2743). For example, <code>$$\hbox{$i$}$$</code>.</li>
<li><code>inlineCommand</code> now gobbles an empty <code>{}</code> after any command (#2687). This gives better results when people write e.g. <code>\TeX{}</code> in Markdown.</li>
<li>Properly handle LaTeX “math” environment as inline math (#2171).</li>
</ul></li>
<li><p>Textile reader: Support <code>&gt;</code>, <code>&lt;</code>, <code>=</code>, <code>&lt;&gt;</code> text alignment attributes. Closes #2674.</p></li>
<li><p>Org reader (Albert Krewinkel):</p>
<ul>
<li>Prefix even empty figure names with “fig:” (#2643). The convention used by pandoc for figures is to mark them by prefixing the name with <code>fig:</code>. The org reader failed to do this if a figure had no name.</li>
<li>Refactor link-target processing (#2684).</li>
</ul></li>
<li><p>ConTeXt writer: Fix whitespace at line beginning in line blocks (#2744). Thanks to <span class="citation" data-cites="c-foster">@c-foster</span>.</p></li>
<li><p>HTML writer: Don’t include alignment attribute for default table columns. Previously these were given “left” alignment. Better to leave off alignment attributes altogether (#2694).</p></li>
<li><p>Markdown writer: Use hyphens for YAML metadata block bottom line, for better compatibility with other Markdown flavors (Henrik Tramberend).</p></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Use image identifier to create a label and hypertarget for figures (Mauro Bieg).</li>
<li>Avoid double toprule in headerless table with caption (#2742).</li>
<li>Clean up options parser (Jesse Rosenthal).</li>
<li>Treat <code>memoir</code> template with <code>article</code> option as article, instead of treating all <code>memoir</code> templates as books.</li>
<li>Allow more flexible table alignment (Henrik Tramberend, #2665). New default is not to include <code>[c]</code> option (which is the default anyway if no positioning is specified). Now LaTeX emplates can control the overall table alignment in a document by setting the longtable length variables <code>LTleft</code> and <code>LTright</code>. For example, <code>\setlength\LTleft\parindent\setlength\LTright\fill</code> will create left-aligned tables that respect paragraph indentation.</li>
</ul></li>
<li><p>Docx writer: Handle image alt text (#2754, Mauro Bieg).</p></li>
<li><p>Org writer - pass through RawInline with format “org”.</p></li>
<li><p>DokuWiki writer: use <code>$$</code> for display math.</p></li>
<li><p>Custom writer: Pass attributes parameter to CaptionedImage (#2697).</p></li>
<li><p>Make protocol-relative URIs work again (#2737).</p></li>
<li><p>make_osx_package.sh: Use env variable for developer id certs.</p></li>
<li><p>Raise <code>tagsoup</code> lower bound to 0.13.7 to fix entity-related problems (#2734).</p></li>
<li><p>Allow <code>zip-archive</code> 0.3.</p></li>
<li><p>Allow <code>aeson</code> 0.11.</p></li>
</ul>
<h1 id="pandoc-1.16.0.2">pandoc (1.16.0.2)</h1>
<ul>
<li><p>Depend on deepseq rather than deepseq-generics (fpco/stackage#1096).</p></li>
<li><p>Fixed regression in latex smart quote parsing (#2645). In cases where a match was not found for a quote, everything from the open quote to the end of the paragraph was being dropped.</p></li>
</ul>
<h1 id="pandoc-1.16.0.2-12-jan-2016">pandoc 1.16.0.2 (12 Jan 2016)</h1>
<ul>
<li><p>Depend on deepseq rather than deepseq-generics (fpco/stackage#1096).</p></li>
<li><p>Fixed regression in latex smart quote parsing (#2645). In cases where a match was not found for a quote, everything from the open quote to the end of the paragraph was being dropped.</p></li>
</ul>
<h1 id="pandoc-1.16.0.1-10-jan-2016">pandoc 1.16.0.1 (10 Jan 2016)</h1>
<ul>
<li><p>Fixed regression with <code>--latex-engine</code> (#2618). In 1.16 <code>--latex-engine</code> raises an error if a full path is given.</p></li>
<li><p>Org reader: Fix function dropping subtrees tagged <code>:noexport</code> (Albert Krewinkel, #2628):</p></li>
<li><p>Markdown reader: renormalize table column widths if they exceed 100% (#2626).</p></li>
<li><p>Textile reader: don’t allow block HTML tags in inline contexts. The reader previously did allow this, following redcloth, which happily parses</p>
<pre><code>Html blocks can be &lt;div&gt;inlined&lt;/div&gt; as well.</code></pre>
<p>as</p>
<pre><code>&lt;p&gt;Html blocks can be &lt;div&gt;inlined&lt;/div&gt; as well.&lt;/p&gt;</code></pre>
<p>This is invalid HTML. The above sample now produces;</p>
<pre><code>&lt;p&gt;Html blocks can be&lt;/p&gt;
&lt;div&gt;
&lt;p&gt;inlined&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;as well.&lt;/p&gt;</code></pre></li>
<li><p>Improved default template lookup for custom lua scripts (#2625). Previously, if you tried to do <code>pandoc -s -t /path/to/lua/script.lua</code>, pandoc would look for the template in <code>~/.pandoc/templates/default./path/to/lua/script.lua</code>. With this change it will look in the more reasonable <code>~/.pandoc/templates/default.script.lua</code>. This makes it possible to store default templates for custom writers.</p></li>
<li><p>RST, Markdown writers: Fixed rendering of grid tables with blank rows (#2615).</p></li>
<li><p>LaTeX writer: restore old treatment of Span (#2624). A Span is now rendered with surrounding <code>{}</code>, as it was before 1.16.</p></li>
<li><p>Entity handling fixes: improved handling of entities like <code>&amp;lang;</code> that require a trailing semicolon. Allow uppercase <code>x</code> in numerical hexidecimal character references, working around a tagsoup bug.</p></li>
<li><p><code>stack.yaml</code> - use lts-4.0, but with older aeson to avoid excessive memory use on compile. With aeson 0.10 we were getting an out of memory error on a 2GB Ubuntu 64-bit VM.</p></li>
<li><p>Improved deb package creation script. Made <code>DPKGVER</code> work. Renamed <code>COMMIT</code> to <code>TREE</code>. You should now be able to do <code>TREE=1.16.0.1 DPKGVER=2 make deb</code>.</p></li>
</ul>
<h1 id="pandoc-1.16-02-jan-2016">pandoc 1.16 (02 Jan 2016)</h1>
<ul>
<li><p>Added <code>Attr</code> field to <code>Link</code> and <code>Image</code> (Mauro Bieg, #261, API change).</p>
<ul>
<li>Added syntax for link and image attributes to pandoc’s Markdown.</li>
<li>Updated readers and writers to use link and image attributes when appropriate.</li>
<li>Support image attributes in Docx, Textile, RST readers.</li>
</ul></li>
<li><p>Renamed link attribute extensions. The old <code>link_attributes</code> is now <code>mmd_link_attributes</code>, and <code>link_attributes</code> now enables the new pandoc-style link and image attributes (API change). Note: this change could break some existing workflows.</p></li>
<li><p>Implemented <code>SoftBreak</code> and new <code>--wrap</code> option (#1701, API change). Added threefold wrapping option.</p>
<ul>
<li>Command line option: deprecated <code>--no-wrap</code>, added <code>--wrap=[auto|none|preserve]</code></li>
<li>Added <code>WrapOption</code>, exported from <code>Text.Pandoc.Options</code></li>
<li>Changed type of <code>writerWrapText</code> in <code>WriterOptions</code> from <code>Bool</code> to <code>WrapOption</code>.</li>
<li>Modified <code>Text.Pandoc.Shared</code> functions to allow <code>SoftBreak</code>.</li>
<li>Supported <code>SoftBreak</code> in readers and writers.</li>
</ul></li>
<li><p>Text.Pandoc.Options: Added <code>writerDpi</code> to <code>WriterOptions</code> (API change, Mauro Bieg).</p></li>
<li><p>Added <code>--dpi</code> command-line option (Mauro Bieg).</p></li>
<li><p>Rationalized behavior of <code>--no-tex-ligatures</code> and <code>--smart</code> (#2541). This change makes <code>--no-tex-ligatures</code> affect the LaTeX reader as well as the LaTeX and ConTeXt writers. If it is used, the LaTeX reader will parse characters <code>`</code>, <code>'</code>, and <code>-</code> literally, rather than parsing ligatures for quotation marks and dashes. And the LaTeX writer will print unicode quotation mark and dash characters literally, rather than converting them to the standard ASCII ligatures. Note that <code>--smart</code> has no effect on the LaTeX reader. <code>--smart</code> is still the default for all input formats when LaTeX or ConTeXt is the output format, <em>unless</em> <code>--no-tex-ligatures</code> is used.</p>
<p>Some examples to illustrate the logic:</p>
<pre><code>% echo &quot;&#39;hi&#39;&quot; | pandoc -t latex
`hi&#39;
% echo &quot;&#39;hi&#39;&quot; | pandoc -t latex --no-tex-ligatures
&#39;hi&#39;
% echo &quot;&#39;hi&#39;&quot; | pandoc -t latex --no-tex-ligatures --smart
‘hi’
% echo &quot;&#39;hi&#39;&quot; | pandoc -f latex --no-tex-ligatures
&lt;p&gt;&#39;hi&#39;&lt;/p&gt;
% echo &quot;&#39;hi&#39;&quot; | pandoc -f latex
&lt;p&gt;’hi’&lt;/p&gt;</code></pre></li>
<li><p>Removed deprecated options <code>--offline</code> and <code>--html5</code>.</p></li>
<li><p>Fixed language code for Czech (<code>cs</code> not <code>cz</code>) (#2597).</p></li>
<li><p>Implemented <code>east_asian_line_breaks</code> extension (#2586). In <code>Text.Pandoc.Options</code>, added <code>Ext_east_asian_line_breaks</code> constructor to <code>Extension</code> (API change). This extension is like <code>ignore_line_breaks</code>, but smarter – it only ignores line breaks between two East Asian wide characters. This makes it better suited for writing with a mix of East Asian and non-East Asian scripts.</p></li>
<li><p>Added support for PDF creation via <code>wkhtmltopdf</code>. To use this: <code>pandoc -t html5 -o result.pdf</code> (and add <code>--mathjax</code> if you have math.) Margins can be set using the variables <code>margin-top</code>, <code>margin-bottom</code>, <code>margin-left</code>, <code>margin-right</code>. Other styling can be done through CSS.</p></li>
<li><p>Fixed cite key parsing regression (jgm/pandoc-citeproc#201). We were capturing final colons as in <code>[@foo: bar]</code>; the citation id was being parsed as <code>@foo:</code>.</p></li>
<li><p>ICML writer:</p>
<ul>
<li>Fixed image syntax for local files (#2589).</li>
<li>Changed type of <code>writeICML</code> (Mauro Bieg). API change: It is now <code>WriterOptions -&gt; Pandoc -&gt; IO String</code>. Also handle new image attributes.</li>
<li>Intersperse line breaks instead of appending them to every <code>ParagraphStyleRange</code> (Mauro Bieg, #2501).</li>
<li>Add <code>Cite</code> style to citations (Mauro Bieg).</li>
<li>Added figure handling (#2590, Mauro Bieg).</li>
<li>Better handling of math. Instead of just printing the raw tex, we now try to fake it with unicode characters.</li>
</ul></li>
<li><p>HTML writer: Include <code>example</code> class for example lists (#2524).</p></li>
<li><p>ODT/OpenDocument writer: improved image attributes (Mauro Bieg).</p>
<ul>
<li>Support for percentage widths/heights</li>
<li>Use <code>Attr</code> instead of title to get dimensions from ODT walker to <code>writeOpenDocument</code>.</li>
</ul></li>
<li><p>AsciiDoc writer:</p>
<ul>
<li>Support anchors in spans and divs with id elements (jgm/pandoc-citeproc#143).</li>
<li>Fixed code blocks (#1861).</li>
</ul></li>
<li><p>Haddock writer: omit formatting inside links, which isn’t supported by Haddock (#2515).</p></li>
<li><p>MediaWiki writer: Fixed spacing issues in table cells.</p>
<ul>
<li>Start cell on new line unless it’s a single Para or Plain (#2606).</li>
<li>For single Para or Plain, insert a space after the <code>|</code> to avoid problems when the text begins with a character like <code>-</code> (#2604).</li>
</ul></li>
<li><p>Beamer writer: mark frame as fragile when it contains verbatim (#1613).</p></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Add support for GAP highlighting using listings (Raniere Silva).</li>
<li>Consider <code>header-includes</code> content as well as templates when determining whether to use csquotes (Andreas Lööw).</li>
<li>Create defaults for geometry using <code>margin-left</code> etc. If <code>geometry</code> has no value, but <code>margin-left</code>, <code>margin-right</code>, <code>margin-top</code>, and/or <code>-margin-bottom</code> are given, a default value for <code>geometry</code> is created from these. Note that these variables already affect PDF production via HTML5 with <code>wkhtmltopdf</code>.</li>
</ul></li>
<li><p>ConTeXt writer: set default layout based on <code>margin-left</code>, etc. This sets up <code>\setuplayout</code> based on the variables <code>margin-left</code>, <code>margin-right</code>, <code>margin-bottom</code>, and <code>margin-top</code>, if no layout is given.</p></li>
<li><p>Docx writer: better handling of PDF images. Previously we tried to get the image size from the image even if an explicit size was specified. Since we still can’t get image size for PDFs, this made it impossible to use PDF images in docx. Now we don’t try to get the image size when a size is already explicitly specified.</p></li>
<li><p>Markdown writer: use raw HTML for link/image attributes when the <code>link_attributes</code> extension is unset and <code>raw_html</code> is set (#2554).</p></li>
<li><p>MediaWiki reader: interpret markup inside <code>&lt;tt&gt;</code>, <code>&lt;code&gt;</code> (#2607).</p></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Improved smart quote parsing (#2555). This fixes redering of unmatched quotes.</li>
<li>Use curly quotes for unmatched ` (#2555).</li>
<li>Allow blank space between braced arguments of commands (#2592).</li>
</ul></li>
<li><p>Markdown reader:</p>
<ul>
<li>Improved pipe table relative widths. Previously pipe table columns got relative widths (based on the header underscore lines) when the source of one of the rows was greater in width than the column width. This gave bad results in some cases where much of the width of the row was due to nonprinting material (e.g. link URLs). Now pandoc only looks at printable width (the width of a plain string version of the source), which should give better results. Thanks to John Muccigrosso for bringing up the issue.</li>
<li>Fixed parsing bug with macros. Previously macro definitions in indented code blocks were being parsed as macro definitions, not code.</li>
</ul></li>
<li><p>Textile reader: skip over attribute in image source (#2515). We don’t have a place yet for styles or sizes on images, but we can skip the attributes rather than incorrectly taking them to be part of the filename.</p></li>
<li><p>Docx reader: Handle dummy list items (Jesse Rosenthal). These come up when people create a list item and then delete the bullet. It doesn’t refer to any real list item, and we used to ignore it.</p></li>
<li><p>CommonMark reader/writer rewritten to use latest <code>cmark</code>.</p></li>
<li><p>Fixed Emoji character definitions (#2523). There were many bugs in the definitions.</p></li>
<li><p><code>Text.Pandoc.CSS</code>:</p>
<ul>
<li>Added <code>pickStylesToKVs</code> function to extract multiple properties at once (API change, Mauro Bieg).</li>
<li>Parse CSS that doesn’t contain the optional semicolon (Mauro Bieg).</li>
</ul></li>
<li><p><code>trypandoc</code>: sort drop-down lists.</p></li>
<li><p>Beamer template:</p>
<ul>
<li>Made <code>\euro</code> conditional on presence of character. for xelatex and lualatex, as it is for pdflatex (Andrew Dunning).</li>
<li>Moved <code>header-includes</code> before setting of title (Thomas Hodgson), to match the LaTeX template (jgm/pandoc-templates#168).</li>
<li>Added <code>section-titles</code> variable (defaults to true) to enable/suppress section title pages in beamer slide shows (Thomas Hodgson).</li>
<li>Moved beamer themes after fonts, so that themes can change fonts. (Previously the fonts set were being clobbered by lmodern.sty.) (Thomas Hodgson).</li>
</ul></li>
<li>Beamer/LaTeX template changes (Thomas Hodgson):
<ul>
<li>Added <code>thanks</code> variable</li>
<li>Use <code>parskip.sty</code> when <code>indent</code> isn’t set (fall back to using <code>setlength</code> as before if <code>parskip.sty</code> isn’t available).</li>
<li>Use <code>biblio-style</code> with biblatex.</li>
<li>Added <code>biblatexoptions</code> variable.</li>
</ul></li>
<li><p>LaTeX template changes:</p>
<ul>
<li>Added <code>paper</code> after <code>$papersize$</code> variable in latex template. Thus you can say <code>papersize: a4</code> and the latex will contain <code>a4paper</code>. This change may break some existing workflows; if you currently specify <code>a4paper</code>, you’ll get <code>a4paperpaper</code> which is meaningless. However, the change seems worth it, as it will make the <code>papersize</code> variable work uniformly across ConTeXt, LaTeX, and html-&gt;pdf via wkhtmltopdf.</li>
<li>Only pass options to color package if <code>colorlinks</code> is set (Andrew Dunning).</li>
<li>Make definition of <code>\euro</code> conditional in xelatex/lualatex, as it is already for pdflatex (Andrew Dunning).</li>
<li>Removed setting of <code>subject</code> in PDF metadata. This used to be set to the subtitle, but really the subtitle need not give the subject. Also, <code>subtitle</code> can contain formatting, so we’d need, at least, a plain text version for this.</li>
<li>Moved <code>header-includes</code> before setting of <code>\title</code>, <code>\author</code>, etc. This allows these macros to be redefined.</li>
<li>Use <code>\subtitle</code> command for <code>subtitle</code>, instead of tacking it on to the title as before. We give a no-op fallback definition if it is not defined. This change should produce much better results in classes that support <code>\subtitle</code>. With the default article class, which does not define <code>\subtitle</code>, subtitles will no longer be printed unless the user defines <code>\subtitle</code> and redefines <code>\maketitle</code>.</li>
<li>Moved redefinitions of <code>\paragraph</code> and <code>\subparagraph</code> to before header-includes.</li>
</ul></li>
<li><p>Context template:</p>
<ul>
<li>Use <code>simplefonts</code> for font loading (Paolo Rodríguez). This is needed for things to work on ConTeXt stable from TeXLive 2015.</li>
<li>Revert use of <code>\setuphead</code> in title block (Andrew Dunning, Rik Kabel).</li>
</ul></li>
<li><p>Update LaTeX/ConTeXt link colour usage (Andrew Dunning).</p></li>
<li><p>Fixed man template so disabling hyphenation actually works. The command needs to come after .TH.</p></li>
<li><p>Added ‘navigation’ variable to beamer template (#2543). Valid values are <code>empty</code> (the default), <code>horizontal</code>, <code>vertical</code>, and <code>frame</code>. Note that this changes the default behavior from <code>horizontal</code> to <code>empty</code>. Closes #2543.</p></li>
<li><p>Added <code>toc</code> to HTML slide format templates (Andrew Dunning), so that <code>--toc</code> creates a contents slide.</p></li>
<li><p>Added <code>stack.full.yaml</code> to build <code>pandoc-citeproc</code> as well.</p></li>
<li><p>Allow pipe tables with no body rows (#2556). Previously this raised a runtime error.</p></li>
<li><p>Shared: Improved <code>fetchItem</code> so that <code>C:/Blah/Blah.jpg</code> isn’t treated as URL. The Haskell URI parsing routines will accept “C:” as a scheme, so we rule that out manually. This helps with <code>--self-contained</code> and absolute Windows paths.</p></li>
<li><p>Define a <code>meta-json</code> variable for all writers (#2019). This contains a JSON version of all the metadata, in the format selected for the writer. So, for example, to get just the YAML metadata, you can run pandoc with the following custom template: <code>$meta-json$</code>. The intent is to make it easier for static site generators and other tools to get at the metadata.</p></li>
<li><p>Document limitations of –self-contained (#2553).</p></li>
<li><p>Improved Citations section of README (#2551). Added information about <code>link-citations</code> and a link to the pandoc-citeproc man page.</p></li>
<li><p><code>ImageSize</code>: use <code>safeRead</code> instead of <code>readMaybe</code>, which isn’t in base &lt; 4.6.</p></li>
<li><p>Allow .adoc file extension for AsciiDoc (Andrew Dunning).</p></li>
<li><p>Improved implicit pandoc-citeproc inclusion. The filter pandoc-citeproc is automatically used when <code>--bibliography</code> is specified on the command line, unless <code>--natbib</code> or <code>--biblatex</code> is used. However, previously this only worked if <code>--bibliography</code> was spelled out in full, and not if <code>--biblio</code> was used.</p></li>
<li><p>reveal.js: Interpret pauses correctly for all headers (#2530). Previously, when using headers below the slide level, pauses are left uninterpreted into pauses. In my opinion, unexpected behavior but intentional looking at the code.</p></li>
<li><p>Remove redundant <code>center</code> variable for reveal.js (Andrew Dunning).</p></li>
<li><p>Parsing: Add <code>extractIdClass</code>, modified type of <code>KeyTable</code> (Mauro Bieg, API change).</p></li>
<li><p>ImageSize: Added functions for converting between image dimensions (Mauro Bieg).</p></li>
<li><p>Use lts-3.18 in stack.yaml. This avoids Windows build issues with the HTTP library.</p></li>
<li><p>Bump version bounds for dependencies.</p></li>
</ul>
<h1 id="pandoc-1.15.2.1-16-nov-2015">pandoc 1.15.2.1 (16 Nov 2015)</h1>
<ul>
<li><p>Added two missing test files, and <code>stack.yaml</code>, to <code>extra-source-files</code> so they’re included in the source tarball.</p></li>
<li><p>reveal.js template: Fixed parallaxBackground options. <code>parallaxBackgroundHorizontal</code> and <code>parallaxBackgroundVertical</code> need integer values, not strings. (Vaughn Iverson)</p></li>
</ul>
<h1 id="pandoc-1.15.2-15-nov-2015">pandoc 1.15.2 (15 Nov 2015)</h1>
<ul>
<li><p><code>pandoc my.md -t context -o my.pdf</code> will now create a PDF using ConTeXt rather than LaTeX (#2463).</p></li>
<li><p>Fixed omitted <code>url(...)</code> in CSS data-uri with <code>--self-contained</code> (#2489).</p></li>
<li><p>Added <code>emoji</code> Markdown extension, enabled by default in <code>markdown_github</code> (#2523). Added <code>Ext_emoji</code> to <code>Extension</code> in <code>Text.Pandoc.Options</code> (API change).</p></li>
<li><p><code>Text.Pandoc.Readers.HTML.parseTags</code>: Fixed over-eager raw HTML inline parsing (#2469). Tightened up the inline HTML parser so it disallows TagWarnings.</p></li>
<li><p>Derive <code>Generic</code> instances for the types in <code>Text.Pandoc.Options</code>.</p></li>
<li><p>Org reader:</p>
<ul>
<li>Fix paragraph/list interaction (Albert Krewinkel, #2464). Paragraphs can be followed by lists, even if there is no blank line between the two blocks. However, this should only be true if the paragraph is not within a list, were the preceding block should be parsed as a plain instead of paragraph (to allow for compact lists). Thanks to <span class="citation" data-cites="rgaiacs">@rgaiacs</span> for bringing this up.</li>
<li>Allow toggling header args (Albert Krewinkel, #2269). Org-mode allows to skip the argument of a code block header argument if it’s toggling a value. Argument-less headers are now recognized, avoiding weird parsing errors.</li>
<li>Fix markup parsing in headers (Albert Krewinkel, #2504). Markup as the very first item in a header wasn’t recognized. This was caused by an incorrect parser state: positions at which inline markup can start need to be marked explicitly by changing the parser state. This wasn’t done for headers. The proper function to update the state is now called at the beginning of the header parser, fixing this issue.</li>
<li>Fix emphasis rules for smart parsing (Albert Krewinkel, #2513). Smart quotes, ellipses, and dashes should behave like normal quotes, single dashes, and dots with respect to text markup parsing.</li>
<li>Require whitespace around definition list markers (#2518). This rule was not checked before, resulting in bugs with footnotes and some link types.</li>
</ul></li>
<li><p>Markdown reader:</p>
<ul>
<li>Pipe tables with long lines now get relative cell widths (#2471). If a pipe table contains a line longer than the column width (as set by <code>--columns</code> or 80 by default), relative widths are computed based on the widths of the separator lines relative to the column width. This should solve persistent problems with long pipe tables in LaTeX/PDF output, and give more flexibility for determining relative column widths in other formats, too. For narrower pipe tables, column widths of 0 are used, telling pandoc not to specify widths explicitly in output formats that permit this.</li>
<li>Improved parser for <code>mmd_title_block</code>. We now allow blank metadata fields. These were explicitly disallowed before.</li>
<li>Citation keys can now contain <code>://</code>, so URLs and DOIs can be used as citation keys (jgm/pandoc-citeproc#166).</li>
</ul></li>
<li><p>Beamer template: fix incompatibility of section slides with natbib. Natbib (and presumably biblatex) bibliography commands create their own section. Since these are in frame environments, we have an incompatibility with the <code>\AtBeginSection</code> macro which creates a special frame when a new section occurs. (We can’t have a frame inside another frame.) This change disables <code>\AtBeginSection</code> inside bibliography slides. Thinks to Yihui Xie for bringing the problem to my attention. This supersedes #145. See discussion there.</p></li>
<li><p>Textile reader: don’t do smart punctuation unless explicitly asked (#2480). Note that although smart punctuation is part of the textile spec, it’s not always wanted when converting from textile to, say, Markdown. So it seems better to make this an option.</p></li>
<li><p>LaTeX reader: Handle <code>comment</code> environment (Arata Mizuki). The <code>comment</code> environment is handled in a similar way to the <code>verbatim</code> environment, except that its content is discarded.</p></li>
<li><p>Docx reader: Follow relationships correctly in foot/endnotes (#2258, Jesse Rosenthal). This fixes a problem with links in notes.</p></li>
<li><p>LaTeX and ConTeXt writers: support <code>lang</code> attribute on divs and spans (mb21). For LaTeX, also collect <code>lang</code> and <code>dir</code> attributes on spans and divs to set the <code>lang</code>, <code>otherlangs</code> and <code>dir</code> variables if they aren’t set already. See #895.</p></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Use proper command for <code>\textarabic</code> (mb21).</li>
<li>Added <code>de-CH-1901</code>, fixed <code>el-polyton</code> in <code>toPloyglossia</code> (Nick Bart).</li>
<li>Use <code>\hypertarget</code> and <code>\hyperlink</code> for links. This works correctly to link to Div or Span elements. We now don’t bother defining <code>\label</code> for Div or Span elements. Closes jgm/pandoc-citeproc#174.</li>
<li>Avoid footnotes in list of figures (#1506).</li>
<li>Properly handle footnotes in captions (#1506).</li>
<li>Add <code>\protect</code> to <code>\hyperlink</code> (#2490). Thanks to Hadrien Mary.</li>
<li>Set <code>colorlinks</code> if <code>linkcolor</code>, <code>urlcolor</code>, <code>citecolor</code>, or <code>toccolor</code> is set (#2508).</li>
</ul></li>
<li><p>Textile writer: support start number in ordered lists (#2465).</p></li>
<li><p>OpenDocument writer: Allow customization of opendocument automatic styles. Automatic styles can now be inserted in the template, which now provides the enclosing <code>&lt;office:automatic-styles&gt;</code> tags (#2520).</p></li>
<li><p>Docx writer: insert space between footnote reference and note (#2527). This matches Word’s default behavior.</p></li>
<li><p>EPUB writer: don’t download linked media when <code>data-external</code> attribute set (#2473). By default pandoc downloads all linked media and includes it in the EPUB container. This can be disabled by setting <code>data-external</code> on the tags linking to media that should not be downloaded. Example:</p>
<pre><code>&lt;audio controls=&quot;1&quot;&gt;
 &lt;source src=&quot;http://www.sixbarsjail.it/tmp/bach_toccata.mp3&quot;
 type=&quot;audio/mpeg&quot;&gt;&lt;/source&gt;
&lt;/audio&gt;</code></pre></li>
<li><p>HTML writer: use width on whole table if col widths sum to &lt; 100%. Otherwise some browsers display the table with the columns separated far apart.</p></li>
<li><p>AsciiDoc template: Fix <code>author</code> and <code>date</code>; add <code>keywords</code>, <code>abstract</code> (Andrew Dunning).</p></li>
<li><p>HTML-based templates (Andrew Dunning):</p>
<ul>
<li>Use en dash instead of hyphen between title prefix and title.</li>
<li>Add <code>keywords</code> to metadata.</li>
<li>Add <code>lang</code>, <code>dir</code>, <code>quotes</code> where missing.</li>
<li>Always make author and date display conditional.</li>
<li>Updated dzslides template from source.</li>
</ul></li>
<li><p>Man template: make “generated by” comment conditional.</p></li>
<li><p>LaTeX, Beamer templates:</p>
<ul>
<li>Add <code>babel-otherlangs</code> for language divs/spans; <code>babel-newcommands</code>, filled by commands that make babel understand the polyglossia-style language directives (mb21, #137).</li>
<li>Improved formatting of conditionals; <code>$for$</code> is always provided to allow multiple options (Andrew Dunning, #141).</li>
<li>Use <code>Ligatures=TeX</code> rather than <code>Mapping=tex-text</code> with <code>fontspec</code> to improve support for LuaTeX (Andrew Dunning, #135).</li>
<li>Revise <code>hyperref</code> usage (Andrew Dunning, #139, #141):
<ul>
<li>use same options for all LaTeX engines;</li>
<li>add <code>subtitle</code> and <code>keywords</code> to PDF metadata;</li>
<li>do not override <code>hyperref</code> link coloring without user input, effectively making the <code>hidelinks</code> option the default (removed as a separate variable);</li>
<li>link colors can be enabled (using a slightly darker version of the old defaults) using a new <code>colorlinks</code> variable, automatically used by the LaTeX writer when custom colors are specified;</li>
<li><code>pdfborder={0 0 0}</code> is automatically set by <code>hyperref</code> with <code>colorlinks</code>, and is only applied if <code>colorlinks</code> is disabled.</li>
</ul></li>
</ul></li>
<li><p>ConTeXt template (Andrew Dunning):</p>
<ul>
<li>New variables for controlling styles: <code>linkstyle</code>, <code>linkcolor</code>, <code>linkcontrastcolor</code>, <code>layout</code>, <code>pagenumbering</code>, <code>whitespace</code>, <code>indenting</code>, <code>interlinespace</code>, <code>headertext</code>, <code>footertext</code>, <code>mainfont</code>, <code>sansfont</code>, <code>monofont</code>, <code>mathfont</code>, <code>fontsize</code>.</li>
<li>Default template no longer supports MkII.</li>
<li>Improve writing of title block (suppressing numbering of first page).</li>
<li>Add <code>title</code> <code>subtitle</code>, <code>author</code>, <code>date</code>, <code>keywords</code> to PDF metadata.</li>
<li>Support <code>subtitle</code>, <code>abstract</code>.</li>
<li>Support list of figures (<code>lof</code>), list of tables (<code>lot</code>).</li>
<li>Disable link styling by default.</li>
<li>Define styles for all section types.</li>
<li>Enable microtype.</li>
<li>Improved formatting of conditionals.</li>
</ul></li>
<li><p>Beamer template: added code to prevent slide breaks inside paragraphs (#2422, thanks to Nick Bart). This will matter, in practice, only when <code>allowframebreaks</code> is used. It is especially helpful for bibliography slides.</p></li>
<li><p>OpenDocument template: Add <code>&lt;office:automatic-styles&gt;</code> tag around automatic styles. The writer now longer provides this (see #2520).</p></li>
<li><p>Restored Text.Pandoc.Compat.Monoid.</p></li>
<li><p>Do not export (&lt;&gt;) from custom Prelude. The Prelude now matches base 4.8 Prelude’s API.</p></li>
<li><p>Don’t use custom prelude with ghc 7.10. Use the custom prelude only for earlier versions. This change makes <code>stack ghci</code> and <code>cabal repl</code> work (#2503), at least with ghc 7.10.</p></li>
<li><p>Changed § to % in operators from Odt.Arrows.Utils (#2457). This prevents problems building haddocks with “C” locale.</p></li>
<li><p>Change default for old-locale flag to False.</p></li>
<li><p>Use stack in deb, osx, and Windows package generators.</p></li>
<li><p>Added Vagrantfile for building deb in vm. This should help in automating binary package creation. ‘make package’ will make the package. ‘make package COMMIT=blah’ will make the package from commit blah.</p></li>
<li><p>README:</p>
<ul>
<li>Consistent capitalization for pandoc and Markdown.</li>
<li>Fixed <code>auto_identifiers</code> examples (Benoit Schweblin).</li>
<li>Improved documentation of template variables (Andrew Dunning).</li>
</ul></li>
</ul>
<h1 id="pandoc-1.15.1-15-oct-2015">pandoc 1.15.1 (15 Oct 2015)</h1>
<ul>
<li><p><code>pandocVersion</code> is now defined in <code>Text.Pandoc.Shared</code> and reexported from <code>Text.Pandoc</code> (Alex Vong). This allows writers to access it. (Alex Vong) (API change)</p></li>
<li><p>For <code>markdown_mmd</code>, add: <code>implicit_figures</code>, <code>superscripts</code>, <code>subscripts</code> (#2401).</p></li>
<li><p>Added <code>odt</code> as input format (MarLinn). Added new module <code>Text.Pandoc.Reader.ODT</code> (API change). Fully implemented features: Paragraphs, Headers, Basic styling, Unordered lists, Ordered lists, External Links, Internal Links, Footnotes, Endnotes, Blockquotes. Partly implemented features: Citations, Tables.</p></li>
<li><p>Markdown Reader:</p>
<ul>
<li>Add basic tests for each header style (Ophir Lifshitz).</li>
<li>Add implicit header ref tests for headers with spaces (Ophir Lifshitz).</li>
<li>Skip spaces in headers (Ophir Lifshitz).</li>
<li>Handle ‘id’ and ‘class’ in parsing key/value attributes (#2396). <code># Header {id=&quot;myid&quot; class=&quot;foo bar&quot;}</code> is now equivalent to <code># Header {#myid .foo .bar}</code>.</li>
<li>Use ‘=’ instead of ‘#’ for atx-style headers in markdown+lhs. (Kristof Bastiaensen)</li>
<li>Pipe tables: allow indented columns. Previously the left-hand column could not start with 4 or more spaces indent. This was inconvenient for right-aligned left columns. Note that the first (header column) must still have 3 or fewer spaces indentation, or the table will be treated as an indented code block.</li>
<li>Fix regression: allow HTML comments containing <code>--</code>. Technically this isn’t allowed in an HTML comment, but we’ve always allowed it, and so do most other implementations. It is handy if e.g. you want to put command line arguments in HTML comments.</li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Don’t eat excess whitespace after macros with only optional arguments (#2446).</li>
<li>Support longtable (#2411).</li>
<li>Implement <code>\Cite</code> (#2335).</li>
<li>Support abstract environment. The abstract populates an <code>abstract</code> metadata field.</li>
<li>Properly handle booktabs lines. Lines aren’t part of the pandoc table model, so we just ignore them (#2307).</li>
</ul></li>
<li><p>HTML reader:</p>
<ul>
<li>Handle type attribute on ol, e.g. <code>&lt;ol type=&quot;i&quot;&gt;</code> (#2313).</li>
<li>Updated for new automatic header attributes.</li>
<li>Add auto identifiers if not present on headers. This makes TOC linking work properly.</li>
<li>Detect <code>font-variant</code> with <code>pickStyleAttrProps</code> (Ophir Lifshitz).</li>
<li>Test <code>&lt;ol&gt;</code> type, class, and inline list-style(-type) CSS (Ophir Lifshitz).</li>
<li>Better handling of “section” elements (#2438). Previously <code>&lt;section&gt;</code> tags were just parsed as raw HTML blocks. With this change, section elements are parsed as Div elements with the class “section”.</li>
</ul></li>
<li><p>MediaWiki reader: handle unquoted table attributes (#2355).</p></li>
<li><p>DocBook reader:</p>
<ul>
<li>Added proper support for DocBook <code>xref</code> elements (Frerich Raabe). Added <code>dbContent</code> field to reader state, so we can lookup cross refs.</li>
<li>Handle <code>informalexample</code> (#2319).</li>
</ul></li>
<li><p>Docx Reader:</p>
<ul>
<li>Create special punctuation test (Ophir Lifshitz).</li>
<li>Parse soft, no-break hyphen elements (Ophir Lifshitz).</li>
<li>Updated headers test (Ophir Lifshitz). Replaced <code>styles.xml</code> in <code>headers.docx</code> with pandoc’s current <code>styles.xml</code>, which contains styles for Heading 1 through 6. Added Heading 4 through 7 to the test document. Note that Heading 7 is not parsed as a Heading because there is no Heading 7 style.</li>
</ul></li>
<li><p>RST reader: better handling of indirect roles. Previously the parser failed on this kind of case</p>
<pre><code>.. role:: indirect(code)

.. role:: py(indirect)
   :language: python

:py:`hi`</code></pre>
<p>Now it correctly recognizes <code>:py:</code> as a code role.</p></li>
<li><p>Org reader:</p>
<ul>
<li>Add auto identifiers if not present on headers (#2354, Juliusz Gonera).</li>
<li>Allow verse blocks to contain empty lines (#2402, Albert Krewinkel).</li>
</ul></li>
<li><p>EPUB reader: stop mangling external URLs (#2284).</p></li>
<li><p>RST writer:</p>
<ul>
<li>Don’t insert <code>\</code> when complex expression in matched pairs. E.g. <code>[:sup:`3`]</code> is okay; you don’t need <code>[:sup:`3`\ ]</code>.</li>
<li>Ensure that <code>\</code> is inserted when needed before Cite and Span elements that begin with a “complex” element (jgm/pandoc-citeproc#157).</li>
<li>Normalize headers only in “standalone” mode (#2394).</li>
</ul></li>
<li><p>Haddock writer: escape <code>*</code> and <code>^</code> (G. Bataille).</p></li>
<li><p>Markdown writer:</p>
<ul>
<li>In TOC, add links to headers (#829).</li>
<li>Use unicode super/subscripts for digits in plain output (when the <code>superscripts</code> and <code>subscripts</code> extensions are not enabled).</li>
</ul></li>
<li><p>Docx writer:</p>
<ul>
<li>Moved invalid character stripping to <code>formattedString</code>. This avoids an inefficient generic traversal (#2356).</li>
<li>Use user data directory for <code>reference.docx</code> archive. This allows the test suite to work without installing pandoc first. It also brings the docx writer in line with the odt writer.</li>
<li>Tests: docx writer tests now use <code>../data</code> for data directory. This allows tests to be run without installing first.</li>
<li>Tests: Use real jpg (not empty) for docx tests to avoid warning.</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Fixed detection of ‘chapters’ from template. If a documentclass isn’t specified in metadata, but the template has a hardwired bookish documentclass, act as if <code>--chapters</code> was used. This was the default in earlier versions, but it has been broken for a little while.</li>
<li>Correctly recognize book documentclass in metadata (#2395).</li>
<li>Set language-related variables automatically, depending on the value of the <code>lang</code> field, which is now always assumed to be in BCP47 format (mb21, #1614, #2437).</li>
<li>Add <code>\protect</code> to <code>\hyperdef</code> in inline context. This way we don’t get an error when this is used as a moveable argument (#2136).</li>
<li>Support all frame attributes in Beamer.</li>
<li>Percent-encode more special characters in URLs (#1640, #2377). The special characters are ‘&lt;’,‘&gt;’,‘|’,’“‘,’{‘,’}‘,’[‘,’]‘,’^‘,’`’.</li>
</ul></li>
<li><p>HTML writer:</p>
<ul>
<li>Update KaTeX JS and CSS versions (Emily Eisenberg).</li>
<li>For dzslides, add <code>role=&quot;note&quot;</code> for speaker notes (#1693).</li>
<li>Percent-encode more special characters in URLs (#1640, #2377). The special characters are ‘&lt;’,‘&gt;’,‘|’,’“‘,’{‘,’}‘,’[‘,’]‘,’^‘,’`’.</li>
<li>Render Div with class <code>section</code> as <code>&lt;section&gt;</code> in HTML5.</li>
</ul></li>
<li><p>EPUB writer:</p>
<ul>
<li>In TOC, replace literal <code>&lt;br/&gt;</code> with space (#2105).</li>
<li>With <code>--webtex</code>, include image file rather than <code>data:</code> URI (#2363).</li>
</ul></li>
<li><p>Native writer: format Div properly, with blocks separated.</p></li>
<li><p>Support bidirectional text output with XeLaTeX, ConTeXt and HTML (#2191, mb21).</p></li>
<li><p>Reference Docx:</p>
<ul>
<li>Add missing Header 6 style (steel blue) (Ophir Lifshitz).</li>
<li>Correct <code>outlineLvl</code> for Header styles (Ophir Lifshitz).</li>
</ul></li>
<li><p>Templates</p>
<ul>
<li>Beamer: Add <code>innertheme</code>, <code>outertheme</code> variables (Guilhem Bonnefille, #121). Add space after colon in figure caption. Integrate recent font and language updates from LaTeX template; allow use of <code>mainfont</code> variable for changing the slide text in XeTeX and LuaTeX (Andrew Dunning, #131).</li>
<li>LaTeX: Add <code>mainfontoptions</code>, <code>sansfontoptions</code>, <code>monofontoptions</code>, <code>mathfontoptions</code>, <code>fontfamilyoptions</code> (Andrew Dunning, #122). Support handling of bidirectional text (mb21, #120). Improve reliability of superscripts/subscripts under XeTeX and prevent letters and numbers from appearing on a different baseline by removing use of the <code>realscripts</code> package (via <code>xltxtra</code>). To restore use of OpenType characters for these features under XeTeX or LuaTeX, add <code>\usepackage{realscripts}</code> to <code>header-includes</code> (Andrew Dunning, #130). Remove redundant reference to <code>xunicode</code> (Andrew Dunning, #130). Add <code>fontenc</code>, <code>indent</code>, <code>subparagraph</code> variables (Andrew Dunning). Allow use of <code>hidelinks</code> variable for <code>hyperref</code> package (Hugo Roy, #113). Prevent package clash with <code>tufte-latex</code> and other classes that include <code>hyperref</code> or <code>color</code> (Xavier Olive, #115).</li>
<li>ConTeXt: Support handling of bidirectional text (mb21, #120).</li>
<li>LaTeX and ConTeXt: Use more specific language variables. Instead of directly using <code>lang</code>, we now use <code>babel-lang</code> and <code>polyglossia-lang</code> and <code>context-lang</code>. These variables are set by the writers to the necessary values, based on the <code>lang</code> variable (which now always takes a value in BCP47 format). (mb21, #114, #129).</li>
<li>HTML: Support handling of bidirectional text (mb21, #120). Move HTML5 shiv after CSS and fix URL (Andrew Dunning). Add dir attribute in html5 (Andrew Dunning).</li>
<li>reveal.js: Add <code>controls</code>, <code>progress</code> variables (Grégoire Pineau, #127). Add <code>width</code>, <code>height</code> variables (Anrew Dunning). Update template from 3.1 source (Andrew Dunning). All configuration options are now available as variables, but are only be included if set (reveal.js uses defaults otherwise).</li>
<li>man: Added comment stating that the page is autogenerated by pandoc, giving version. Added <code>adjusting</code> and <code>hyphenate</code> variables (Alex Vong, #123).</li>
</ul></li>
<li><p>epub.css: added selectors for nested emphasis (Pablo Rodriguez).</p></li>
<li><p>MediaBag: ensure that <code>/</code> is always used as path separator.</p></li>
<li><p><code>sample.lua</code>: define <code>CaptionedImage</code>, add newline at end (#2393).</p></li>
<li><p>Added <code>--bash-completion</code> option. This generates a bash completion script. To use: <code>eval &quot;$(pandoc --bash-completion)&quot;</code>.</p></li>
<li><p>Text.Pandoc.Error: Define Typeable and Exception instances for PandocError (#2386).</p></li>
<li><p>Text.Pandoc.Parsing: <code>toKey</code>: strip off outer brackets. This makes keys with extra space at the beginning and end work: e.g.</p>
<pre><code>[foo]: bar

[ foo ]</code></pre>
<p>will now be a link to bar (it wasn’t before).</p></li>
<li><p>Text.Pandoc: disable <code>auto_identifiers</code> for epub. The epub writer inserts its own auto identifiers; this is more complex due to splitting into “chapter” files.</p></li>
<li><p>Renamed Text.Pandoc.Compat.Locale -&gt; Text.Pandoc.Compat.Time. It now reexports Data.Time.</p></li>
<li><p>Use custom Prelude to avoid compiler warnings.</p>
<ul>
<li>The (non-exported) prelude is in prelude/Prelude.hs.</li>
<li>It exports Monoid and Applicative, like base 4.8 prelude, but works with older base versions.</li>
<li>It exports (&lt;&gt;) for mappend.</li>
<li>It hides ‘catch’ on older base versions.</li>
</ul></li>
<li><p>Added a <code>stack.ymal</code> and stack install instructions to INSTALL.</p></li>
<li><p>Clarified what is “out of scope” in README and CONTRIBUTING.md.</p></li>
<li><p>Added note to CONTRIBUTING.md about ghc versions and travis.</p></li>
<li><p>Clarify docs on block quotes. The space after <code>&gt;</code> is optional (#2346).</p></li>
<li><p>Removed obsolete reference to default.csl (#2372).</p></li>
<li><p>List all styles in manual for <code>--reference-docx</code> (Chris Black)</p></li>
<li><p>Don’t capitalize header links in man page.</p></li>
<li><p>Added section on repl to CONTRIBUTING.md.</p></li>
<li><p>README: Added space after backslash in image example (#2329).</p></li>
<li><p>Document details of citation locator terms (Nick Bart).</p></li>
<li><p>Fixed some internal links in README (#2309).</p></li>
<li><p>Improve CSL documentation, variables documentations, links, and cross-references in README. (Andrew Dunning)</p></li>
<li><p>Fix build failure with <code>--flags=-https</code> (Sergei Trofimovich).</p></li>
<li><p>Use <code>newManager</code> instead of <code>withManager</code> in recent <code>http-client</code>. This avoids a deprecation warning.</p></li>
<li><p>Allow building with latest versions of http-types, HUnit, criterion, syb, aeson.</p></li>
<li><p>Updated benchmark program for new criterion API.</p></li>
<li><p>Setup.hs: rewrite so as not to use process, directory, filepath. Using anything outside base is dangerous, since older versions of ghc may link against two different versions.</p></li>
<li><p>Added appveyor (Windows continuous integration) builds.</p></li>
<li><p>New <code>.travis.yml</code>. Autgenerated using <code>make_travis_yml.hs</code>. This script has been modified in a few ways, e.g. to add <code>GHCOPTS</code>. <code>make .travis.yml</code> regenerates it based on the tested-with field of the cabal file.</p></li>
</ul>
<h1 id="pandoc-1.15.0.6-15-jul-2015">pandoc 1.15.0.6 (15 Jul 2015)</h1>
<ul>
<li><p><code>--self-contained</code>: Fixed overaggressive CSS minimization (#2301, 2286). Previously <code>--self-contained</code> wiped out all spaces in CSS, including semantically significant spaces. This was a regression from 1.14.x.</p></li>
<li><p>Markdown reader: don’t allow bare URI links or autolinks in link label (#2300). Added test cases.</p></li>
<li><p><code>Text.Pandoc.Parsing</code>, <code>uri</code>: Improved bare autolink detection (#2299). Previously we disallowed <code>-</code> at the end of an autolink, and disallowed the combination <code>=-</code>. This commit liberalizes the rules for allowing punctuation in a bare URI, and adds test cases. One potential drawback is that you can no longer put a bare URI in em dashes like this: <code>this uri---http://example.com---is an example.</code> But in this respect we now match github’s treatment of bare URIs.</p></li>
<li><p>HTML writer: support speaker notes in dzslides. With this change <code>&lt;div class=&quot;notes&quot;&gt;</code> and also <code>&lt;div class=&quot;notes&quot; role=&quot;note&quot;&gt;</code> will be output if <code>-t dzslides</code> is used. So we can have speaker notes in dzslides too. Thanks to maybegeek.</p></li>
<li><p>Updated dzslides template.</p></li>
<li><p>Improved documentation of options to print system default files (#2298). <code>--print-default-data-file</code> and <code>--print-default-template</code>.</p></li>
<li><p>DokuWiki writer: use <code>$..$</code> for Math instead of <code>&lt;math&gt;..&lt;/math&gt;</code> (Tiziano Müller). MathJax seems currently to be the only maintained math rendering extension for DokuWiki.</p></li>
<li><p><code>Text.Pandoc.Shared</code>: Changed <code>hierarchicalize</code> so it treats references div as top-level header (#2294). This fixes a bug with <code>--section-divs</code>, where the final references section added by pandoc-citeproc, enclosed in its own div, got nested in the div for the section previous to it.</p></li>
<li><p>Allow vector 0.11.</p></li>
<li><p>Require cmark &gt; 0.4.</p></li>
</ul>
<h1 id="pandoc-1.15.0.5-10-jul-2015">pandoc 1.15.0.5 (10 Jul 2015)</h1>
<ul>
<li><p>HTML writer: Fixed email javascript obfuscation with <code>mailto:</code> URLs (#2280). This fixes a potential security issue. Because single quotes weren’t being escaped in the link portion, a specially crafted email address could allow javascript code injection.</p></li>
<li><p>RST reader: allow inline formatting in definition list field names (Lars-Dominik Braun).</p></li>
<li><p>PDF: Make sure <code>--latex-engine-opt</code> goes before the filename on the command line. LaTeX needs the argument to come after the options (#1779).</p></li>
<li><p>CommonMark writer: fixed tags used for super/subscript.</p></li>
<li><p>ConTeXt template: activate hanging indent for definition lists (mb21).</p></li>
<li><p>Make cabal require <code>hsb2hs</code> &gt;= 0.3.1 if <code>embed_data_files</code> specified. This is done by adding <code>hookedPrograms</code> in <code>Setup.hs</code>, which allows us to include <code>hsb2hs</code> in Build-Tools in cabal.</p></li>
<li><p>Improved Windows installer (thanks to nkalvi).</p>
<ul>
<li>When per-machine installation is chosen, the system path is updated instead of the user’s.</li>
<li>An appropriate default is used for per-machine installation directory.</li>
<li>Admin privileges are no longer required for a per-user install</li>
</ul></li>
<li><p>Travis: unpack sdist for build to catch packaging bugs.</p></li>
<li><p>Improved documentation on where user templates go (#2272).</p></li>
</ul>
<h1 id="pandoc-1.15.0.4-03-jul-2015">pandoc 1.15.0.4 (03 Jul 2015)</h1>
<ul>
<li><p>Added pandoc.1 man page to the repository. It is no longer built as part of the cabal build process. (This proved too fragile.) pandoc.1 can be regenerated (<code>make man/pandoc.1</code>) when <code>README</code> is changed.</p></li>
<li><p>Copying of the man page now respects <code>--destdir</code> (#2262).</p></li>
<li><p>Improved error messages for filters. User is now informed if the filter requires an interpreter that isn’t found in the path, or if the filter returns an error status.</p></li>
</ul>
<h1 id="pandoc-1.15.0.3-02-jul-2015">pandoc 1.15.0.3 (02 Jul 2015)</h1>
<ul>
<li>Ensure target directory is created when installing man page.</li>
</ul>
<h1 id="pandoc-1.15.0.2-02-jul-2015">pandoc 1.15.0.2 (02 Jul 2015)</h1>
<ul>
<li>Added files needed for building man page to Extra-Source-Files.</li>
</ul>
<h1 id="pandoc-1.15.0.1-01-jul-2015">pandoc 1.15.0.1 (01 Jul 2015)</h1>
<ul>
<li>Man page is now built and installed as part of the cabal build process. Removed Makefile target for man page.</li>
</ul>
<h1 id="pandoc-1.15-01-jul-2015">pandoc 1.15 (01 Jul 2015)</h1>
<ul>
<li><p>Man page changes:</p>
<ul>
<li>Removed <code>--man1</code>, <code>--man5</code> options (breaking change).</li>
<li>Removed <code>Text.Pandoc.ManPages</code> module (breaking API change).</li>
<li>Makefile target for <code>man/man1/pandoc.1</code>. This uses pandoc to create the man page from README using a custom template and filters.</li>
<li>Added <code>man/</code> directory with template and filters needed to build man page.</li>
<li>We no longer have two man pages: <code>pandoc.1</code> and <code>pandoc_markdown.5</code>. Now there is just pandoc.1, which has all the content from README. This change was needed because of the extensive cross-references between parts of the README.</li>
<li>Removed old <code>data/pandoc.1.template</code> and <code>data/pandoc_markdown.5.template</code>.</li>
</ul></li>
<li><p>OpenDocument writer: Do not add a carriage return after a hard line break (Michael Chladek).</p></li>
<li><p>ConTeXt writer:</p>
<ul>
<li>use <code>\goto</code> for internal links.</li>
<li>Added a <code>%</code> at end for <code>\reference</code> to avoid spurious space.</li>
</ul></li>
<li><p>Ignore sandbox on ‘make quick’</p></li>
</ul>
<h1 id="pandoc-1.14.1-30-jun-2015">pandoc 1.14.1 (30 Jun 2015)</h1>
<ul>
<li><p>Added <code>--man1</code> and <code>--man5</code> options to pandoc, allowing pandoc to generate its own man pages. Man pages are no longer automatically generated in the build process (the process for this was too complex and prone to failure, #2190). The <code>make-pandoc-man-pages</code> executable has been removed. The <code>man/</code> directory has been removed, and man page templates have been moved to <code>data/</code>. NOTE TO PACKAGERS: You will no longer find pandoc’s man pages in <code>man/</code>, but you can generate them using <code>pandoc --man1 &gt; pandoc.1</code> and <code>pandoc --man5 &gt; pandoc_markdown.5</code>.</p></li>
<li><p>Added new unexported module: <code>Text.Pandoc.ManPages</code>.</p></li>
<li><p><code>README</code> now acts like a data file (even though it isn’t in <code>data/</code>). So, for example, <code>pandoc --print-default-data-file README</code> will produce the README.) This change was required for the <code>--man1</code> and <code>--man5</code> options, since the man pages are produced from the README, but it may be useful for other purposes as well.</p></li>
<li><p>Allow <code>reference.docx</code> and <code>reference.odt</code> to be used with <code>--print-default-data-file</code> and to shadow defaults if placed in the user data directory. Note that as of 1.14, we no longer include these files as data files; instead, we include their components. This change causes pandoc to behave as if it has these data files; they are constructed on demand when needed using <code>getDefaultReferenceDocx</code> and <code>getDefaultReferenceODT</code>.</p></li>
<li><p>Fixed regression in CSS parsing with <code>--self-contained</code> (#2224). Pandoc 1.14.0.x used css-text to parse the CSS, but its parser silently drops big sections of CSS. This commit replaces the use of css-text with a small but principled CSS preprocessor, which removes whitespace and comments and replaces <code>url()</code> with base 64 data when possible.</p></li>
<li><p>Use <code>https://</code> instead of <code>//</code> for MathJax and KaTeX CDN URLs (#1920). This will allow math to work when pages are being viewed locally.</p></li>
<li><p><code>Text.Pandoc.Options</code>: Export <code>plainExtensions</code>. These are the extensions used in <code>plain</code> output.</p></li>
<li><p>LaTeX reader: Don’t parse <code>_</code> and <code>^</code> as sub/superscript outside of math mode; treat them as regular inline text. Normally these will cause an error in LaTeX, but there are contexts (e.g. <code>alltt</code> environments) where they are allowed.</p></li>
<li><p>HTML reader: allow <code>&lt;body&gt;</code> to close <code>&lt;head&gt;</code>.</p></li>
<li><p>DocBook reader: support <code>mediaobject</code>s and <code>figures</code> (#2184, mb21).</p></li>
<li><p>RST reader: Fix reference names with special characters (Lars-Dominik Braun).</p></li>
<li><p>Textile writer: escape <code>+</code> and <code>-</code> as entities (#2225).</p></li>
<li><p>DokuWiki writer: Use proper <code>&lt;code&gt;</code> tags for code blocks (#2213).</p></li>
<li><p>Plain writer: don’t use symbols for super/subscript (#2237). Simplified code by using <code>plainExtensions</code>.</p></li>
<li><p>InDesign writer: Properly escape URLs containing more than one colon character (gohai).</p></li>
<li><p>Docx writer: Make sure we use dist version of <code>reference.docx</code> (and not the user’s version) for certain settings. Taking some settings values from a user-supplied reference.docx can lead to corruption. This fixes a regression from the last release (#2249).</p></li>
<li><p><code>Text.Pandoc.Shared</code>: exports <code>getDefaultReferenceDocx</code> and <code>getDefaultReferenceODT</code> (API change). These functions have been removed from the Docx and ODT writers.</p></li>
<li>LaTeX template (Xavier Olive):
<ul>
<li>Added <code>CJKmainfont</code> and <code>CJKoptions</code> variables.</li>
<li>Allow dvipsnames (e.g. <code>MidnightBlue</code>) for colors (Xavier Olive).</li>
</ul></li>
<li><p>Epub templates: use <code>author.role</code>, not <code>author.type</code>.</p></li>
<li><p>Bump cmark version to &gt;= 0.3.4.</p></li>
<li><p>Improved Windows installer (#2205, thanks to nkalvi). Users can now select a per-user or systemwide install, and can set the installation path. At the end of installation, the install location is given. The install location is also now given in the list of installed programs in Control Panel. Cleaner WiX syntax is used for setting the path.</p></li>
<li><p>Added <code>download_stats</code> target to Makefile.</p></li>
</ul>
<h1 id="pandoc-1.14.0.4-02-jun-2015">pandoc 1.14.0.4 (02 Jun 2015)</h1>
<ul>
<li><p>Added missing commonmark template.</p></li>
<li><p>Improved try pandoc (moved button, show raw command).</p></li>
</ul>
<h1 id="pandoc-1.14.0.3-01-jun-2015">pandoc 1.14.0.3 (01 Jun 2015)</h1>
<ul>
<li><p>Allow compilation with syb 0.5.*.</p></li>
<li><p>Custom writer: fixed some compiler warnings for ghc &lt; 7.10.</p></li>
</ul>
<h1 id="pandoc-1.14.0.2-31-may-2015">pandoc 1.14.0.2 (31 May 2015)</h1>
<ul>
<li>Allow building with hslua 0.4.</li>
</ul>
<h1 id="pandoc-1.14.0.1-28-may-2015">pandoc 1.14.0.1 (28 May 2015)</h1>
<ul>
<li><p>Fixed problem with building of <code>reference.docx</code> and <code>reference.odt</code> when the <code>embed_data_files</code> flag is used. Instead of having a phase of the build where <code>reference.docx</code> and <code>reference.odt</code> are created from their constituent data files, we now construct these archives from their constituents when a <code>docx</code> or <code>odt</code> is built. The constituent files have been moved from <code>extra-source-files</code> to <code>data-files</code>, and <code>reference.docx</code> and <code>reference.odt</code> have been removed. Users can create their own <code>reference.docx</code> or <code>reference.odt</code> by using pandoc to create a simple <code>docx</code> or <code>odt</code>. <code>make-reference-files.hs</code> has been removed, simplifying the build process (#2187)</p></li>
<li><p>Don’t include generated man pages in extra-source-files (#2189).</p></li>
<li><p>Bumped upper bound for aeson.</p></li>
<li><p>ConTeXt writer: create internal link anchors for Div elements with identifiers. (This is needed for linked citations to work.)</p></li>
</ul>
<h1 id="pandoc-1.14-27-may-2015">pandoc 1.14 (27 May 2015)</h1>
<h2 id="new-features-1">New features</h2>
<ul>
<li><p>Added <code>commonmark</code> as input and output format.</p></li>
<li><p>Added <code>--verbose</code> flag for debugging output in PDF production (#1840, #1653).</p></li>
<li><p>Allow wildcards in <code>--epub-embed-font</code> arguments (#1939).</p></li>
<li><p>Added <code>--latex-engine-opt</code> option (#969, #1779, Sumit Sahrawat).</p></li>
<li><p>Added <code>shortcut_reference_links</code> extension (Konstantin Zudov, #1977). This is enabled by default for those markdown flavors that support reading shortcut reference links, namely: <code>markdown</code>, <code>markdown_strict</code>, <code>markdown_github</code>, <code>markdown_php</code>. If the extension is enabled, the reader parses shortcut reference links like <code>[foo]</code>, and the writer creates such links unless doing so would cause problems. Users of markdown flavors that support shortcut reference links should not notice a difference in reading markdown, but the markdown pandoc produces may differ. If shortcut links are not desired, the extension can be disabled in the normal way.</p></li>
</ul>
<h2 id="behavior-changes-1">Behavior changes</h2>
<ul>
<li><p><code>--toc</code> is now supported for <code>docx</code> output (#458, Nikolay Yakimov). A “dirty” TOC is created at the beginning of document. It can be regenerated after the document has been opened.</p></li>
<li><p>An implicit <code>--filter pandoc-citeproc</code> is now triggered only when the <code>--bibliography</code> option is used, and not when the <code>bibliography</code> field in metadata is specified (#1849).</p></li>
<li><p>Markdown reader:</p>
<ul>
<li>Reference links with <code>implicit_header_references</code> are no longer case-sensitive (#1606).</li>
<li><p>Definition lists no longer require indentation for first line (#2087). Previously the body of the definition (after the <code>:</code> or <code>~</code> marker) needed to be in column 4. This commit relaxes that requirement, to better match the behavior of PHP Markdown Extra. So, now this is a valid definition list:</p>
<pre><code>  foo
  : bar</code></pre></li>
<li><p>Resolve a potentially ambiguity with table captions:</p>
<pre><code>  foo

    : bar

    -----
    table
    -----</code></pre>
Is “bar” a definition, or the caption for the table? We’ll count it as a caption for the table.</li>
<li>Disallow headerless pipe tables (#1996), to conform to GFM and PHP Markdown Extra. Note: If you have been using headerless pipe tables, this change may cause existing tables to break.</li>
<li>Allow pipe tables with header but no body (#2017).</li>
<li><p>Allow a digit as first character of a citation key (Matthias Troffaes). See https://github.com/jgm/pandoc-citeproc/issues/97</p></li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Don’t limit includes to <code>.tex</code> extension (#1882). If the extension is not <code>.tex</code>, it must be given explicitly in the <code>\input</code> or <code>\include</code>.</li>
</ul></li>
<li><p>Docx reader:</p>
<ul>
<li>Allow numbering in the style file. This allows inherited styles with numbering (lists) (Jesse Rosenthal).</li>
</ul></li>
<li><p>Org reader:</p>
<ul>
<li>Support smart punctuation (Craig Bosma).</li>
<li>Drop trees with a :noexport: tag (Albert Krewinkel). Trees having a <code>:noexport:</code> tag set are not exported. This mirrors org-mode.</li>
<li>Put header tags into empty spans (Albert Krewinkel, #2160). Org mode allows headers to be tagged: <code>* Headline  :TAG1:TAG2</code>. Instead of being interpreted as part of the headline, the tags are now put into the attributes of empty spans. Spans without textual content won’t be visible by default, but they are detectable by filters. They can also be styled using CSS when written as HTML.</li>
<li>Generalize code block result parsing (Albert Krewinkel). Previously, only code blocks were recognized as result blocks; now, any kind of block can be the result.</li>
</ul></li>
<li><p>Append newline to the LineBreak in Dokuwiki, HTML, EPUB, LaTeX, MediaWiki, OpenDocument, Texinfo writers (#1924, Tim Lin).</p></li>
<li><p>HTML writer:</p>
<ul>
<li>Add “inline” or “display” class to math spans (#1914). This allows inline and display math to be styled differently.</li>
<li>Include raw latex blocks if <code>--mathjax</code> specified (#1938).</li>
<li>Require highlighting-kate &gt;= 0.5.14 (#1903). This ensures that all code blocks will be wrapped in a <code>div</code> with class <code>sourceCode</code>. Also, the default highlighting CSS now adds <code>div.sourceCode { x-overflow: auto; }</code>, which means that code blocks (even with line numbers) will acquire a scroll bar on screens too small to display them (e.g. mobile phones). See also jgm/highlighting-kate#65.</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Use a declaration for tight lists (Jose Luis Duran, Joseph Harriott). Previously, pandoc hard-coded some commands to make tight lists in LaTeX. Now we use a custom command instead, allowing the styling to be changed in a macro in the header. (Note: existing templates may need to be modified to include the definition of this macro. See the current template.)</li>
<li>Beamer output: if the header introducing a slide has the class <code>fragile</code>, add the <code>[fragile]</code> option to the slide (#2119).</li>
</ul></li>
<li><p>MediaWiki writer:</p>
<ul>
<li>Use <code>File:</code> instead of the deprecated <code>Image:</code> for images and other media files (Greg Rundlett).</li>
</ul></li>
<li><p>DocBook writer:</p>
<ul>
<li>Render a <code>Div (id,_,_) [Para _]</code> element as a <code>para</code> element with an <code>id</code> attribute. This makes links to citations work in DocBook with pandoc-citeproc.</li>
</ul></li>
<li><p>RST writer:</p>
<ul>
<li>Normalize headings to sequential levels (Nikolay Yakimov). This is pretty much required by docutils.</li>
<li>Treat headings in block quotes, etc as rubrics (Nikolay Yakimov).</li>
<li>Better handling of raw latex inline (#1961). We use <code>:raw-latex:`...`</code> and add a definition for this role to the template.</li>
</ul></li>
<li><p>EPUB writer:</p>
<ul>
<li>Remove <code>linear=no</code> from cover <code>itemref</code> (#1609).</li>
<li>Don’t use <code>sup</code> element for epub footnotes (#1995). Instead, just use an a element with class <code>footnoteRef</code>. This allows more styling options, and provides better results in some readers (e.g. iBooks, where anything inside the a tag breaks popup footnotes).</li>
<li>Take TOC title from <code>toc-title</code> metadata field.</li>
</ul></li>
<li><p>Docx writer:</p>
<ul>
<li>Implemented <code>FirstParagraph</code> style (Jesse Rosenthal). Following the ODT writer, we add the <code>FirstParagraph</code> style to the first text paragraph following an image, blockquote, table, heading, or beginning of document. This allows it to be styled differently. The default is for it to be the same as <code>Normal</code>.</li>
<li>Added <code>BodyText</code> style (Jesse Rosenthal). We apply a <code>BodyText</code> style to all unstyled paragraphs. This is, essentially, the same as <code>Normal</code>, except that since not everything inherits from <code>BodyText</code> (the metadata won’t, for example, or the headers or footnote numbers), we can change the text in the body without having to make exceptions for everything. If we do want to change <em>everything</em>, we can still do it through <code>Normal</code>.</li>
<li>Altered <code>Blockquote</code> style slightly (Jesse Rosenthal). Since <code>BlockQuote</code> derives from <code>BodyText</code>, we just want to specify by default that it won’t indent, regardless of what <code>BodyText</code> does. Note that this will not produce any visible difference in the default configuration.</li>
<li>Take TOC title from <code>toc-title</code> metadata field (Nikolay Yakimov).</li>
<li>Added a style to figure images (Nikolay Yakimov). Figures with empty captions use style <code>Figure</code>. Figures with nonempty captions use style <code>Figure with Caption</code>, which is based on <code>Figure</code>, and additionally has <code>keepNext</code> set.</li>
</ul></li>
<li><p>ODT writer:</p>
<ul>
<li>Added figure captions (Nikolay Yakimov). The following styles are used for figures: <code>Figure</code> – for figure with empty caption), <code>FigureWithCaption</code> (based on <code>Figure</code>) – for figure with caption, <code>FigureCaption</code> (based on <code>Caption</code>) – for figure captions. Also, <code>TableCaption</code> (based on <code>Caption</code>) is used for table captions.</li>
</ul></li>
</ul>
<h2 id="api-changes-1">API changes</h2>
<ul>
<li><p>New <code>Text.Pandoc.Error</code> module with <code>PandocError</code> type (Matthew Pickering).</p></li>
<li><p>All readers now return <code>Either PandocError Pandoc</code> instead of <code>Pandoc</code> (Matthew Pickering). This allows better handling of errors.</p></li>
<li><p>Added <code>Text.Pandoc.Writers.CommonMark</code>, exporting <code>writeCommonMark</code>.</p></li>
<li><p>Added <code>Text.Pandoc.Readers.CommonMark</code>, exporting <code>readCommonMark</code>.</p></li>
<li><p>Derive <code>Data</code> and <code>Typeable</code> instances for <code>MediaBag</code>, <code>Extension</code>, <code>ReaderOptions</code>, <code>EPUBVersion</code>, <code>CiteMethod</code>, <code>ObfuscationMethod</code>, <code>HTMLSlideVariant</code>, <code>TrackChanges</code>, <code>WriterOptions</code> (Shabbaz Youssefi).</p></li>
<li><p>New <code>Ext_shortcut_reference_links</code> constructor for <code>Extension</code> (Konstantin Zudov).</p></li>
</ul>
<h2 id="bug-fixes">Bug fixes</h2>
<ul>
<li><p>Markdown reader:</p>
<ul>
<li>Allow smart <code>'</code> after inline math (#1909, Nikolay Yakimov).</li>
<li>Check for tex macros after indented code (#1973).</li>
<li>Rewrote <code>charsInBalancedBrackets</code> for efficiency.</li>
<li>Make sure a closing <code>&lt;/div&gt;</code> doesn’t get included in a definition list item (#2127).</li>
<li>Don’t parse bracketed text as citation if it might be a link, image, or footnote (Nikolay Yakimov).</li>
<li>Require space after key in mmd title block (#2026, Nikolay Yakimov). Require space after key-value delimiter colon in mmd title block.</li>
<li>Require nonempty value in mmd title block (Nikolay Yakimov).</li>
<li>Disable all metadata block extensions when parsing metadata field values (#2026, Nikolay Yakimov). Otherwise we could get a mmd title block inside YAML metadata, for example.</li>
</ul></li>
<li><p>HTML reader:</p>
<ul>
<li>Improve self-closing tag detection in <code>htmlInBalanced</code> (#2146).</li>
<li>Handle tables with <code>&lt;th&gt;</code> in body rows (#1859, mb21).</li>
<li>Fixed <code>htmlTag</code> (#1820). If the tag parses as a comment, we check to see if the input starts with <code>&lt;!--</code>. If not, it’s bogus comment mode and we fail <code>htmlTag</code>.</li>
<li>Handle <code>base</code> tag; if it has an <code>href</code> value, this is added to all relative URLs in links and images.</li>
</ul></li>
<li><p>DocBook reader:</p>
<ul>
<li>Look inside “info” elements for section titles (#1931).</li>
</ul></li>
<li><p>Docx reader:</p>
<ul>
<li>Parse images in deprecated vml format (Jesse Rosenthal).</li>
<li>Allow sub/superscript verbatims (Jesse Rosenthal). Verbatim usually shuts off all other run styles, but we don’t want it to shut off sub/superscript.</li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Handle <code>tabular*</code> environment (#1850). Note that the table width is not actually parsed or taken into account, but pandoc no longer chokes on it.</li>
<li>Ignore options in <code>\lstinline</code> rather than raising error (#1997).</li>
<li>Add some test cases for simple tables (Mathias Schenner).</li>
<li>Handle valign argument in tables (Mathias Schenner) (currently we just ignore this).</li>
<li>Allow non-empty colsep in tables (Mathias Schenner). The <code>tabular</code> environment allows non-empty column separators with the “@{…}” syntax. Previously, pandoc would fail to parse tables if a non-empty colsep was present. With this commit, these separators are still ignored, but the table gets parsed. A test case is included.</li>
<li>Recognize <code>\newpage</code> as a block command.</li>
<li>Allow block content in
(#2001).</li>
<li>Check for block-level newcommand aliases in blockCommand (Nikolay Yakimov).</li>
<li>Guard against paragraph starting with inline macro (Nikolay Yakimov).</li>
<li>Properly gobble spaces after <code>\\</code> (#2007).</li>
</ul></li>
<li><p>Textile reader:</p>
<ul>
<li>Handle newlines in table cells, and empty cells (#1919).</li>
</ul></li>
<li><p>Org reader:</p>
<ul>
<li>Allow image links with non-image targets (Hans-Peter Deifel). This matches behavior of Org-Mode for links like <code>[[http://example.com][https://www.haskell.org/static/img/logo.png]]</code>.</li>
</ul></li>
<li><p>Docbook writer:</p>
<ul>
<li>Don’t print empty id attributes (thanks to Steve Horne).</li>
</ul></li>
<li><p>HTML writer:</p>
<ul>
<li>Fixed list-style-type for numbered example lists. Should be “decimal,” not “example” (#1902).</li>
<li>Do not omit missing <code>alt</code> attribute on <code>img</code> tag (#1131, Konstantin Zudov).</li>
<li>Allow multiple colgroups in table (#2122).</li>
<li>In revealjs, ensure that lists in speaker notes don’t add “fragment” classes, which can cause additional keypresses to be needed to advance a slide (#1394).</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Don’t escape <code>$</code> in URL (#1913).</li>
<li>Don’t use listings in headers (Matthew Pickering, #1963).</li>
<li>Recognize book documentclass if set in metadata (#1971). This sets <code>--chapters</code> implicitly if the documentclass in metadata is a book documentclass. Previously this was done only if a book documentclass was set in a variable.</li>
<li>Add a <code>\label</code> in <code>\hyperdef</code> for Div, Span (or links don’t work).</li>
<li>Make <code>mainlang</code> work when <code>lang</code> is in metadata (#2174).</li>
</ul></li>
<li><p>Texinfo writer:</p>
<ul>
<li>Fix wrapping by using breakable spaces (Tim Lin).</li>
</ul></li>
<li><p>RST writer:</p>
<ul>
<li>Fixed toc depth in RST writer. Previously the depth was being rendered as a floating point number with a decimal point.</li>
</ul></li>
<li><p>Markdown writer:</p>
<ul>
<li>Improved escaping (#2086). <code>&lt;</code> should not be escaped as <code>\&lt;</code>, for compatibility with original Markdown. We now escape <code>&lt;</code> and <code>&gt;</code> with entities. Also, we now backslash-escape square brackets.</li>
<li>Avoid introducing spurious list items through wrapping (#1946).</li>
<li>Don’t emit span tags if plain or raw HTML disabled.</li>
</ul></li>
<li><p>MediaWiki writer:</p>
<ul>
<li>Convert spaces to underscores in wikilink URL (#1982), like MediaWiki.</li>
</ul></li>
<li><p>AsciiDoc writer:</p>
<ul>
<li>Insert some needed blank lines (#1860).</li>
<li>Avoid wrapping after list marker (#1858).</li>
</ul></li>
<li><p>EPUB writer:</p>
<ul>
<li>Properly handle internal links to IDs in spans, divs (#1884).</li>
<li>Use plain writer for metadata dc: fields (#2121). This gives better results when we have, e.g. multiple paragraphs. Note that tags aren’t allowed in these fields.</li>
<li>Properly handle image links without an extension (#1855).</li>
<li>Improved chapter splitting and internal link rewriting (#1887, #2162, #2163). This will ensure that internal links work and that the references section produced by pandoc-citeproc is in its own chapter.</li>
<li>Fixed handling of svg images (#2183).</li>
</ul></li>
<li><p>ICML writer:</p>
<ul>
<li>Better handling of raw blocks and inlines (#1951). Previously these were always escaped and printed verbatim. Now they are ignored unless the format is <code>icml</code>, in which case they are passed through unescaped.</li>
<li>Fixed image URIs in ICML output (gohai).</li>
</ul></li>
<li><p>Custom writer:</p>
<ul>
<li>Raise error if loadstring returns an error status.</li>
<li>Raise <code>PandocLuaException</code> instead of using ‘error’. Eventually we’ll change the return type so that no exception is involved, but at least this can be trapped.</li>
<li>Use UTF-8 aware bytestring conversion.</li>
<li>Set foreign encoding to UTF-8 (Nikolay Yakimov, #2101, #1634). Also factored out ByteString, since it’s only used as an intermediate representation.</li>
</ul></li>
<li><p>Docx writer:</p>
<ul>
<li>Copy hyphenation settings from reference.docx (Nikolay Yakimov).</li>
<li>Filter out illegal XML characters (#1992, Matthew Pickering).</li>
<li>Added <code>noProof</code> to docx syntax highlighting <code>SourceCode</code> style.</li>
<li>Added footnotes id -1 and 0 (Jesse Rosenthal). Word uses, by default, footnotes with id -1 and 0 for separators. If a user modifies <code>reference.docx</code>, they will end up with a <code>settings.xml</code> file that references these footnotes, but no such footnotes in the document. This will produce a corruption error. Here we add these to the document and <code>settings.xml</code> file, so future modifications won’t break the file.</li>
<li>Handle lists correctly inside table cells (Jesse Rosenthal). Previously we didn’t transform lists inside table cells.</li>
<li>Set firstRow information in tables (Nikolay Yakimov).</li>
<li>Don’t replace <code>SourceCode</code> style in <code>reference.docx</code> if it is defined there (Nikolay Yakimov, #1872). If <code>--no-highlight</code> specified, remove any <code>SourceCode</code> and <code>*Tok</code> styles in <code>reference.docx</code>.</li>
<li>Attempt to match international style names (#1607, Nikolay Yakimov).</li>
<li>Set these styles as custom (Nikolay Yakimov): <code>Author</code>, <code>Abstract</code>, <code>Compact</code>, <code>Image Caption</code>, <code>Table Caption</code>, <code>Definition Term</code>, <code>Definition</code>, <code>First Paragraph</code>.</li>
<li>Rename these styles to correspond with Word <code>Normal.dotm</code> (Nikolay Yakimov): <code>Block Quote -&gt; Block Text</code>, <code>Link -&gt; Hyperlink</code>, <code>Footnote Ref -&gt; Footnote Reference</code>.</li>
<li>Added <code>Caption</code> style (Nikolay Yakimov).</li>
<li>Changed these styles’ inheritance (Nikolay Yakimov): <code>Image Caption &lt;- Caption</code>, <code>Table Caption &lt;- Caption</code>.</li>
<li>Remove <code>SourceCode</code> style from <code>reference.docx</code> (#1872). This is added automatically by the docx writer.</li>
<li>Added toc heading style to <code>reference.docx</code> (Nikolay Yakimov).</li>
</ul></li>
<li><p><code>Text.Pandoc.PDF</code></p>
<ul>
<li>Don’t suggest “Try xelatex” if xelatex already in use (mb21, #1832).</li>
<li>More comprehensible errors on image conversion (#2067). EPS can’t be supported without shelling out to something like ImageMagick, but at least we can avoid mysterious error messages.</li>
</ul></li>
<li><p><code>Text.Pandoc.Shared</code>:</p>
<ul>
<li>Make safeRead safe (#1801, Matthew Pickering).</li>
<li>Addded <code>mapLeft</code>, <code>hush</code> (Matthew Pickering).</li>
</ul></li>
<li><p><code>Text.Pandoc.Pretty</code>:</p>
<ul>
<li>Remove partial function (Matthew Pickering).</li>
</ul></li>
<li><p><code>Text.Pandoc.SelfContained</code>:</p>
<ul>
<li>Add <code>;charset=utf-8</code> to script mime type if missing (#1842).</li>
<li>Improved building of data URIs (#1940). Now base64 is used except for <code>text/*</code> mime types.</li>
<li><code>cssURLs</code> no longer tries to fetch fragment URLs (#2121).</li>
<li>Properly handle data URIs in css urls (#2129). Use a proper CSS parser (adds dependency on <code>text-css</code>).</li>
</ul></li>
<li><p><code>Text.Pandoc.UTF8</code>:</p>
<ul>
<li>Better handling of bare CRs in input files (#2132). Previously we just stripped them out; now we convert other line ending styles to LF line endings.</li>
</ul></li>
<li><p><code>Text.Pandoc.ImageSize</code>:</p>
<ul>
<li>Fixed some exif header parsing bugs (#1834).</li>
<li>Make imageSize return an Either, not a Maybe (#1834). Use <code>runGetOrFail</code> (with <code>binary &gt;= 0.7</code>) to return <code>Left</code> on parse failure (rather than <code>error</code>).</li>
<li>Improved warnings when image size can’t be determined.</li>
<li>Removed error landmines (Matthew Pickering).</li>
</ul></li>
<li><p>Added woff2 to MIME types (Alfred Wechselberger).</p></li>
<li><p>pandoc: When a binary input format is used, warn that file arguments past the first one are being ignored (Matthew Pickering).</p></li>
</ul>
<h2 id="template-changes">Template changes</h2>
<ul>
<li><p>LaTeX template:</p>
<ul>
<li>Degrade gracefully if <code>\paragraph</code> not defined.</li>
<li>Include <code>grffile</code> together with <code>graphicx</code> (#2074). This properly handles filenames containing spaces and dots.</li>
<li>Redefine <code>\paragraph</code>, <code>\subparagraph</code>… to behave more like section headers (#1658).</li>
<li>Import hyperref before polyglossia to avoid an error with xelatex, “please load package hyperref before bidi package” (Nick Bart).</li>
<li>Added <code>toccolor</code> variable to control link color in toc (Kaixhin).</li>
</ul></li>
<li><p>LaTeX, Beamer templates:</p>
<ul>
<li>Provide <code>\tightlist</code>, which is now used by the LaTeX writer.</li>
<li>Use polyglossia in beamer (#85).</li>
<li>Use <code>bibliography</code> instead of <code>biblio-files</code> (#1661). Also use <code>\addbibresource</code> instead of <code>\bibliography</code> for biblatex.</li>
<li>Added <code>setotherlanguages</code> in polyglossia. This uses an <code>otherlang</code> variable that is derived from a comma-separated list in <code>lang</code>; the last language is <code>mainlang</code> and the others are <code>otherlang</code>.</li>
</ul></li>
<li><p>EPUB templates:</p>
<ul>
<li>Use <code>div</code>, not <code>p</code>, for “rights” on title page.</li>
<li>Added header-includes, include-before, include-after (#1987).</li>
</ul></li>
<li><p>OpenDocument template:</p>
<ul>
<li>Use <code>text:p</code> instead of <code>text:h</code> for title. Using <code>text:h</code> causes problems with numbering. Closes #2059. Thansk to <span class="citation" data-cites="nkalvi">@nkalvi</span> for diagnosing this.</li>
</ul></li>
<li><p>reveal.js template:</p>
<ul>
<li>Link to non-minified css, js. The minified versions no longer ship with the library.</li>
<li>Correctly include style CSS (#1949).</li>
<li>New configurable options options: <code>center</code>, <code>maxScale</code>, <code>slideNuber</code> (Dmitry Smirnov, pandoc-templates#89).</li>
<li>Moved custom CSS after theme. This allows custom CSS to modify themes, instead of being replaced by them.</li>
<li>Allow <code>center</code> to be set to false.</li>
</ul></li>
</ul>
<h2 id="under-the-hood-improvements">Under the hood improvements</h2>
<ul>
<li><p>Removed pre-built <code>reference.docx</code> and <code>reference.odt</code> (Nikolay Yakimov). Instead the repository now includes the component text files, and the zipped binaries are built from these using a helper program, <code>make-reference-files</code>. This should make maintenance of these components easier going forward.</p></li>
<li><p><code>Text.Pandoc.Parsing</code>:</p>
<ul>
<li>Added new <code>&lt;+?&gt;</code> combinator (Nikolay Yakimov).</li>
<li>Added <code>stateHeaderKeys</code> to <code>ParserState</code>.</li>
</ul></li>
<li><p><code>make_deb.sh</code> fixes:</p>
<ul>
<li>Detect architecture.</li>
<li>Add Installed-Size to debian package control file (#1900).</li>
<li>Use <code>fakeroot</code> to get permissions right.</li>
<li>Use <code>mkdir</code> and <code>cp</code> instead of <code>install</code>.</li>
<li>Set permissions of directories to 755.</li>
<li>Install in <code>/usr</code> rather than <code>/usr/local</code>.</li>
<li>Compress man pages.</li>
<li>Combine copyright files for <code>pandoc</code>, <code>pandoc-citeproc</code>.</li>
</ul></li>
<li><p>Added <code>Text.Pandoc.Compat.Locale</code> and <code>old-locale</code> flag to assist with transition to <code>time</code> 1.5.</p></li>
<li><p>Updated CONTRIBUTING.md with information about issue tags (Matthew Pickering).</p></li>
<li><p>Updated travis installs to the new sudo-less syntax (Tim Lin).</p></li>
<li><p>Updated dependency version bounds.</p></li>
<li><p>EPUB tests: don’t use <code>joinPath</code>, which varies across platforms. Instead, use a forward-slash to join paths, regardless of the platform. This matches the way <code>MediaBag</code> now works.</p></li>
<li><p>Clarify JSON input and output in usage message (Caleb McDaniel).</p></li>
<li><p>Improved INSTALL instructions.</p></li>
<li><p>Always build man pages. Removed make-pandoc-man-pages flag.</p></li>
<li><p>Makefile: removed man target, now that we generate man pages by default.</p></li>
<li><p>README:</p>
<ul>
<li>Fixed typos (J. Lewis Muir).</li>
<li>Added documentation on backtick_code_blocks (#2135, Nikolay Yakimov).</li>
<li>Added note on in-field markup in biblio databases (Nick Bart).</li>
<li>Fixed misleading example of raw HTML block.</li>
<li>Various minor formatting and consistency fixes for the program options (Andreas Lööw).</li>
<li>Made definition lists for options all “loose” for consistency.</li>
<li>Added YAML biblio format to table, and note on <code>pandoc-citeproc</code>’s <code>--bib2json</code> and <code>--bib2yaml</code> options (Nick Bart).</li>
<li>Removed obsolete reference to <code>mods2yaml</code> (Nick Bart).</li>
<li>Added section on syntax highlighting.</li>
<li>Documented <code>toccolor</code> variable.</li>
</ul></li>
</ul>
<h1 id="pandoc-1.13.2.1-15-apr-2015">pandoc 1.13.2.1 (15 Apr 2015)</h1>
<ul>
<li><p>Updated to build with ghc 7.10.1.</p></li>
<li><p>Bumped package upper bounds for filepath, blaze-html, blaze-markup.</p></li>
</ul>
<h1 id="pandoc-1.13.2-20-dec-2014">pandoc 1.13.2 (20 Dec 2014)</h1>
<ul>
<li><p>TWiki Reader: add new new twiki reader (API chaneg, Alexander Sulfrian).</p></li>
<li><p>Markdown reader:</p>
<ul>
<li>Better handling of paragraph in div (#1591). Previously text that ended a div would be parsed as Plain unless there was a blank line before the closing div tag.</li>
<li>Don’t treat a citation as a reference link label (#1763).</li>
<li>Fix autolinks with following punctuation (#1811). The price of this is that autolinked bare URIs can no longer contain <code>&gt;</code> characters, but this is not a big issue.</li>
<li>Fix <code>Ext_lists_without_preceding_blankline</code> bug (#1636, Artyom).</li>
<li>Allow <code>startnum</code> to work without <code>fancy_lists</code>. Formerly <code>pandoc -f markdown-fancy_lists+startnum</code> did not work properly.</li>
</ul></li>
<li><p>RST reader (all Daniel Bergey):</p>
<ul>
<li>Parse quoted literal blocks (#65). RST quoted literal blocks are the same as indented literal blocks (which pandoc already supports) except that the quote character is preserved in each line.</li>
<li>Parse RST class directives. The class directive accepts one or more class names, and creates a Div value with those classes. If the directive has an indented body, the body is parsed as the children of the Div. If not, the first block folowing the directive is made a child of the Div. This differs from the behavior of rst2xml, which does not create a Div element. Instead, the specified classes are applied to each child of the directive. However, most Pandoc Block constructors to not take an Attr argument, so we can’t duplicate this behavior.</li>
<li>Warn about skipped directives.</li>
<li>Literal role now produces Code. Code role should have “code” class.</li>
<li><p>Improved support for custom roles</p>
<ul>
<li>Added <code>sourceCode</code> to classes for <code>:code:</code> role, and anything inheriting from it.</li>
<li>Add the name of the custom role to classes if the Inline constructor supports Attr.</li>
<li>If the custom role directive does not specify a parent role, inherit from the <code>:span:</code> role.</li>
</ul>
This differs somewhat from the <code>rst2xml.py</code> behavior. If a custom role inherits from another custom role, Pandoc will attach both roles’ names as classes. <code>rst2xml.py</code> will only use the class of the directly invoked role (though in the case of inheriting from a <code>:code:</code> role with a <code>:language:</code> defined, it will also provide the inherited language as a class).</li>
<li><p>Warn about ignored fields in role directives.</p></li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Parse label after caption into a span instead of inserting an additional paragraph of bracketed text (#1747).</li>
<li>Parse math environments as inline when possible (#1821).</li>
<li>Better handling of <code>\noindent</code> and <code>\greektext</code> (#1783).</li>
<li>Handle <code>\texorpdfstring</code> more gracefully.</li>
<li>Handle <code>\cref</code> and <code>\sep</code> (Wikiwide).</li>
<li>Support <code>\smartcite</code> and <code>\Smartcite</code> from biblatex.</li>
</ul></li>
<li><p>HTML reader:</p>
<ul>
<li>Retain display type of MathML output (#1719, Matthew Pickering).</li>
<li>Recognise <code>&lt;br&gt;</code> tags inside <code>&lt;pre&gt;</code> blocks (#1620, Matthew Pickering).</li>
<li>Make <code>embed</code> tag either block or inline (#1756).</li>
</ul></li>
<li><p>DocBook reader:</p>
<ul>
<li>Handle <code>keycombo</code>, <code>keycap</code> (#1815).</li>
<li>Get string content in inner tags for literal elements (#1816).</li>
<li>Handle <code>menuchoice</code> elements better, with a <code>&gt;</code> between (#1817).</li>
<li>Include <code>id</code> on section headers (#1818).</li>
<li>Document/test “type” as implemented (Brian O’Sullivan).</li>
<li>Add support for calloutlist and callout (Brian O’Sullivan). We treat a calloutlist as a bulleted list. This works well in practice.</li>
<li>Add support for <code>classname</code> (Bryan O’Sullivan).</li>
</ul></li>
<li><p>Docx reader:</p>
<ul>
<li>Fix window path for image lookup (Jesse Rosenthal). Don’t use os-sensitive “combine”, since we always want the paths in our zip-archive to use forward-slashes.</li>
<li>Single-item headers in ordered lists are headers (Jesse Rosenthal). When users number their headers, Word understands that as a single item enumerated list. We make the assumption that such a list is, in fact, a header.</li>
<li>Rewrite rewriteLink to work with new headers (Jesse Rosenthal). There could be new top-level headers after making lists, so we have to rewrite links after that.</li>
<li>Use polyglot header list (Jesse Rosenthal). We’re just keeping a list of header formats that different languages use as their default styles. At the moment, we have English, German, Danish, and French. We can continue to add to this. This is simpler than parsing the styles file, and perhaps less error-prone, since there seems to be some variations, even within a language, of how a style file will define headers.</li>
<li>Remove header class properly in other langs (Jesse Rosenthal). When we encounter one of the polyglot header styles, we want to remove that from the par styles after we convert to a header. To do that, we have to keep track of the style name, and remove it appropriately.</li>
<li>Account for external link URLs with anchors. Previously, if a URL had an anchor, the reader would incorrectly identify it as an internal link and return only the anchor as URL. (Caleb McDaniel)</li>
<li>Fix for Issue #1692 (i18n styles) (Nikolay Yakimov).</li>
</ul></li>
<li><p>Org reader:</p>
<ul>
<li>Added state changing blanklines (Jesse Rosenthal). This allows us to emphasize at the beginning of a new paragraph (or, in general, after blank lines).</li>
<li><p>Fixed bug with bulleted lists:</p>
<ul>
<li>a</li>
<li>b</li>
<li>c</li>
</ul>
was being parsed as a list, even though an unindented <code>*</code> should make a heading. See <a href="http://orgmode.org/manual/Plain-lists.html#fn-1" class="uri">http://orgmode.org/manual/Plain-lists.html#fn-1</a>.</li>
<li>Org reader: absolute, relative paths in link (#1741, Albert Krewinkel). The org reader was too restrictive when parsing links; some relative links and links to files given as absolute paths were not recognized correctly.</li>
<li>Org reader: allow empty links (jgm/gitit#471, Albert Krewinkel). This is important for use in gitit, which uses empty links for wikilinks.</li>
<li>Respect indent when parsing Org bullet lists (#1650, Timothy Humphries). Fixes issue with top-level bullet list parsing.</li>
<li>Fix indent issue for definition lists (Timothy Humphries, see #1650, #1698, #1680).</li>
<li>Parse multi-inline terms correctly in definition list (#1649, Matthew Pickering).</li>
<li>Fix rules for emphasis recognition (Albert Krewinkel). Things like <code>/hello,/</code> or <code>/hi'/</code> were falsy recognized as emphasised strings. This is wrong, as <code>,</code> and <code>'</code> are forbidden border chars and may not occur on the inner border of emphasized text.</li>
<li>Drop COMMENT document trees (Albert Krewinkel). Document trees under a header starting with the word <code>COMMENT</code> are comment trees and should not be exported. Those trees are dropped silently (#1678).</li>
<li>Properly handle links to <code>file:target</code> (Albert Krewinkel). Org links like <code>[[file:target][title]]</code> were not handled correctly, parsing the link target verbatim. The org reader is changed such that the leading <code>file:</code> is dropped from the link target (see #756, #1812).</li>
<li><p>Parse LaTeX-style MathML entities (#1657, Albert Krewinkel). Org supports special symbols which can be included using LaTeX syntax, but are actually MathML entities. Examples for this are <code>\nbsp</code> (non-breaking space), <code>\Aacute</code> (the letter A with accent acute) or <code>\copy</code> (the copyright sign ©)</p></li>
</ul></li>
<li><p>EPUB reader:</p>
<ul>
<li>URI handling improvements. Now we outsource most of the work to <code>fetchItem'</code>. Also, do not include queries in file extensions (#1671).</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Use <code>\texorpdfstring</code> for section captions when needed (Vaclav Zeman).</li>
<li>Handle consecutive linebreaks (#1733).</li>
<li>Protect graphics in headers (Jesse Rosenthal). Graphics in <code>\section</code>/<code>\subsection</code> etc titles need to be <code>\protect</code>ed.</li>
<li>Put <code>~</code> before header in list item text (Jesse Rosenthal). Because of the built-in line skip, LaTeX can’t handle a section header as the first element in a list item.</li>
<li>Avoid using reserved characters as <code>\lstinline</code> delimiters (#1595).</li>
<li>Better handling of display math in simple tables (#1754). We convert display math to inline math in simple tables, since LaTeX can’t deal with display math in simple tables.</li>
<li>Escape spaces in code (#1694, Bjorn Buckwalter).</li>
</ul></li>
<li><p>MediaWiki writer:</p>
<ul>
<li>Fixed links with URL = text. Previously these were rendered as bare words, even if the URL was not an absolute URL (#1825).</li>
</ul></li>
<li><p>ICML writer:</p>
<ul>
<li>Don’t force all citations into footnotes.</li>
</ul></li>
<li><p>RTF writer:</p>
<ul>
<li>Add blankline at end of output (#1732, Matthew Pickering).</li>
</ul></li>
<li><p>RST writer:</p>
<ul>
<li>Ensure blank line after figure.</li>
<li>Avoid exces whitespace after last list item (#1777).</li>
<li>Wrap line blocks with spaces before continuations (#1656).</li>
<li>Fixed double-rendering of footnotes in RST tables (#1769).</li>
</ul></li>
<li><p>DokuWiki writer:</p>
<ul>
<li>Better handling of block quotes. This change ensures that multiple paragraph blockquotes are rendered using native <code>&gt;</code> rather than as HTML (#1738).</li>
<li>Fix external images (#1739). Preface relative links with “:”, absolute URIs without. (Timothy Humphries)</li>
</ul></li>
<li><p>HTML writer:</p>
<ul>
<li>Use protocol-relative URL for mathjax.</li>
<li>Put newline btw img and caption paragraph.</li>
<li>MathML now outputted with tex annotation (#1635, Matthew Pickering).</li>
<li>Add support for KaTeX HTML math (#1626, Matthew Pickering). This adds <code>KaTeX</code> to <code>HTMLMathMethod</code> (API change).</li>
<li>Don’t double render when <code>email-obfuscation=none</code> (#1625, Matthew Pickering).</li>
<li>Make header attributes work outside top level (#1711). Previously they only appeared on top level header elements. Now they work e.g. in blockquotes.</li>
</ul></li>
<li><p>ODT writer:</p>
<ul>
<li>Correctly handle images without extensions (#1729).</li>
<li>Strip querystring in ODT write (#1682, Todd Sifleet).</li>
</ul></li>
<li><p>FB2 writer:</p>
<ul>
<li>Add newline to output.</li>
</ul></li>
<li><p>EPUB writer:</p>
<ul>
<li>Don’t add <code>sourceURL</code> to absolute URIs (#1669).</li>
<li>Don’t use unsupported <code>opf:title-type</code> for epub2.</li>
<li>Include “landmarks” section in nav document for epub3 (#1757).</li>
<li>Removed playOrder from navpoint elements in ncx file (#1760). These aren’t required, and they make manual modification of epubs difficult.</li>
<li>Extract title even from structured title.</li>
<li>Don’t include nav node in spine unless <code>--toc</code> was requested. Previously we included it in the spine with <code>linear=&quot;no&quot;</code>, leading to odd results in some readers (#1593).</li>
<li>Fixed absolute URI detection (#1672).</li>
<li>Correctly resolve relative URIs (#1671).</li>
<li>Use regular page template for <code>nav.xhtml</code>, including doctype (#1759).</li>
</ul></li>
<li><p>Docx writer:</p>
<ul>
<li>Put docx table captions above tables (#1641, Nikolay Yakimov).</li>
<li>Get the page width from the reference docx file, and use it to scale images that are too large to fit (Grégory Bataille).</li>
<li>Partial fix for #1607 (Nikolay Yakimov). International heading styles are inferred based on <code>&lt;w:name val=&quot;heading #&quot;&gt;</code> fallback, if there are no en-US “Heading#” styles</li>
<li>Look in user data dir for archive <code>reference.docx</code>.</li>
<li>Renumber header and footer relationships to avoid collisions (Jesse Rosenthal). We previously took the old relationship names of the headers and footer in secptr. That led to collisions. We now make a map of availabl names in the relationships file, and then rename in secptr.</li>
</ul></li>
<li><p>ConTeXt writer:</p>
<ul>
<li>Add function toLabel (Mark Szepieniec). This function can be used to sanitize reference labels so that they do not contain any of the illegal characters #[]“,{}%()|= . Currently only Links have their labels sanitized, because they are the only Elements that use passed labels.</li>
</ul></li>
<li><p><code>Text.Pandoc.Shared</code>:</p>
<ul>
<li>Moved import of <code>toChunks</code> outside of CPP conditional (#1590).</li>
<li>Fix <code>inDirectory</code> to reset to the original directory in case an exception occurs (Freiric Barral).</li>
</ul></li>
<li><p>Templates:</p>
<ul>
<li>LaTeX template: load polyglossia before bibtex (jgm/pandoc-templates#70). Thanks to bluebirch.</li>
<li>LaTeX template: Added <code>\VerbatimFootnotes</code> if there is verbatim in notes (#1616).</li>
<li>LaTeX template: Add shorthands=off to babel options (#1648).</li>
<li>EPUB, EPUB3 templates: Added <code>id=&quot;cover&quot;</code> to body of cover page. This aids styling, making it possible for example to set 0 margins on the title page (#1758).</li>
<li><p>EPUB, EPUB3 templates: Handle structured metadata on titlepage. Previously we just expected ‘title’, ‘subtitle’, ‘author’, ‘date’. Now we still support those, but also support the format recommended for epub metadata in the pandoc README:</p>
<hr />
title:
<ul>
<li>type: main text: My Book</li>
<li>type: subtitle text: An investigation of metadata creator:</li>
<li>role: author text: John Smith</li>
<li>role: editor text: Sarah Jones identifier:</li>
<li>scheme: DOI text: doi:10.234234.234/33 publisher: My Press rights: (c) 2007 John Smith, CC BY-NC …</li>
</ul></li>
</ul></li>
<li><p><code>Text.Pandoc.Templates.getDefaultTemplate</code>: don’t fail when called with “fb2” (#1660).</p></li>
<li><p><code>Text.Pandoc.Parsing</code>:</p>
<ul>
<li>Fixed <code>inlineMath</code> so it handles <code>\text{..}</code> containing <code>$</code>. For example: <code>$x = \text{the $n$th root of $y$}</code> (#1677).</li>
<li>Change <code>parseFromString</code> to fail if not all input is consumed. (Matthew Pickering)</li>
<li>Moved <code>addWarning</code> from Markdown reader to <code>Parsing</code>, so it can be used by more readers (API change, Daniel Bergey).</li>
</ul></li>
<li><p><code>Text.Pandoc.Pretty</code>:</p>
<ul>
<li>Improve performance of <code>realLength</code> (Matthew Pickering).</li>
<li>Make CR + BLANKLINE = BLANKLINE. This fixes an extra blank line we were getting at the end of markdown fragments (as well as rst, org, etc.) (#1705).</li>
</ul></li>
<li><p><code>Text.Pandoc.MIME</code>:</p>
<ul>
<li>Add mime type for WebVTT (Jason Ronallo).</li>
<li>Changed mime type for <code>otf</code> to <code>application/vnd.ms-opentype</code> (#1761). This is needed for epub3 validation.</li>
</ul></li>
<li><p><code>Text.Pandoc.MediaBag</code>:</p>
<ul>
<li>Fix Windows specific path problems (#1597).</li>
</ul></li>
<li><p><code>Text.Pandoc.Shared</code>:</p>
<ul>
<li>Make <code>collapseFilePath</code> OS-agnostic (Matthew Pickering).</li>
</ul></li>
<li><p>Link the test suite using <code>-threaded</code>. This allows the test suite to be run using <code>+RTS -N</code>.</p></li>
<li><p>Added <code>network</code> dependency under <code>network-uri</code> flag in test section.</p></li>
<li><p>Give better error messages when someone tries to convert from pdf, doc, odt (#1683).</p></li>
<li><p>Added <code>track</code> to list of tags treated by <code>--self-contained</code> (#1664).</p></li>
</ul>
<h1 id="pandoc-1.13.1-30-aug-2014">pandoc 1.13.1 (30 Aug 2014)</h1>
<ul>
<li><p>Fixed <code>--self-contained</code> with Windows paths (#1558). Previously <code>C:\foo.js</code> was being wrongly interpreted as a URI.</p></li>
<li><p>HTML reader: improved handling of tags that can be block or inline. Previously a section like this would be enclosed in a paragraph, with RawInline for the video tags (since video is a tag that can be either block or inline):</p>
<pre><code>&lt;video controls=&quot;controls&quot;&gt;
   &lt;source src=&quot;../videos/test.mp4&quot; type=&quot;video/mp4&quot; /&gt;
   &lt;source src=&quot;../videos/test.webm&quot; type=&quot;video/webm&quot; /&gt;
   &lt;p&gt;
      The videos can not be played back on your system.&lt;br/&gt;
      Try viewing on Youtube (requires Internet connection):
      &lt;a href=&quot;http://youtu.be/etE5urBps_w&quot;&gt;Relative Velocity on
Youtube&lt;/a&gt;.
   &lt;/p&gt;
&lt;/video&gt;</code></pre>
<p>This change will cause the video and source tags to be parsed as RawBlock instead, giving better output. The general change is this: when we’re parsing a “plain” sequence of inlines, we don’t parse anything that COULD be a block-level tag.</p></li>
<li><p>Docx reader:</p>
<ul>
<li>Be sensitive to user styles. Note that “Hyperlink” is “blacklisted,” as we don’t want the default underline styling to be inherited by all links by default (Jesse Rosenthal).</li>
<li>Read single paragraph in table cell as <code>Plain</code> (Jesse Rosenthal). This makes to docx reader’s native output fit with the way the markdown reader understands its markdown output.</li>
</ul></li>
<li><p>Txt2Tags reader:</p>
<ul>
<li>Header is now parsed only if standalone flag is set (Matthew Pickering).</li>
<li>The header is now parsed as meta information. The first line is the <code>title</code>, the second is the <code>author</code> and third line is the <code>date</code> (Matthew Pickering).</li>
<li>Corrected formatting of <code>%%mtime</code> macro (Matthew Pickering).</li>
<li>Fixed crash when reading from stdin.</li>
</ul></li>
<li><p>Textile writer: Extended the range of cases where native textile tables will be used (as opposed to raw HTML): we now handle any alignment type, but only for simple tables with no captions.</p></li>
<li><p>EPUB writer: Don’t use page-progression-direction in EPUB2, which doesn’t support it. Also, if page-progression-direction not specified in metadata, don’t include the attribute even in EPUB3; not including it is the same as including it with the value “default”, as we did before. (#1550)</p></li>
<li><p>Org writer: Accept example lines with indentation at the beginning (Calvin Beck).</p></li>
<li><p>DokuWiki writer:</p>
<ul>
<li>Refactor to use Reader monad (Matthew Pickering).</li>
<li>Avoid using raw HTML in table cells; instead, use <code>\\</code> instead of newlines (Jesse Rosenthal).</li>
<li>Properly handle HTML table cell alignments, and use spacing to make the tables look prettier (#1566).</li>
</ul></li>
<li><p>Docx writer:</p>
<ul>
<li>Bibliography entries get <code>Bibliography</code> style (#1559).</li>
<li>Implement change tracking (Jesse Rosenthal).</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Fixed a bug that caused a table caption to repeat across all pages (Jose Luis Duran).</li>
<li>Improved vertical spacing in tables and made it customizable using standard lengths set by booktab. See <a href="https://groups.google.com/forum/#!msg/pandoc-discuss/qMu6_5lYy0o/ZAU7lzAIKw0J" class="uri">https://groups.google.com/forum/#!msg/pandoc-discuss/qMu6_5lYy0o/ZAU7lzAIKw0J</a> (Jose Luis Duran).</li>
<li>Added <code>\strut</code> to fix spacing in multiline tables (Jose Luis Duran).</li>
<li>Use <code>\tabularnewline</code> instead of <code>\\</code> in table cells (Jose Luis Duran).</li>
<li>Made horizontal rules more flexible (Jose Luis Duran).</li>
</ul></li>
<li><p>Text.Pandoc.MIME:</p>
<ul>
<li>Added <code>MimeType</code> (type synonym for <code>String</code>) and <code>getMimeTypeDef</code>. Code cleanups (Artyom Kazak).</li>
</ul></li>
<li><p>Templates:</p>
<ul>
<li>LaTeX template: disable microtype protrusion for typewriter font (#1549, thanks lemzwerg).</li>
</ul></li>
<li><p>Improved OSX build procedure.</p></li>
<li><p>Added <code>network-uri</code> flag, to deal with split of <code>network-uri</code> from <code>network</code>.</p></li>
<li><p>Fix build dependencies for the <code>trypandoc</code> flag, so that they are ignored if <code>trypandoc</code> flag is set to False (Gabor Pali).</p></li>
<li><p>Updated README to remove outdated claim that <code>--self-contained</code> looks in the user data directory for missing files.</p></li>
</ul>
<h1 id="pandoc-1.13.0.1-17-august-2014">pandoc 1.13.0.1 (17 August 2014)</h1>
<ul>
<li><p>Docx writer:</p>
<ul>
<li>Fixed regression which bungled list numbering (#1544), causing all lists to appear as basic ordered lists.</li>
<li>Include row width in table rows (Christoffer Ackelman, Viktor Kronvall). Added a property to all table rows where the sum of column widths is specified in pct (fraction of 5000). This helps persuade Word to lay out the table with the widths we specify.</li>
</ul></li>
<li><p>Fixed a bug in Windows 8 which caused pandoc not to find the <code>pandoc-citeproc</code> filter (#1542).</p></li>
<li><p>Docx reader: miscellaneous under-the-hood improvements (Jesse Rosenthal). Most significantly, the reader now uses Builder, leading to some performance improvements.</p></li>
<li><p>HTML reader: Parse appropriately styled span as SmallCaps.</p></li>
<li><p>Markdown writer: don’t escape <code>$</code>, <code>^</code>, <code>~</code> when <code>tex_math_dollars</code>, <code>superscript</code>, and <code>subscript</code> extensions, respectively, are deactivated (#1127).</p></li>
<li><p>Added <code>trypandoc</code> flag to build CGI executable used in the online demo.</p></li>
<li><p>Makefile: Added ‘quick’, ‘osxpkg’ targets.</p></li>
<li><p>Updated README in templates to indicate templates license. The templates are dual-licensed, BSD3 and GPL2+.</p></li>
</ul>
<h1 id="pandoc-1.13-15-august-2014">pandoc 1.13 (15 August 2014)</h1>
<h2 id="new-features-2">New features</h2>
<ul>
<li><p>Added <code>docx</code> as an input format (Jesse Rosenthal). The docx reader includes conversion of native Word equations to pandoc LaTeX <code>Math</code> elements. Metadata is taken from paragraphs at the beginning of the document with styles <code>Author</code>, <code>Title</code>, <code>Subtitle</code>, <code>Date</code>, and <code>Abstract</code>.</p></li>
<li><p>Added <code>epub</code> as an input format (Matthew Pickering). The epub reader includes conversion of MathML to pandoc LaTeX <code>Math</code> elements.</p></li>
<li><p>Added <code>t2t</code> (Txt2Tags) as an input format (Matthew Pickering). Txt2tags is a lightweight markup format described at <a href="http://txt2tags.org/" class="uri">http://txt2tags.org/</a>.</p></li>
<li><p>Added <code>dokuwiki</code> as an output format (Clare Macrae).</p></li>
<li><p>Added <code>haddock</code> as an output format.</p></li>
<li><p>Added <code>--extract-media</code> option to extract media contained in a zip container (docx or epub) while adjusting image paths to point to the extracted images.</p></li>
<li><p>Added a new markdown extension, <code>compact_definition_lists</code>, that restores the syntax for definition lists of pandoc 1.12.x, allowing tight definition lists with no blank space between items, and disallowing lazy wrapping. (See below under behavior changes.)</p></li>
<li><p>Added an extension <code>epub_html_exts</code> for parsing HTML in EPUBs.</p></li>
<li><p>Added extensions <code>native_spans</code> and <code>native_divs</code> to activate parsing of material in HTML span or div tags as Pandoc Span inlines or Div blocks.</p></li>
<li><p><code>--trace</code> now works with the Markdown, HTML, Haddock, EPUB, Textile, and MediaWiki readers. This is an option intended for debugging parsing problems; ordinary users should not need to use it.</p></li>
</ul>
<h2 id="behavior-changes-2">Behavior changes</h2>
<ul>
<li><p>Changed behavior of the <code>markdown_attribute</code> extension, to bring it in line with PHP markdown extra and multimarkdown. Setting <code>markdown=&quot;1&quot;</code> on an outer tag affects all contained tags, recursively, until it is reversed with <code>markdown=&quot;0&quot;</code> (#1378).</p></li>
<li><p>Revised markdown definition list syntax (#1429). Both the reader and writer are affected. This change brings pandoc’s definition list syntax into alignment with that used in PHP markdown extra and multimarkdown (with the exception that pandoc is more flexible about the definition markers, allowing tildes as well as colons). Lazily wrapped definitions are now allowed. Blank space is required between list items. The space before a definition is used to determine whether it is a paragraph or a “plain” element. <strong>WARNING: This change may break existing documents!</strong> Either check your documents for definition lists without blank space between items, or use <code>markdown+compact_definition_lists</code> for the old behavior.</p></li>
<li><p><code>.numberLines</code> now works in fenced code blocks even if no language is given (#1287, jgm/highlighting-kate#40).</p></li>
<li><p>Improvements to <code>--filter</code>:</p>
<ul>
<li>Don’t search PATH for a filter with an explicit path. This fixed a bug wherein <code>--filter ./caps.py</code> would run <code>caps.py</code> from the system path, even if there was a <code>caps.py</code> in the working directory.</li>
<li>Respect shebang if filter is executable (#1389).</li>
<li>Don’t print misleading error message. Previously pandoc would say that a filter was not found, even in a case where the filter had a syntax error.</li>
</ul></li>
<li><p>HTML reader:</p>
<ul>
<li>Parse <code>div</code> and <code>span</code> elements even without <code>--parse-raw</code>, provided <code>native_divs</code> and <code>native_spans</code> extensions are set. Motivation: these now generate native pandoc Div and Span elements, not raw HTML.</li>
<li>Parse EPUB-specific elements if the <code>epub_html_exts</code> extension is enabled. These include <code>switch</code>, <code>footnote</code>, <code>rearnote</code>, <code>noteref</code>.</li>
</ul></li>
<li><p>Org reader:</p>
<ul>
<li>Support for inline LaTeX. Inline LaTeX is now accepted and parsed by the org-mode reader. Both math symbols (like <code>\tau</code>) and LaTeX commands (like <code>\cite{Coffee}</code>), can be used without any further escaping (Albert Krewinkel).</li>
</ul></li>
<li><p>Textile reader and writer:</p>
<ul>
<li>The <code>raw_tex</code> extension is no longer set by default. You can enable it with <code>textile+raw_tex</code>.</li>
</ul></li>
<li><p>DocBook reader:</p>
<ul>
<li>Support <code>equation</code>, <code>informalequation</code>, <code>inlineequation</code> elements with <code>mml:math</code> content. This is converted into LaTeX and put into a Pandoc Math inline.</li>
</ul></li>
<li><p>Revised <code>plain</code> output, largely following the style of Project Gutenberg:</p>
<ul>
<li>Emphasis is rendered with <code>_underscores_</code>, strong emphasis with ALL CAPS.</li>
<li>Headings are rendered differently, with space to set them off, not with setext style underlines. Level 1 headers are ALL CAPS.</li>
<li>Math is rendered using unicode when possible, but without the distracting emphasis markers around variables.</li>
<li>Footnotes use a regular <code>[n]</code> style.</li>
</ul></li>
<li><p>Markdown writer:</p>
<ul>
<li>Horizontal rules are now a line across the whole page.</li>
<li>Prettier pipe tables. Columns are now aligned (#1323).</li>
<li>Respect the <code>raw_html</code> extension. <code>pandoc -t markdown-raw_html</code> no longer emits any raw HTML, including span and div tags generated by Span and Div elements.</li>
<li>Use span with style for <code>SmallCaps</code> (#1360).</li>
</ul></li>
<li><p>HTML writer:</p>
<ul>
<li>Autolinks now have class <code>uri</code>, and email autolinks have class <code>email</code>, so they can be styled.</li>
</ul></li>
<li><p>Docx writer:</p>
<ul>
<li>Document formatting is carried over from <code>reference.docx</code>. This includes margins, page size, page orientation, header, and footer, including images in headers and footers.</li>
<li>Include abstract (if present) with <code>Abstract</code> style (#1451).</li>
<li>Include subtitle (if present) with <code>Subtitle</code> style, rather than tacking it on to the title (#1451).</li>
</ul></li>
<li><p>Org writer:</p>
<ul>
<li>Write empty span elements with an id attribute as org anchors. For example <code>Span (&quot;uid&quot;,[],[]) []</code> becomes <code>&lt;&lt;uid&gt;&gt;</code>.</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Put table captions above tables, to match the conventional standard. (Previously they appeared below tables.)</li>
<li>Use <code>\(..\)</code> instead of <code>$..$</code> for inline math (#1464).</li>
<li>Use <code>\nolinkurl</code> in email autolinks. This allows them to be styled using <code>\urlstyle{tt}</code>. Thanks to Ulrike Fischer for the solution.</li>
<li>Use <code>\textquotesingle</code> for <code>'</code> in inline code. Otherwise we get curly quotes in the PDF output (#1364).</li>
<li>Use <code>\footnote&lt;.&gt;{..}</code> for notes in beamer, so that footnotes do not appear before the overlays in which their markers appear (#1525).</li>
<li>Don’t produce a <code>\label{..}</code> for a Div or Span element. Do produce a <code>\hyperdef{..}</code> (#1519).</li>
</ul></li>
<li><p>EPUB writer:</p>
<ul>
<li>If the metadata includes <code>page-progression-direction</code> (which can be <code>ltr</code> or <code>rtl</code>, the <code>page-progression-direction</code> attribute will be set in the EPUB spine (#1455).</li>
</ul></li>
<li><p>Custom lua writers:</p>
<ul>
<li>Custom writers now work with <code>--template</code>.</li>
<li>Removed HTML header scaffolding from <code>sample.lua</code>.</li>
<li>Made citation information available in lua writers.</li>
</ul></li>
<li><p><code>--normalize</code> and <code>Text.Pandoc.Shared.normalize</code> now consolidate adjacent <code>RawBlock</code>s when possible.</p></li>
</ul>
<h2 id="api-changes-2">API changes</h2>
<ul>
<li><p>Added <code>Text.Pandoc.Readers.Docx</code>, exporting <code>readDocx</code> (Jesse Rosenthal).</p></li>
<li><p>Added <code>Text.Pandoc.Readers.EPUB</code>, exporting <code>readEPUB</code> (Matthew Pickering).</p></li>
<li><p>Added <code>Text.Pandoc.Readers.Txt2Tags</code>, exporting <code>readTxt2Tags</code> (Matthew Pickering).</p></li>
<li><p>Added <code>Text.Pandoc.Writers.DokuWiki</code>, exporting <code>writeDokuWiki</code> (Clare Macrae).</p></li>
<li><p>Added <code>Text.Pandoc.Writers.Haddock</code>, exporting <code>writeHaddock</code>.</p></li>
<li><p>Added <code>Text.Pandoc.MediaBag</code>, exporting <code>MediaBag</code>, <code>lookupMedia</code>, <code>insertMedia</code>, <code>mediaDirectory</code>, <code>extractMediaBag</code>. The docx and epub readers return a pair of a <code>Pandoc</code> document and a <code>MediaBag</code> with the media resources they contain. This can be extracted using <code>--extract-media</code>. Writers that incorporate media (PDF, Docx, ODT, EPUB, RTF, or HTML formats with <code>--self-contained</code>) will look for resources in the <code>MediaBag</code> generated by the reader, in addition to the file system or web.</p></li>
<li><p><code>Text.Pandoc.Readers.TexMath</code>: Removed deprecated <code>readTeXMath</code>. Renamed <code>readTeXMath'</code> to <code>texMathToInlines</code>.</p></li>
<li><p><code>Text.Pandoc</code>: Added <code>Reader</code> data type (Matthew Pickering). <code>readers</code> now associates names of readers with <code>Reader</code> structures. This allows inclusion of readers, like the docx reader, that take binary rather than textual input.</p></li>
<li><p><code>Text.Pandoc.Shared</code>:</p>
<ul>
<li>Added <code>capitalize</code> (Artyom Kazak), and replaced uses of <code>map toUpper</code> (which give bad results for many languages).</li>
<li>Added <code>collapseFilePath</code>, which removes intermediate <code>.</code> and <code>..</code> from a path (Matthew Pickering).</li>
<li>Added <code>fetchItem'</code>, which works like <code>fetchItem</code> but searches a <code>MediaBag</code> before looking on the net or file system.</li>
<li>Added <code>withTempDir</code>.</li>
<li>Added <code>removeFormatting</code>.</li>
<li>Added <code>extractSpaces</code> (from HTML reader) and generalized its type so that it can be used by the docx reader (Matthew Pickering).</li>
<li>Added <code>ordNub</code>.</li>
<li>Added <code>normalizeInlines</code>, <code>normalizeBlocks</code>.</li>
<li><code>normalize</code> is now <code>Pandoc -&gt; Pandoc</code> instead of <code>Data a :: a -&gt; a</code>. Some users may need to change their uses of <code>normalize</code> to the newly exported <code>normalizeInlines</code> or <code>normalizeBlocks</code>.</li>
</ul></li>
<li><p><code>Text.Pandoc.Options</code>:</p>
<ul>
<li>Added <code>writerMediaBag</code> to <code>WriterOptions</code>.</li>
<li>Removed deprecated and no longer used <code>readerStrict</code> in <code>ReaderOptions</code>. This is handled by <code>readerExtensions</code> now.</li>
<li>Added <code>Ext_compact_definition_lists</code>.</li>
<li>Added <code>Ext_epub_html_exts</code>.</li>
<li>Added <code>Ext_native_divs</code> and <code>Ext_native_spans</code>. This allows users to turn off the default pandoc behavior of parsing contents of div and span tags in markdown and HTML as native pandoc Div blocks and Span inlines.</li>
</ul></li>
<li><p><code>Text.Pandoc.Parsing</code>:</p>
<ul>
<li>Generalized <code>readWith</code> to <code>readWithM</code> (Matthew Pickering).</li>
<li>Export <code>runParserT</code> and <code>Stream</code> (Matthew Pickering).</li>
<li>Added <code>HasQuoteContext</code> type class (Matthew Pickering).</li>
<li>Generalized types of <code>mathInline</code>, <code>smartPunctuation</code>, <code>quoted</code>, <code>singleQuoted</code>, <code>doubleQuoted</code>, <code>failIfInQuoteContext</code>, <code>applyMacros</code> (Matthew Pickering).</li>
<li>Added custom <code>token</code> (Matthew Pickering).</li>
<li>Added <code>stateInHtmlBlock</code> to <code>ParserState</code>. This is used to keep track of the ending tag we’re waiting for when we’re parsing inside HTML block tags.</li>
<li>Added <code>stateMarkdownAttribute</code> to <code>ParserState</code>. This is used to keep track of whether the markdown attribute has been set in an enclosing tag.</li>
<li>Generalized type of <code>registerHeader</code>, using new type classes <code>HasReaderOptions</code>, <code>HasIdentifierList</code>, <code>HasHeaderMap</code> (Matthew Pickering). These allow certain common functions to be reused even in parsers that use custom state (instead of <code>ParserState</code>), such as the MediaWiki reader.</li>
<li>Moved <code>inlineMath</code>, <code>displayMath</code> from Markdown reader to Parsing, and generalized their types (Matthew Pickering).</li>
</ul></li>
<li><p><code>Text.Pandoc.Pretty</code>:</p>
<ul>
<li>Added <code>nestle</code>.</li>
<li>Added <code>blanklines</code>, which guarantees a certain number of blank lines (and no more).</li>
</ul></li>
</ul>
<h2 id="bug-fixes-1">Bug fixes</h2>
<ul>
<li><p>Markdown reader:</p>
<ul>
<li>Fixed parsing of indented code in list items. Indented code at the beginning of a list item must be indented eight spaces from the margin (or edge of the container), or four spaces from the list marker, whichever is greater.</li>
<li>Fixed small bug in HTML parsing with <code>markdown_attribute</code>, which caused incorrect tag nesting for input like <code>&lt;aside markdown=&quot;1&quot;&gt;*hi*&lt;/aside&gt;</code>.</li>
<li>Fixed regression with intraword underscores (#1121).</li>
<li>Improved parsing of inline links containing quote characters (#1534).</li>
<li>Slight rewrite of <code>enclosure</code>/<code>emphOrStrong</code> code.</li>
<li>Revamped raw HTML block parsing in markdown (#1330). We no longer include trailing spaces and newlines in the raw blocks. We look for closing tags for elements (but without backtracking). Each block-level tag is its own <code>RawBlock</code>; we no longer try to consolidate them (though <code>--normalize</code> will do so).</li>
<li>Combine consecutive latex environments. This helps when you have two minipages which can’t have blank lines between them (#690, #1196).</li>
<li>Support smallcaps through span. <code>&lt;span style=&quot;font-variant:small-caps;&quot;&gt;foo&lt;/span&gt;</code> will be parsed as a <code>SmallCaps</code> inline, and will work in all output formats that support small caps (#1360).</li>
<li>Prevent spurious line breaks after list items (#1137). When the <code>hard_line_breaks</code> option was specified, pandoc would formerly produce a spurious line break after a tight list item.</li>
<li>Fixed table parsing bug (#1333).</li>
<li>Handle <code>c++</code> and <code>objective-c</code> as language identifiers in github-style fenced blocks (#1318).</li>
<li>Inline math must have nonspace before final <code>$</code> (#1313).</li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Handle comments at the end of tables. This resolves the issue illustrated in <a href="http://stackoverflow.com/questions/24009489" class="uri">http://stackoverflow.com/questions/24009489</a>.</li>
<li>Correctly handle table rows with too few cells. LaTeX seems to treat them as if they have empty cells at the end (#241).</li>
<li>Handle leading/trailing spaces in <code>\emph</code> better. <code>\emph{ hi }</code> gets parsed as <code>[Space, Emph [Str &quot;hi&quot;], Space]</code> so that we don’t get things like <code>* hi *</code> in markdown output. Also applies to <code>\textbf</code> and some other constructions (#1146).</li>
<li>Don’t assume preamble doesn’t contain environments (#1338).</li>
<li>Allow (and discard) optional argument for <code>\caption</code> (James Aspnes).</li>
</ul></li>
<li><p>HTML reader:</p>
<ul>
<li>Fixed major parsing problem with HTML tables. Table cells were being combined into one cell (#1341).</li>
<li>Fixed performance issue with malformed HTML tables. We let a <code>&lt;/table&gt;</code> tag close an open <code>&lt;tr&gt;</code> or <code>&lt;td&gt;</code> (#1167).</li>
<li>Allow space between <code>&lt;col&gt;</code> and <code>&lt;/col&gt;</code>.</li>
<li>Added <code>audio</code> and <code>source</code> in <code>eitherBlockOrInline</code>.</li>
<li>Moved <code>video</code>, <code>svg</code>, <code>progress</code>, <code>script</code>, <code>noscript</code>, <code>svg</code> from <code>blockTags</code> to <code>eitherBlockOrInline</code>.</li>
<li><code>map</code> and <code>object</code> were mistakenly in both lists; they have been removed from <code>blockTags</code>.</li>
<li>Ignore <code>DOCTYPE</code> and <code>xml</code> declarations.</li>
</ul></li>
<li><p>MediaWiki reader:</p>
<ul>
<li>Don’t parse backslash escapes inside <code>&lt;source&gt;</code> (#1445).</li>
<li>Tightened up template parsing. The opening <code>{{</code> must be followed by an alphanumeric or <code>:</code>. This prevents the exponential slowdown in #1033.</li>
<li>Support “Bild” for images.</li>
</ul></li>
<li><p>DocBook reader:</p>
<ul>
<li>Better handle elements inside code environments. Pandoc’s document model does not allow structure inside code blocks, but at least this way we preserve the text (#1449).</li>
<li>Support <code>&lt;?asciidoc-br?&gt;</code> (#1236).</li>
</ul></li>
<li><p>Textile reader:</p>
<ul>
<li>Fixed list parsing. Lists can now start without an intervening blank line (#1513).</li>
<li>HTML block-level tags that do not start a line are parsed as inline HTML and do not interrupt paragraphs (as in RedCloth).</li>
</ul></li>
<li><p>Org reader:</p>
<ul>
<li>Make tildes create inline code (#1345). Also relabeled <code>code</code> and <code>verbatim</code> parsers to accord with the org-mode manual.</li>
<li>Respect <code>:exports</code> header argument in code blocks (Craig Bosma).</li>
<li>Fixed tight lists with sublists (#1437).</li>
</ul></li>
<li><p>EPUB writer:</p>
<ul>
<li>Avoid excess whitespace in <code>nav.xhtml</code>. This should improve TOC view in iBooks (#1392).</li>
<li>Fixed regression on cover image. In 1.12.4 and 1.12.4.2, the cover image would not appear properly, because the metadata id was not correct. Now we derive the id from the actual cover image filename, which we preserve rather than using “cover-image.”</li>
<li>Keep newlines between block elements. This allows easier diff-ability (#1424).</li>
<li>Use <code>stringify</code> instead of custom <code>plainify</code>.</li>
<li>Use <code>renderTags'</code> for all tag rendering. This properly handles tags that should be self-closing. Previously <code>&lt;hr/&gt;</code> would appear in EPUB output as <code>&lt;hr&gt;&lt;/hr&gt;</code> (#1420).</li>
<li>Better handle HTML media tags.</li>
<li>Handle multiple dates with OPF <code>event</code> attributes. Note: in EPUB3 we can have only one dc:date, so only the first one is used.</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Correctly handle figures in notes. Notes can’t contain figures in LaTeX, so we fake it to avoid an error (#1053).</li>
<li>Fixed strikeout + highlighted code (#1294). Previously strikeout highlighted code caused an error.</li>
</ul></li>
<li><p>ConTeXt writer:</p>
<ul>
<li>Improved detection of autolinks with URLs containing escapes.</li>
</ul></li>
<li><p>RTF writer:</p>
<ul>
<li>Improved image embedding: <code>fetchItem'</code> is now used to get the images, and calculated image sizes are indicated in the RTF.</li>
<li>Avoid extra paragraph tags in metadata (#1421).</li>
</ul></li>
<li><p>HTML writer:</p>
<ul>
<li>Deactivate “incremental” inside slide speaker notes (#1394).</li>
<li>Don’t include empty items in the table of contents for slide shows. (These would result from creating a slide using a horizontal rule.)</li>
</ul></li>
<li><p>MediaWiki writer:</p>
<ul>
<li>Minor renaming of <code>st</code> prefixed names.</li>
</ul></li>
<li><p>AsciiDoc writer:</p>
<ul>
<li>Double up emphasis and strong emphasis markers in intraword contexts, as required by asciidoc (#1441).</li>
</ul></li>
<li><p>Markdown writer:</p>
<ul>
<li>Avoid wrapping that might start a list, blockquote, or header (#1013).</li>
<li>Use Span instead of (hackish) <code>SmallCaps</code> in <code>plainify</code>.</li>
<li>Don’t use braced attributes for fenced code (#1416). If <code>Ext_fenced_code_attributes</code> is not set, the first class attribute will be printed after the opening fence as a bare word.</li>
<li>Separate adjacent lists of the same kind with an HTML comment (#1458).</li>
</ul></li>
<li><p>PDF writer:</p>
<ul>
<li>Fixed treatment of data uris for images (#1062).</li>
</ul></li>
<li><p>Docx writer:</p>
<ul>
<li>Use Compact style for empty table cells (#1353). Otherwise we get overly tall lines when there are empty table cells and the other cells are compact.</li>
<li>Create overrides per-image for <code>media/</code> in reference docx. This should be somewhat more robust and cover more types of images.</li>
<li>Improved <code>entryFromArchive</code> to avoid an unneeded parse.</li>
<li>Section numbering carries over from reference.docx (#1305).</li>
<li>Simplified <code>abstractNumId</code> numbering. Instead of sequential numbering, we assign numbers based on the list marker styles.</li>
</ul></li>
<li><p><code>Text.Pandoc.Options</code>:</p>
<ul>
<li>Removed <code>Ext_fenced_code_attributes</code> from <code>markdown_github</code> extensions.</li>
</ul></li>
<li><p><code>Text.Pandoc.ImageSize</code>:</p>
<ul>
<li>Use default instead of failing if image size not found in exif header (#1358).</li>
<li>ignore unknown exif header tag rather than crashing. Some images seem to have tag type of 256, which was causing a runtime error.</li>
</ul></li>
<li><p><code>Text.Pandoc.Shared</code>:</p>
<ul>
<li><code>fetchItem</code>: unescape URI encoding before reading local file (#1427).</li>
<li><code>fetchItem</code>: strip a fragment like <code>?#iefix</code> from the extension before doing mime lookup, to improve mime type guessing.</li>
<li>Improved logic of <code>fetchItem</code>: absolute URIs are fetched from the net; other things are treated as relative URIs if <code>sourceURL</code> is <code>Just _</code>, otherwise as file paths on the local file system.</li>
<li><code>fetchItem</code> now properly handles links without a protocol (#1477).</li>
<li><code>fetchItem</code> now escapes characters not allowed in URIs before trying to parse the URIs.</li>
<li>Fixed runtime error with <code>compactify'DL</code> on certain lists (#1452).</li>
</ul></li>
<li><p><code>pandoc.hs</code>: Don’t strip path off of <code>writerSourceURL</code>: the path is needed to resolve relative URLs when we fetch resources (#750).</p></li>
<li><p><code>Text.Pandoc.Parsing</code></p>
<ul>
<li>Simplified <code>dash</code> and <code>ellipsis</code> (#1419).</li>
<li>Removed <code>(&gt;&gt;~)</code> in favor of the equivalent <code>(&lt;*)</code> (Matthew Pickering).</li>
<li>Generalized functions to use <code>ParsecT</code> (Matthew Pickering).</li>
<li>Added <code>isbn</code> and <code>pmid</code> to list of recognized schemes (Matthew Pickering).</li>
</ul></li>
</ul>
<h2 id="template-changes-1">Template changes</h2>
<ul>
<li>Added haddock template.</li>
<li>EPUB3: Added <code>type</code> attribute to <code>link</code> tags. They are supposed to be “advisory” in HTML5, but kindlegen seems to require them.</li>
<li>EPUB3: Put title page in section with <code>epub:type=&quot;titlepage&quot;</code>.</li>
<li>LaTeX: Made <code>\subtitle</code> work properly (#1327).</li>
<li>LaTeX/Beamer: remove conditional around date (#1321).</li>
<li>LaTeX: Added <code>lot</code> and <code>lof</code> variables, which can be set to get <code>\listoftables</code> and <code>\listoffigures</code> (#1407). Note that these variables can be set at the command line with <code>-Vlot -Vlof</code> or in YAML metadata.</li>
</ul>
<h2 id="under-the-hood-improvements-1">Under the hood improvements</h2>
<ul>
<li><p>Rewrote normalize for efficiency (#1385).</p></li>
<li><p>Rewrote Haddock reader to use <code>haddock-library</code> (#1346).</p>
<ul>
<li>This brings pandoc’s rendering of haddock markup in line with the new haddock.</li>
<li>Fixed line breaks in <code>@</code> code blocks.</li>
<li>alex and happy are no longer build-depends.</li>
</ul></li>
<li><p>Added <code>Text.Pandoc.Compat.Directory</code> to allow building against different versions of the <code>directory</code> library.</p></li>
<li><p>Added <code>Text.Pandoc.Compat.Except</code> to allow building against different verions of <code>mtl</code>.</p></li>
<li><p>Code cleanup in some writers, using Reader monad to avoid passing options parameter around (Matej Kollar).</p></li>
<li><p>Improved readability in <code>pandoc.hs</code>.</p></li>
<li><p>Miscellaneous code cleanups (Artyom Kazak).</p></li>
<li><p>Avoid <code>import Prelude hiding (catch)</code> (#1309, thanks to Michael Thompson).</p></li>
<li><p>Changed <code>http-conduit</code> flag to <code>https</code>. Depend on <code>http-client</code> and <code>http-client-tls</code> instead of <code>http-conduit</code>. (Note: pandoc still depends on <code>conduit</code> via <code>yaml</code>.)</p></li>
<li><p>Require <code>highlighting-kate &gt;= 0.5.8.5</code> (#1271, #1317, Debian #753299). This change to highlighting-kate means that PHP fragments no longer need to start with <code>&lt;?php</code>. It also fixes a serious bug causing failures with ocaml and fsharp.</p></li>
<li><p>Require latest <code>texmath</code>. This fixes <code>\tilde{E}</code> and allows <code>\left</code> to be used with <code>]</code>, <code>)</code> etc. (#1319), among many other improvements.</p></li>
<li><p>Require latest <code>zip-archive</code>. This has fixes for unicode path names.</p></li>
<li><p>Added tests for plain writer.</p></li>
<li><p><code>Text.Pandoc.Templates</code>:</p>
<ul>
<li>Fail informatively on template syntax errors. With the move from parsec to attoparsec, we lost good error reporting. In fact, since we weren’t testing for end of input, malformed templates would fail silently. Here we revert back to Parsec for better error messages.</li>
<li>Use <code>ordNub</code> (#1022).</li>
</ul></li>
<li><p>Benchmarks:</p>
<ul>
<li>Made benchmarks compile again (Artyom Kazak).</li>
<li>Fixed so that the failure of one benchmark does not prevent others from running (Artyom Kazak).</li>
<li>Use <code>nfIO</code> instead of the <code>getLength</code> trick to force full evaluation.</li>
<li>Changed benchmark to use only the test suite, so that benchmarks run more quickly.</li>
</ul></li>
<li><p>Windows build script:</p>
<ul>
<li>Add <code>-windows</code> to file name.</li>
<li>Use one install command for pandoc, pandoc-citeproc.</li>
<li>Force install of pandoc-citeproc.</li>
</ul></li>
<li><p><code>make_osx_package</code>: Call zip file <code>pandoc-VERSION-osx.zip</code>. The zip should not be named <code>SOMETHING.pkg.zip</code>, or OSX finder will extract it into a folder named <code>SOMETHING.pkg</code>, which it will interpret as a defective package (#1308).</p></li>
<li><p><code>README</code>:</p>
<ul>
<li>Made headers for all extensions so they have IDs and can be linked to (Beni Cherniavsky-Paskin).</li>
<li>Fixed typos (Phillip Alday).</li>
<li>Fixed documentation of attributes (#1315).</li>
<li>Clarified documentation on small caps (#1360).</li>
<li>Better documentation for <code>fenced_code_attributes</code> extension (Caleb McDaniel).</li>
<li>Documented fact that you can put YAML metadata in a separate file (#1412).</li>
</ul></li>
</ul>
<h1 id="pandoc-1.12.4.2-14-may-2014">pandoc 1.12.4.2 (14 May 2014)</h1>
<ul>
<li><p>Require highlighting-kate &gt;= 0.5.8. Fixes a performance regression.</p></li>
<li><p>Shared: <code>addMetaValue</code> now behaves slightly differently: if both the new and old values are lists, it concatenates their contents to form a new list.</p></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Set <code>bibliography</code> in metadata from <code>\bibliography</code> or <code>\addbibresource</code> command.</li>
<li>Don’t error on <code>%foo</code> with no trailing newline.</li>
</ul></li>
<li><p>Org reader:</p>
<ul>
<li>Support code block headers (<code>#+BEGIN_SRC ...</code>) (Albert Krewinkel).</li>
<li>Fix parsing of blank lines within blocks (Albert Krewinkel).</li>
<li>Support pandoc citation extension (Albert Krewinkel). This can be turned off by specifying <code>org-citation</code> as the input format.</li>
</ul></li>
<li><p>Markdown reader:</p>
<ul>
<li><code>citeKey</code> moved to <code>Text.Pandoc.Parsing</code> so it can be used by other readers (Albert Krewinkel).</li>
</ul></li>
<li><p><code>Text.Pandoc.Parsing</code>:</p>
<ul>
<li>Added <code>citeKey</code> (see above).</li>
<li>Added <code>HasLastStrPosition</code> type class and <code>updateLastStrPos</code> and <code>notAfterString</code> functions.</li>
</ul></li>
<li><p>Updated copyright notices (Albert Krewinkel).</p></li>
<li><p>Added default.icml to data files so it installs with the package.</p></li>
<li><p>OSX package:</p>
<ul>
<li>The binary is now built with options to ensure that it can be used with OSX 10.6+.</li>
<li>Moved OSX package materials to osx directory.</li>
<li>Added OSX package uninstall script, included in the zip container (thanks to Daniel T. Staal).</li>
</ul></li>
</ul>
<h1 id="pandoc-1.12.4-07-may-2014">pandoc 1.12.4 (07 May 2014)</h1>
<ul>
<li><p>Made it possible to run filters that aren’t executable (#1096). Pandoc first tries to find the executable (searching the path if path isn’t given). If it fails, but the file exists and has a <code>.py</code>, <code>.pl</code>, <code>.rb</code>, <code>.hs</code>, or <code>.php</code> extension, pandoc runs the filter using the appropriate interpreter. This should make it easier to use filters on Windows, and make it more convenient for everyone.</p></li>
<li><p>Added Emacs org-mode reader (Albert Krewinkel).</p></li>
<li><p>Added InDesign ICML Writer (mb21).</p></li>
<li><p>MediaWiki reader:</p>
<ul>
<li>Accept image links in more languages (Jaime Marquínez Ferrándiz).</li>
<li>Fixed bug in certain nested lists (#1213). If a level 2 list was followed by a level 1 list, the first item of the level 1 list would be lost.</li>
<li>Handle table rows containing just an HTML comment (#1230).</li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Give better location information on errors, pointing to line numbers within included files (#1274).</li>
<li>LaTeX reader: Better handling of <code>table</code> environment (#1204). Positioning options no longer rendered verbatim.</li>
<li>Better handling of figure and table with caption (#1204).</li>
<li>Handle <code>@{}</code> and <code>p{length}</code> in tabular. The length is not actually recorded, but at least we get a table (#1180).</li>
<li>Properly handle <code>\nocite</code>. It now adds a <code>nocite</code> metadata field. Citations there will appear in the bibliography but not in the text (unless you explicitly put a <code>$nocite$</code> variable in your template).</li>
</ul></li>
<li><p>Markdown reader:</p>
<ul>
<li>Ensure that whole numbers in YAML metadata are rendered without decimal points. (This became necessary with changes to aeson and yaml libraries. aeson &gt;= 0.7 and yaml &gt;= 0.8.8.2 are now required.)</li>
<li>Fixed regression on line breaks in strict mode (#1203).</li>
<li>Small efficiency improvements.</li>
<li>Improved parsing of nested <code>div</code>s. Formerly a closing <code>div</code> tag would be missed if it came right after other block-level tags.</li>
<li>Avoid backtracking when closing <code>&lt;/div&gt;</code> not found.</li>
<li>Fixed bug in reference link parsing in <code>markdown_mmd</code>.</li>
<li>Fixed a bug in list parsing (#1154). When reading a raw list item, we now strip off up to 4 spaces.</li>
<li>Fixed parsing of empty reference link definitions (#1186).</li>
<li>Made one-column pipe tables work (#1218).</li>
</ul></li>
<li><p>Textile reader:</p>
<ul>
<li>Better support for attributes. Instead of being ignored, attributes are now parsed and included in Span inlines. The output will be a bit different from stock textile: e.g. for <code>*(foo)hi*</code>, we’ll get <code>&lt;em&gt;&lt;span class=&quot;foo&quot;&gt;hi&lt;/span&gt;&lt;/em&gt;</code> instead of <code>&lt;em class=&quot;foo&quot;&gt;hi&lt;/em&gt;</code>. But at least the data is not lost.</li>
<li>Improved treatment of HTML spans (%) (#1115).</li>
<li>Improved link parsing. In particular we now pick up on attributes. Since pandoc links can’t have attributes, we enclose the whole link in a span if there are attributes (#1008).</li>
<li>Implemented correct parsing rules for inline markup (#1175, Matthew Pickering).</li>
<li>Use Builder (Matthew Pickering).</li>
</ul></li>
<li><p>DocBook reader:</p>
<ul>
<li>Better treatment of <code>formalpara</code>. We now emit the title (if present) as a separate paragraph with boldface text (#1215).</li>
<li>Set metadata <code>author</code> not <code>authors</code>.</li>
<li>Added recognition of <code>authorgroup</code> and <code>releaseinfo</code> elements (#1214, Matthew Pickering).</li>
<li>Converted current meta information parsing in DocBook to a more extensible version which is aware of the more recent meta representation (Matthew Pickering).</li>
</ul></li>
<li><p>HTML reader:</p>
<ul>
<li>Require tagsoup 0.13.1, to fix a bug with parsing of script tags (#1248).</li>
<li>Treat processing instructions &amp; declarations as block. Previously these were treated as inline, and included in paragraph tags in HTML or DocBook output, which is generally not what is wanted (#1233).</li>
<li>Updated <code>closes</code> with rules from HTML5 spec.</li>
<li>Use Builder (Matthew Pickering, #1162).</li>
</ul></li>
<li><p>RST reader:</p>
<ul>
<li>Remove duplicate <code>http</code> in PEP links (Albert Krewinkel).</li>
<li>Make rst figures true figures (#1168, CasperVector)</li>
<li>Enhanced Pandoc’s support for rST roles (Merijn Verstaaten). rST parser now supports: all built-in rST roles, new role definition, role inheritance, though with some limitations.</li>
<li>Use <code>author</code> rather than <code>authors</code> in metadata.</li>
<li>Better handling of directives. We now correctly handle field lists that are indented more than three spaces. We treat an <code>aafig</code> directive as a code block with attributes, so it can be processed in a filter (#1212).</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Mark span contents with label if span has an ID (Albert Krewinkel).</li>
<li>Made <code>--toc-depth</code> work well with books in latex/pdf output (#1210).</li>
<li>Handle line breaks in simple table cells (#1217).</li>
<li>Workaround for level 4-5 headers in quotes. These previously produced invalid LaTeX: <code>\paragraph</code> or <code>\subparagraph</code> in a <code>quote</code> environment. This adds an <code>mbox{}</code> in these contexts to work around the problem. See <a href="http://tex.stackexchange.com/a/169833/22451" class="uri">http://tex.stackexchange.com/a/169833/22451</a> (#1221).</li>
<li>Use <code>\/</code> to avoid en-dash ligature instead of <code>-{}-</code> (Vaclav Zeman). This is to fix LuaLaTeX output. The <code>-{}-</code> sequence does not avoid the ligature with LuaLaTeX but <code>\/</code> does.</li>
<li>Fixed string escaping in <code>hyperref</code> and <code>hyperdef</code> (#1130).</li>
</ul></li>
<li><p>ConTeXt writer: Improved autolinks (#1270).</p></li>
<li><p>DocBook writer:</p>
<ul>
<li>Improve handling of hard line breaks in Docbook writer (Neil Mayhew). Use a <code>&lt;literallayout&gt;</code> for the entire paragraph, not just for the newline character.</li>
<li>Don’t let line breaks inside footnotes influence the enclosing paragraph (Neil Mayhew).</li>
<li>Distinguish tight and loose lists in DocBook output, using <code>spacing=&quot;compact&quot;</code> (Neil Mayhew, #1250).</li>
</ul></li>
<li><p>Docx writer: When needed files are not present in the user’s <code>reference.docx</code>, fall back on the versions in the <code>reference.docx</code> in pandoc’s data files. This fixes a bug that occurs when a <code>reference.docx</code> saved by LibreOffice is used. (#1185)</p></li>
<li><p>EPUB writer:</p>
<ul>
<li>Include extension in epub ids. This fixes a problem with duplicate extensions for fonts and images with the same base name but different extensions (#1254).</li>
<li>Handle files linked in raw <code>img</code> tags (#1170).</li>
<li>Handle media in <code>audio</code> source tags (#1170). Note that we now use a <code>media</code> directory rather than <code>images</code>.</li>
<li>Incorporate files linked in <code>video</code> tags (#1170). <code>src</code> and <code>poster</code> will both be incorporated into <code>content.opf</code> and the epub container.</li>
</ul></li>
<li><p>HTML writer:</p>
<ul>
<li>Add colgroup around col tags (#877). Also affects EPUB writer.</li>
<li>Fixed bug with unnumbered section headings. Unnumbered section headings (with class <code>unnumbered</code>) were getting numbers.</li>
<li>Improved detection of image links. Previously image links with queries were not recognized, causing <code>&lt;embed&gt;</code> to be used instead of <code>&lt;img&gt;</code>.</li>
</ul></li>
<li><p>Man writer: Ensure that terms in definition lists aren’t line wrapped (#1195).</p></li>
<li><p>Markdown writer:</p>
<ul>
<li>Use proper escapes to avoid unwanted lists (#980). Previously we used 0-width spaces, an ugly hack.</li>
<li>Use longer backtick fences if needed (#1206). If the content contains a backtick fence and there are attributes, make sure longer fences are used to delimit the code. Note: This works well in pandoc, but github markdown is more limited, and will interpret the first string of three or more backticks as ending the code block.</li>
</ul></li>
<li><p>RST writer: Avoid stack overflow with certain tables (#1197).</p></li>
<li><p>RTF writer: Fixed table cells containing paragraphs.</p></li>
<li><p>Custom writer:</p>
<ul>
<li>Correctly handle UTF-8 in custom lua scripts (#1189).</li>
<li>Fix bugs with lua scripts with mixed-case filenames and paths containing <code>+</code> or <code>-</code> (#1267). Note that <code>getWriter</code> in <code>Text.Pandoc</code> no longer returns a custom writer on input <code>foo.lua</code>.</li>
</ul></li>
<li><p>AsciiDoc writer: Handle multiblock and empty table cells (#1245, #1246). Added tests.</p></li>
<li><p><code>Text.Pandoc.Options</code>: Added <code>readerTrace</code> to <code>ReaderOptions</code></p></li>
<li><p><code>Text.Pandoc.Shared</code>:</p>
<ul>
<li>Added <code>compactify'DL</code> (formerly in markdown reader) (Albert Krewinkel).</li>
<li>Fixed bug in <code>toRomanNumeral</code>: numbers ending with ‘9’ would be rendered as Roman numerals ending with ‘IXIV’ (#1249). Thanks to Jesse Rosenthal.</li>
<li><code>openURL</code>: set proxy with value of http_proxy env variable (#1211). Note: proxies with non-root paths are not supported, due to limitations in <code>http-conduit</code>.</li>
</ul></li>
<li><p><code>Text.Pandoc.PDF</code>:</p>
<ul>
<li>Ensure that temp directories deleted on Windows (#1192). The PDF is now read as a strict bytestring, ensuring that process ownership will be terminated, so the temp directory can be deleted.</li>
<li>Use <code>/</code> as path separators in a few places, even on Windows. This seems to be necessary for texlive (#1151, thanks to Tim Lin).</li>
<li>Use <code>;</code> for <code>TEXINPUTS</code> separator on Windows (#1151).</li>
<li>Changes to error reporting, to handle non-UTF8 error output.</li>
</ul></li>
<li><p><code>Text.Pandoc.Templates</code>:</p>
<ul>
<li><p>Removed unneeded datatype context (Merijn Verstraaten).</p></li>
<li><p>YAML objects resolve to “true” in conditionals (#1133). Note: If <code>address</code> is a YAML object and you just have <code>$address$</code> in your template, the word <code>true</code> will appear, which may be unexpected. (Previously nothing would appear.)</p></li>
</ul></li>
<li><p><code>Text.Pandoc.SelfContained</code>: Handle <code>poster</code> attribute in <code>video</code> tags (#1188).</p></li>
<li><p><code>Text.Pandoc.Parsing</code>:</p>
<ul>
<li>Made <code>F</code> an instance of Applicative (#1138).</li>
<li>Added <code>stateCaption</code>.</li>
<li>Added <code>HasMacros</code>, simplified other typeclasses. Removed <code>updateHeaderMap</code>, <code>setHeaderMap</code>, <code>getHeaderMap</code>, <code>updateIdentifierList</code>, <code>setIdentifierList</code>, <code>getIdentifierList</code>.</li>
<li>Changed the smart punctuation parser to return <code>Inlines</code> rather than <code>Inline</code> (Matthew Pickering).</li>
<li>Changed <code>HasReaderOptions</code>, <code>HasHeaderMap</code>, <code>HasIdentifierList</code> from typeclasses of monads to typeclasses of states. This simplifies the instance definitions and provides more flexibility. Generalized type of <code>getOption</code> and added a default definition. Removed <code>askReaderOption</code>. Added <code>extractReaderOption</code>. Added <code>extractHeaderMap</code> and <code>updateHeaderMap</code> in <code>HasHeaderMap</code>. Gave default definitions for <code>getHeaderMap</code>, <code>putHeaderMap</code>, <code>modifyHeaderMap</code>. Added <code>extractIdentifierList</code> and <code>updateIdentifierList</code> in <code>HasIdentifierList</code>. Gave defaults for <code>getIdentifierList</code>, <code>putIdentifierList</code>, and <code>modifyIdentifierList</code>. The ultimate goal here is to allow different parsers to use their own, tailored parser states (instead of <code>ParserState</code>) while still using shared functions.</li>
</ul></li>
<li><p>Template changes:</p>
<ul>
<li>LaTeX template: Use <code>fontenc</code> package only with <code>pdflatex</code> (#1164).</li>
<li>LaTeX template: Add <code>linestretch</code> and <code>fontfamily</code> variables.</li>
<li>LaTeX template: Conditionalize author and date commands.</li>
<li>Beamer template: Consistent styles for figure and table captions (aaronwolen).</li>
<li>LaTeX and beamer template: Adjust widths correctly for oversized images. Use <code>\setkeys{Gin}{}</code> to set appropriate defaults for <code>\includegraphics</code> (Yihui Xie, Garrick Aden-Buie). Load <code>upquote</code> only after <code>fontenc</code> (Yihui Xie).</li>
<li>Beamer template: Added caption package (#1200).</li>
<li>Beamer template: changes for better unicode handling (KarolS).</li>
<li>DocBook template: use <code>authorgroup</code> if there are authors.</li>
<li>revealjs template: Move <code>include-after</code> to end (certainlyakey).</li>
<li>revealjs template: Fixed PDF print function (#1220, kevinkenan).</li>
</ul></li>
<li><p>Bumped version bounds of dependencies.</p></li>
<li><p>Added a <code>--trace</code> command line option, for debugging backtracking bugs. So far this only works with the markdown reader.</p></li>
<li><p>MathMLinHTML: Fixed deprecation warning (#362, gwern, Albert Krewinkel).</p></li>
<li><p>Updated travis script to test with multiple GHC versions.</p></li>
<li><p>Force failure of a Travis build if GHC produces warnings (Albert Krewinkel).</p></li>
<li><p>Add <code>.editorconfig</code> (Albert Krewinkel). See <a href="http://editorconfig.org/" class="uri">http://editorconfig.org/</a> for details.</p></li>
<li><p>Give more useful error message if ‘-t pdf’ is specified (#1155).</p></li>
<li><p>Added <code>Cite</code>, <code>SmallCaps</code> to <code>Arbitrary</code> instance (#1269).</p></li>
<li><p>Allow <code>html4</code> as a synonym of <code>html</code> as a reader (it already works as a writer).</p></li>
<li><p>README:</p>
<ul>
<li>Added an explanation of how to use YAML metadata to force items to appear in the bibliography without citations in the text (like LaTeX <code>\nocite</code>).</li>
<li>Added note to <code>--bibtex/--natbib</code>: not for use in making PDF (#1194, thanks to nahoj).</li>
<li>Added explanatory notes about <code>--natbib</code> and <code>--biblatex</code>.</li>
<li>Added specification of legal syntax for citation keys.</li>
<li>Fixed variable defaults documentation (Albert Krewinkel).</li>
</ul></li>
<li><p>Removed copyright statements for files that have been removed (Albert Krewinkel).</p></li>
<li><p>Moved some doc files from <code>data-files</code> to <code>extra-source-files</code> (#1123). They aren’t needed at runtime. We keep README and COPYRIGHT in data to ensure that they’ll be available on all systems on which pandoc is installed.</p></li>
<li><p>Use cabal sandboxes in Windows build script.</p></li>
</ul>
<h1 id="pandoc-1.12.3.3-03-feb-2014">pandoc 1.12.3.3 (03 Feb 2014)</h1>
<ul>
<li>To changes to source; recompiled tarball with latest alex and happy, so they will work with GHC 7.8.</li>
</ul>
<h1 id="pandoc-1.12.3.2-03-feb-2014">pandoc 1.12.3.2 (03 Feb 2014)</h1>
<ul>
<li><p>Bumped version bounds for blaze-html, blaze-markup.</p></li>
<li><p>ImageSize: Avoid use of lookAhead, which is not in binary &gt;= 0.6 (#1124).</p></li>
<li><p>Fixed mediawiki ordered list parsing (#1122).</p></li>
<li><p>HTML reader: Fixed bug reading inline math with <code>$$</code> (#225).</p></li>
<li><p>Added support for LaTeX style literate Haskell code blocks in rST (Merijn Verstraaten).</p></li>
</ul>
<h1 id="pandoc-1.12.3.1-14-jan-2014">pandoc 1.12.3.1 (14 Jan 2014)</h1>
<ul>
<li>Relaxed version constraint on binary, allowing the use of binary 0.5.</li>
</ul>
<h1 id="pandoc-1.12.3-10-jan-2014">pandoc 1.12.3 (10 Jan 2014)</h1>
<ul>
<li><p>The <code>--bibliography</code> option now sets the <code>biblio-files</code> variable. So, if you’re using <code>--natbib</code> or <code>--biblatex</code>, you can just use <code>--bibliography=foo.bib</code> instead of <code>-V bibliofiles=foo</code>.</p></li>
<li><p>Don’t run pandoc-citeproc filter if <code>--bibliography</code> is used together with <code>--natbib</code> or <code>--biblatex</code> (Florian Eitel).</p></li>
<li><p>Template changes:</p>
<ul>
<li>Updated beamer template to include booktabs.</li>
<li>Added <code>abstract</code> variable to LaTeX template.</li>
<li>Put <code>header-includes</code> after <code>title</code> in LaTeX template (#908).</li>
<li>Allow use of <code>\includegraphics[size]</code> in beamer. This just required porting a macro definition from the default LaTeX template to the default beamer template.</li>
</ul></li>
<li><p><code>reference.docx</code>: Include <code>FootnoteText</code> style. Otherwise Word ignores the style, even when specified in the <code>pPr</code>. (#901)</p></li>
<li><p><code>reference.odt</code>: Tidied <code>styles.xml</code>.</p></li>
<li><p>Relaxed version bounds for dependencies.</p></li>
<li><p>Added <code>withSocketsDo</code> around http conduit code in <code>openURL</code>, so it works on Windows (#1080).</p></li>
<li><p>Added <code>Cite</code> function to <code>sample.lua</code>.</p></li>
<li><p>Markdown reader:</p>
<ul>
<li>Fixed regression in title blocks (#1089). If author field was empty, date was being ignored.</li>
<li>Allow backslash-newline hard line breaks in grid and multiline table cells.</li>
<li>Citation keys may now start with underscores, and may contain underscores adjacent to internal punctuation.</li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Add support for <code>Verb</code> macro (jrnold) (#1090).</li>
<li>Support babel-style quoting: <code>&quot;`...&quot;'</code>.</li>
</ul></li>
<li><p>Properly handle script blocks in strict mode. (That is, <code>markdown-markdown_in_html_blocks</code>.) Previously a spurious <code>&lt;p&gt;</code> tag was being added (#1093).</p></li>
<li><p>Docbook reader: Avoid failure if <code>tbody</code> contains no <code>tr</code> or <code>row</code> elements.</p></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Factored out function for table cell creation.</li>
<li>Better treatment of footnotes in tables. Notes now appear in the regular sequence, rather than in the table cell. (This was a regression in 1.10.)</li>
</ul></li>
<li><p>HTML reader: Parse name/content pairs from meta tags as metadata. Closes #1106.</p></li>
<li><p>Moved <code>fixDisplayMath</code> from Docx writer to <code>Writer.Shared</code>.</p></li>
<li><p>OpenDocument writer: Fixed <code>RawInline</code>, <code>RawBlock</code> so they don’t escape.</p></li>
<li><p>ODT writer: Use mathml for proper rendering of formulas. Note: LibreOffice’s support for this seems a bit buggy. But it should be better than what we had before.</p></li>
<li><p>RST writer: Ensure no blank line after def in definition list (#992).</p></li>
<li><p>Markdown writer: Don’t use tilde code blocks with braced attributes in <code>markdown_github</code> output. A consequence of this change is that the backtick form will be preferred in general if both are enabled. That is good, as it is much more widespread than the tilde form. (#1084)</p></li>
<li><p>Docx writer: Fixed problem with some modified reference docx files. Include <code>word/_rels/settings.xml.rels</code> if it exists, as well as other <code>rels</code> files besides the ones pandoc generates explicitly.</p></li>
<li><p>HTML writer:</p>
<ul>
<li>With <code>--toc</code>, headers no longer link to themselves (#1081).</li>
<li>Omit footnotes from TOC entries. Otherwise we get doubled footnotes when headers have notes!</li>
</ul></li>
<li><p>EPUB writer:</p>
<ul>
<li>Avoid duplicate notes when headings contain notes. This arose because the headings are copied into the metadata “title” field, and the note gets rendered twice. We strip the note now before putting the heading in “title”.</li>
<li>Strip out footnotes from toc entries.</li>
<li>Fixed bug with <code>--epub-stylesheet</code>. Now the contents of <code>writerEpubStylesheet</code> (set by <code>--epub-stylesheet</code>) should again work, and take precedence over a stylesheet specified in the metadata.</li>
</ul></li>
<li><p><code>Text.Pandoc.Pretty</code>: Added <code>nestle</code>. API change.</p></li>
<li><p><code>Text.Pandoc.MIME</code>: Added <code>wmf</code>, <code>emf</code>.</p></li>
<li><p><code>Text.Pandoc.Shared</code>: <code>fetchItem</code> now handles image URLs beginning with <code>//</code>.</p></li>
<li><p><code>Text.Pandoc.ImageSize</code>: Parse EXIF format JPEGs. Previously we could only get size information for JFIF format, which led to squished images in Word documents. Closes #976.</p></li>
<li><p>Removed old <code>MarkdownTest_1.0.3</code> directory (#1104).</p></li>
</ul>
<h1 id="pandoc-1.12.2.1-2013-12-08">pandoc 1.12.2.1 (2013-12-08)</h1>
<ul>
<li>Markdown reader: Fixed regression in list parser, involving continuation lines containing raw HTML (or even verbatim raw HTML).</li>
</ul>
<h1 id="pandoc-1.12.2-2013-12-07">pandoc 1.12.2 (2013-12-07)</h1>
<ul>
<li><p>Metadata may now be included in YAML blocks in a markdown document. For example,</p>
<pre><code>---
title:
- type: main
  text: My Book
- type: subtitle
  text: An investigation of metadata
creator:
- role: author
  text: John Smith
- role: editor
  text: Sarah Jones
identifier:
- scheme: DOI
  text: doi:10.234234.234/33
publisher:  My Press
rights:  (c) 2007 John Smith, CC BY-NC
cover-image: img/mypic.jpg
stylesheet: style.css
...</code></pre>
<p>Metadata may still be provided using <code>--epub-metadata</code>; it will be merged with the metadata in YAML blocks.</p></li>
<li><p>EPUB writer:</p>
<ul>
<li><code>meta</code> tags are now used instead of <code>opf</code> attributes for EPUB3.</li>
<li>Insert “svg” property as needed in opf (EPUB 3).</li>
<li>Simplify <code>imageTypeOf</code> using <code>getMimeType</code>.</li>
<li>Add properties attribute to <code>cover-image</code> item for EPUB 3.</li>
<li>Don’t include node for <code>cover.xhtml</code> if no cover!</li>
<li>Ensure that same identifier is used throughout (#1044). If an identifier is given in metadata, we use that; otherwise we generate a random uuid.</li>
<li>Add cover reference to guide element (EPUB 2) (Shaun Attfield). Fixes an issue with Calibre putting the cover at the end of the book if the spine has <code>linear=&quot;no&quot;</code>. Apparently this is best practice for other converters as well: <a href="http://www.idpf.org/epub/20/spec/OPF_2.0.1_draft.htm#Section2.6" class="uri">http://www.idpf.org/epub/20/spec/OPF_2.0.1_draft.htm#Section2.6</a>.</li>
<li>Allow <code>stylesheet</code> in metadata. The value is a path to the stylesheet.</li>
<li>Allow partial dates: <code>YYYY</code>, <code>YYYY-MM</code>.</li>
</ul></li>
<li><p>Markdown writer: Fix rendering of tight sublists (#1050). Previously a spurious blank line was included after a tight sublist.</p></li>
<li><p>ODT writer: Add <code>draw:name</code> attribute to <code>draw:frame</code> elements (#1069). This is reported to be necessary to avoid an error from recent versions of Libre Office when files contain more than one image Thanks to wmanley for reporting and diagnosing the problem.</p></li>
<li><p>ConTeXt writer: Don’t hardcode figure/table placement and numbering. Instead, let this be set in the template, using <code>\setupfloat</code>. Thanks to on4aa and Aditya Mahajan for the suggestion (#1067).</p></li>
<li><p>Implemented CSL flipflopping spans in DOCX, LaTeX, and HTML writers.</p></li>
<li><p>Fixed bug with markdown intraword emphasis. Closes #1066.</p></li>
<li><p>Docbook writer: Hierarchicalize block content in metadata. Previously headers just disappeared from block-level metadata when it was used in templates. Now we apply the ‘hierarchicalize’ transformation. Note that a block headed by a level-2 header will turn into a <code>&lt;sect1&gt;</code> element.</p></li>
<li><p>OpenDocument writer: Skip raw HTML (#1035). Previously it was erroneously included as verbatim text.</p></li>
<li><p>HTML/EPUB writer, footnotes: Put <code>&lt;sup&gt;</code> tag inside <code>&lt;a&gt;</code> tags. This allows better control of formatting, since the <code>&lt;a&gt;</code> tags have a distinguishing class (#1049).</p></li>
<li><p>Docx writer:</p>
<ul>
<li>Use mime type info returned by fetchItem.</li>
<li>Fixed core metadata (#1046). Don’t create empty date nodes if no date given. Don’t create multiple <code>dc:creator</code> nodes; instead separate by semicolons.</li>
<li>Fix URL for core-properties in <code>_rels/.rels</code> (#1046).</li>
</ul></li>
<li><p>Plain writer: don’t print <code>&lt;span&gt;</code> tags.</p></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Fix definition lists with internal links in terms (#1032). This fix puts braces around a term that contains an internal link, to avoid problems with square brackets.</li>
<li>Properly escape pdftitle, pdfauthor (#1059).</li>
<li>Use booktabs package for tables (thanks to Jose Luis Duran).</li>
</ul></li>
<li><p>Updated beamer template. Now references should work properly (in a slide) when <code>--biblatex</code> or <code>--natbib</code> is used.</p></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Parse contents of curly quotes or matched <code>&quot;</code> as quotes.</li>
<li>Support <code>\textnormal</code> as span with class <code>nodecor</code>. This is needed for pandoc-citeproc.</li>
<li>Improved citation parsing. This fixes a run-time error that occured with <code>\citet{}</code> (empty list of keys). It also ensures that empty keys don’t get produced.</li>
</ul></li>
<li><p>MediaWiki reader: Add automatic header identifiers.</p></li>
<li><p>HTML reader:</p>
<ul>
<li>Use pandoc <code>Div</code> and <code>Span</code> for raw <code>&lt;div&gt;</code>, <code>&lt;span&gt;</code> when <code>--parse-raw</code>.</li>
<li>Recognize <code>svg</code> tags as block level content (thanks to MinRK).</li>
<li>Parse LaTeX math if appropriate options are set.</li>
</ul></li>
<li><p>Markdown reader:</p>
<ul>
<li>Yaml block must start immediately after <code>---</code>. If there’s a blank line after <code>---</code>, we interpreted it as a horizontal rule.</li>
<li>Correctly handle empty bullet list items.</li>
<li>Stop parsing “list lines” when we hit a block tag. This fixes exponential slowdown in certain input, e.g. a series of lists followed by <code>&lt;/div&gt;</code>.</li>
</ul></li>
<li><p>Slides: Preserve <code>&lt;div class=&quot;references&quot;&gt;</code> in references slide.</p></li>
<li><p><code>Text.Pandoc.Writer.Shared</code>:</p>
<ul>
<li>Fixed bug in <code>tagWithAttrs</code>. A space was omitted before key-value attributes, leading to invalid HTML.</li>
<li><code>normalizeDate</code>: Allow dates with year only (thanks to Shaun Attfield).</li>
<li>Fixed bug in <code>openURL</code> with <code>data:</code> URIs. Previously the base-64 encoded bytestring was returned. We now decode it so it’s a proper image!</li>
</ul></li>
<li><p>DocBook reader: Handle numerical attributes starting with decimal. Also use <code>safeRead</code> instead of <code>read</code>.</p></li>
<li><p><code>Text.Pandoc.Parsing</code>:</p>
<ul>
<li>Generalized type of <code>registerHeader</code>, using new type classes <code>HasReadeOptions</code>, <code>HasIdentifierList</code>, <code>HasHeaderMap</code>. These allow certain common functions to be reused even in parsers that use custom state (instead of <code>ParserState</code>), such as the MediaWiki reader.</li>
<li>Moved inlineMath, displayMath from Markdown reader to Parsing. Generalize their types and export them from Parsing. (API change.)</li>
</ul></li>
<li><p><code>Text.Pandoc.Readers.TexMath</code>: Export <code>readTeXMath'</code>, which attends to display/inline. Deprecate <code>readTeXMath</code>, and use <code>readTeXMath'</code> in all the writers. Require <code>texmath &gt;= 0.6.5.2</code>.</p></li>
<li><p><code>Text.Pandoc.MIME</code>:</p>
<ul>
<li>Add entry for <code>jfif</code>.</li>
<li>In looking up extensions, drop the encoding info. E.g. for ‘image/jpg;base64’ we should lookup ‘image/jpg’.</li>
</ul></li>
<li><p>Templates: Changed how array variables are resolved. Previously if <code>foo</code> is an array (which might be because multiple values were set on the command line), <code>$foo$</code> would resolve to the concatenation of the elements of foo. This is rarely useful behavior. It has been changed so that the first value is rendered. Of course, you can still iterate over the values using <code>$for(foo)$</code>. This has the result that you can override earlier settings using <code>-V</code> by putting new values later on the command line, which is useful for many purposes.</p></li>
<li><p><code>Text.Pandoc</code>: Don’t default to <code>pandocExtensions</code> for all writers.</p></li>
<li><p>Allow “epub2” as synonym for “epub”, “html4” for “html”.</p></li>
<li><p>Don’t look for slidy files in data files with <code>--self-contained</code>.</p></li>
<li><p>Allow <code>https:</code> command line arguments to be downloaded.</p></li>
<li><p>Fixed <code>make_osx_package.sh</code> so data files embedded in <code>pandoc-citeproc</code>.</p></li>
</ul>
<h1 id="pandoc-1.12.1-2013-10-20">pandoc 1.12.1 (2013-10-20)</h1>
<ul>
<li><p><code>Text.Pandoc.Definition</code>: Changed default JSON serialization format. Instead of <code>{&quot;Str&quot;: &quot;foo&quot;}</code>, for example, we now have <code>{&quot;t&quot;: &quot;Str&quot;, &quot;c&quot;: &quot;foo&quot;}</code>. This new format is easier to work with outside of Haskell. Incidentally, “t” stands for “tag”, “c” for “contents”.</p></li>
<li><p>MediaWiki reader: Trim contents of <code>&lt;math&gt;</code> tags, to avoid problems when converting to markdown (#1027).</p></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Ensure that preamble doesn’t contribute to the text of the document.</li>
<li>Fixed character escaping in . Previously <code>\~</code> wasn’t handled properly, among others.</li>
<li>Parse <code>{groups}</code> as <code>Span</code>. This is needed for accurate conversion of bibtex titles, since we need to know what was protected from titlecase conversions.</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Specially escape non-ascii characters in labels. Otherwise we can get compile errors and other bugs when compiled with pdflatex (#1007). Thanks to begemotv2718 for the fix.</li>
<li>Add link anchors for code blocks with identifiers (#1025).</li>
</ul></li>
<li><p>Throughout the code, use <code>isURI</code> instead of <code>isAbsoluteURI</code>. It allows fragments identifiers.</p></li>
<li><p>Slide formats:</p>
<ul>
<li>A Div element with class “notes” is treated as speaker notes. Currently beamer goes to <code>\note{}</code>, revealjs to <code>&lt;aside class=&quot;notes&quot;&gt;</code>, and the notes are simply suppressed in other formats (#925).</li>
<li>Fixed <code>. . .</code> (pause) on HTML slide formats. Closes #1029. The old version caused a pause to be inserted before the first material on a slide. This has been fixed.</li>
<li>Removed data files for s5, slideous, slidy. Users of s5 and slideous will have to download the needed files, as has been documented for some time in the README. By default, slidy code will be sought on the web, as before.</li>
</ul></li>
<li><p>HTML writer: Insert command to typeset mathjax only in slideous output (#966, #1012).</p></li>
<li><p>RST writer: Skip spaces after display math. Otherwise we get indentation problems, and part of the next paragraph may be rendered as part of the math.</p></li>
<li><p>OpenDocument writer: Fix formatting of strikeout code (#995), thanks to wilx. don’t use <code>font-face-decls</code> variable.</p></li>
<li><p>Fixed test suite so it works with cabal sandboxes.</p></li>
</ul>
<h1 id="pandoc-1.12.0.2-2013-09-20">pandoc 1.12.0.2 (2013-09-20)</h1>
<ul>
<li>Removed an unused dependency (<code>stringable</code>) from pandoc.cabal. This will help packagers, but users should not need to upgrade.</li>
</ul>
<h1 id="pandoc-1.12.0.1-2013-09-20">pandoc 1.12.0.1 (2013-09-20)</h1>
<ul>
<li><p>Allow <code>--metadata</code> to be repeated for the same key to form a list. This also has the effect that <code>--bibliography</code> can be repeated, as before.</p></li>
<li><p>Handle boolean values in <code>--metadata</code>. Note that anything not parseable as a YAML boolean or string is treated as a literal string. You can get a string value with “yes”, or any of the strings interpretable as booleans, by quoting it:</p>
<pre><code>-M boolvalue=yes -M stringvalue=&#39;&quot;yes&quot;&#39;</code></pre></li>
<li><p>LaTeX writer: Don’t print references if <code>--natbib</code> or <code>--biblatex</code> option used.</p></li>
<li><p>DOCX writer: Add <code>settings.xml</code> to the zip container. Fixes a bug in which docx files could not be read by some versions of Word and LibreOffice (#990).</p></li>
<li><p>Fixed a regression involving slide shows with bibliographies. The Div container around references messed up the procedure for carving a document into slides. So we now remove the surrounding Div in <code>prepSlides</code>.</p></li>
<li><p>More informative error message when a filter is not found in path.</p></li>
<li><p>Depend on pandoc-types 1.12.1. This provide <code>ToJSONFilter</code> instances for <code>Data a =&gt; a -&gt; [a]</code> and <code>Data a =&gt; a -&gt; IO [a]</code>.</p></li>
<li><p>Don’t use unicode_collation in building OSX package: it adds something like 50MB of dependencies to the package.</p></li>
<li><p>Declare alex and happy as build-tools (#986).</p></li>
</ul>
<h1 id="pandoc-1.12-2013-09-15">pandoc 1.12 (2013-09-15)</h1>
<h2 id="new-features-3">New features</h2>
<ul>
<li><p>Much more flexible metadata, including arbitrary fields and structured values. Metadata can be specified flexibly in pandoc markdown using YAML metadata blocks, which may occur anywhere in the document:</p>
<pre><code>---
title: Here is my title.
abstract: |
  This is the abstract.

  1. It can contain
  2. block content
     and *inline markup*

tags: [cat, dog, animal]
...</code></pre>
<p>Metadata fields automatically populate template variables.</p></li>
<li><p>Added <code>opml</code> (OPML) as input and output format. The <code>_note</code> attribute, used in OmniOutliner and supported by multimarkdown, is supported. We treat the contents as markdown blocks under a section header.</p></li>
<li><p>Added <code>haddock</code> (Haddock markup) as input format (David Lazar).</p></li>
<li><p>Added <code>revealjs</code> output format, for reveal.js HTML 5 slide shows. (Thanks to Jamie F. Olson for the initial patch.) Nested vertical stacks are used for hierarchical structure. Results for more than one level of nesting may be odd.</p></li>
<li><p>Custom writers can now be written in lua.</p>
<pre><code>pandoc -t data/sample.lua</code></pre>
<p>will load the script sample.lua and use it as a custom writer. (For a sample, do <code>pandoc --print-default-data-file sample.lua</code>.) Note that pandoc embeds a lua interpreter, so lua need not be installed separately.</p></li>
<li><p>New <code>--filter/-F</code> option to make it easier to run “filters” (Pandoc AST transformations that operate on JSON serializations). Filters are always passed the name of the output format, so their behavior can be tailored to it. The repository <a href="https://github.com/jgm/pandocfilters" class="uri">https://github.com/jgm/pandocfilters</a> contains a python module for writing pandoc filters in python, with a number of examples.</p></li>
<li><p>Added <code>--metadata/-M</code> option. This is like <code>--variable/-V</code>, but actually adds to metadata, not just variables.</p></li>
<li><p>Added <code>--print-default-data-file</code> option, which allows printing of any of pandoc’s data files. (For example, <code>pandoc --print-default-data-file reference.odt</code> will print <code>reference.odt</code>.)</p></li>
<li><p>Added syntax for “pauses” in slide shows:</p>
<pre><code>This gives

. . .

me pause.</code></pre></li>
<li><p>New markdown extensions:</p>
<ul>
<li><code>ignore_line_breaks</code>: causes intra-paragraph line breaks to be ignored, rather than being treated as hard line breaks or spaces. This is useful for some East Asian languages, where spaces aren’t used between words, but text is separated into lines for readability.</li>
<li><code>yaml_metadata_block</code>: Parse YAML metadata blocks. (Default.)</li>
<li><code>ascii_identifiers</code>: This will force <code>auto_identifiers</code> to use ASCII only. (Default for <code>markdown_github</code>.) (#807)</li>
<li><code>lists_without_preceding_blankline</code>: Allow lists to start without preceding blank space. (Default for <code>markdown_github</code>.) (#972)</li>
</ul></li>
</ul>
<h2 id="behavior-changes-3">Behavior changes</h2>
<ul>
<li><p><code>--toc-level</code> no longer implies <code>--toc</code>. Reason: EPUB users who don’t want a visible TOC may still want to set the TOC level for in the book navigation.</p></li>
<li><p><code>--help</code> now prints in and out formats in alphabetical order, and says something about PDF output (#720).</p></li>
<li><p><code>--self-contained</code> now returns less verbose output (telling you which URLs it is fetching, but not giving the full header). In addition, there are better error messages when fetching a URL fails.</p></li>
<li><p>Citation support is no longer baked in to core pandoc. Users who need citations will need to install and use a separate filter (<code>--filter pandoc-citeproc</code>). This filter will take <code>bibliography</code>, <code>csl</code>, and <code>citation-abbreviations</code> from the metadata, though it may still be specified on the command line as before.</p></li>
<li><p>A <code>Cite</code> element is now created in parsing markdown whether or not there is a matching reference.</p></li>
<li><p>The <code>pandoc-citeproc</code> script will put the bibliography at the end of the document, as before. However, it will be put inside a <code>Div</code> element with class “references”, allowing users some control over the styling of references. A final header, if any, will be included in the <code>Div</code>.</p></li>
<li><p>The markdown writer will not print a bibliography if the <code>citations</code> extension is enabled. (If the citations are formatted as markdown citations, it is redundant to have a bibliography, since one will be generated automatically.)</p></li>
<li><p>Previously we used to store the directory of the first input file, even if it was local, and used this as a base directory for finding images in ODT, EPUB, Docx, and PDF. This has been confusing to many users. So we now look for images relative to the current working directory, even if the first file argument is in another directory. Note that this change may break some existing workflows. If you have been assuming that relative links will be interpreted relative to the directory of the first file argument, you’ll need to make that the current directory before running pandoc. (#942)</p></li>
<li><p>Better error reporting in some readers, due to changes in <code>readWith</code>: the line in which the error occured is printed, with a caret pointing to the column.</p></li>
<li><p>All slide formats now support incremental slide view for definition lists.</p></li>
<li><p>Parse <code>\(..\)</code> and <code>\[..\]</code> as math in MediaWiki reader. Parse <code>:&lt;math&gt;...&lt;/math&gt;</code> as display math. These notations are used with the MathJax MediaWiki extension.</p></li>
<li><p>All writers: template variables are set automatically from metadata fields. However, variables specified on the command line with <code>--variable</code> will completely shadow metadata fields.</p></li>
<li><p>If <code>--variable</code> is used to set many variables with the same name, a list is created.</p></li>
<li><p>Man writer: The <code>title</code>, <code>section</code>, <code>header</code>, and <code>footer</code> can now all be set individually in metadata. The <code>description</code> variable has been removed. Quotes have been added so that spaces are allowed in the title. If you have a title that begins</p>
<pre><code>COMMAND(1) footer here | header here</code></pre>
<p>pandoc will still parse it into a title, section, header, and footer. But you can also specify these elements explicitly (#885).</p></li>
<li><p>Markdown reader</p>
<ul>
<li>Added support for YAML metadata blocks, which can come anywhere in the document (not just at the beginning). A document can contain multiple YAML metadata blocks.</li>
<li>HTML span and div tags are parsed as pandoc Span and Div elements.</li>
</ul></li>
<li><p>Markdown writer</p>
<ul>
<li>Allow simple tables to be printed as grid tables, if other table options are disabled. This means you can do <code>pandoc -t markdown-pipe_tables-simple_tables-multiline_tables</code> and all tables will render as grid tables.</li>
<li>Support YAML title block (render fields in alphabetical order to make output predictable).</li>
</ul></li>
</ul>
<h2 id="api-changes-3">API changes</h2>
<ul>
<li><p><code>Meta</code> in <code>Text.Pandoc.Definition</code> has been changed to allow structured metadata. (Note: existing code that pattern-matches on <code>Meta</code> will have to be revised.) Metadata can now contain indefinitely many fields, with content that can be a string, a Boolean, a list of <code>Inline</code> elements, a list of <code>Block</code> elements, or a map or list of these.</p></li>
<li><p>A new generic block container (<code>Div</code>) has been added to <code>Block</code>, and a generic inline container (<code>Span</code>) has been added to <code>Inline</code>. These can take attributes. They will render in HTML, Textile, MediaWiki, Org, RST and and Markdown (with <code>markdown_in_html</code> extension) as HTML <code>&lt;div&gt;</code> and <code>&lt;span&gt;</code> elements; in other formats they will simply pass through their contents. But they can be targeted by scripts.</p></li>
<li><p><code>Format</code> is now a newtype, not an alias for String. Equality comparisons are case-insensitive.</p></li>
<li><p>Added <code>Text.Pandoc.Walk</code>, which exports hand-written tree-walking functions that are much faster than the SYB functions from <code>Text.Pandoc.Generic</code>. These functions are now used where possible in pandoc’s code. (<code>Tests.Walk</code> verifies that <code>walk</code> and <code>query</code> match the generic traversals <code>bottomUp</code> and <code>queryWith</code>.)</p></li>
<li><p>Added <code>Text.Pandoc.JSON</code>, which provides <code>ToJSON</code> and <code>FromJSON</code> instances for the basic pandoc types. They use GHC generics and should be faster than the old JSON serialization using <code>Data.Aeson.Generic</code>.</p></li>
<li><p>Added <code>Text.Pandoc.Process</code>, exporting <code>pipeProcess</code>. This is a souped-up version of <code>readProcessWithErrorcode</code> that uses lazy bytestrings instead of strings and allows setting environment variables. (Used in <code>Text.Pandoc.PDF</code>.)</p></li>
<li><p>New module <code>Text.Pandoc.Readers.OPML</code>.</p></li>
<li><p>New module <code>Text.Pandoc.Writers.OPML</code>.</p></li>
<li><p>New module <code>Text.Pandoc.Readers.Haddock</code> (David Lazar). This is based on Haddock’s own lexer/parser.</p></li>
<li><p>New module <code>Text.Pandoc.Writers.Custom</code>.</p></li>
<li><p>In <code>Text.Pandoc.Shared</code>, <code>openURL</code> and <code>fetchItem</code> now return an Either, for better error handling.</p></li>
<li><p>Made <code>stringify</code> polymorphic in <code>Text.Pandoc.Shared</code>.</p></li>
<li><p>Removed <code>stripTags</code> from <code>Text.Pandoc.XML</code>.</p></li>
<li><p><code>Text.Pandoc.Templates</code>:</p>
<ul>
<li>Simplified <code>Template</code> type to a newtype.</li>
<li>Removed <code>Empty</code>.</li>
<li>Changed type of <code>renderTemplate</code>: it now takes a JSON context and a compiled template.</li>
<li>Export <code>compileTemplate</code>.</li>
<li>Export <code>renderTemplate'</code> that takes a string instead of a compiled template.</li>
<li>Export <code>varListToJSON</code>.</li>
</ul></li>
<li><p><code>Text.Pandoc.PDF</code> exports <code>makePDF</code> instead of <code>tex2pdf</code>.</p></li>
<li><p><code>Text.Pandoc</code>:</p>
<ul>
<li>Made <code>toJsonFilter</code> an alias for <code>toJSONFilter</code> from <code>Text.Pandoc.JSON</code>.</li>
<li>Removed <code>ToJsonFilter</code> typeclass. <code>ToJSONFilter</code> from <code>Text.Pandoc.JSON</code> should be used instead. (Compiling against pandoc-types instead of pandoc will also produce smaller executables.)</li>
<li>Removed the deprecated <code>jsonFilter</code> function.</li>
<li>Added <code>readJSON</code>, <code>writeJSON</code> to the API (#817).</li>
</ul></li>
<li><p><code>Text.Pandoc.Options</code>:</p>
<ul>
<li>Added <code>Ext_lists_without_preceding_blankline</code>, <code>Ext_ascii_identifiers</code>, <code>Ext_ignore_line_breaks</code>, <code>Ext_yaml_metadataBlock</code> to <code>Extension</code>.</li>
<li>Changed <code>writerSourceDirectory</code> to <code>writerSourceURL</code> and changed the type to a <code>Maybe</code>. <code>writerSourceURL</code> is set to ‘Just url’ when the first command-line argument is an absolute URL. (So, relative links will be resolved in relation to the first page.) Otherwise, ‘Nothing’.</li>
<li>All bibliography-related fields have been removed from <code>ReaderOptions</code> and <code>WriterOptions</code>: <code>writerBiblioFiles</code>, <code>readerReferences</code>, <code>readerCitationStyle</code>.</li>
</ul></li>
<li><p>The <code>Text.Pandoc.Biblio</code> module has been removed. Users of the pandoc library who want citation support will need to use <code>Text.CSL.Pandoc</code> from <code>pandoc-citeproc</code>.</p></li>
</ul>
<h2 id="bug-fixes-2">Bug fixes</h2>
<ul>
<li><p>In markdown, don’t autolink a bare URI that is followed by <code>&lt;/a&gt;</code> (#937).</p></li>
<li><p><code>Text.Pandoc.Shared</code></p>
<ul>
<li><code>openURL</code> now follows redirects (#701), properly handles <code>data:</code> URIs, and prints diagnostic output to stderr rather than stdout.</li>
<li><code>readDefaultDataFile</code>: normalize the paths. This fixes bugs in <code>--self-contained</code> on pandoc compiled with <code>embed_data_files</code> (#833).</li>
<li>Fixed <code>readDefaultDataFile</code> so it works on Windows.</li>
<li>Better error messages for <code>readDefaultDataFile</code>. Instead of listing the last path tried, which can confuse people who are using <code>--self-contained</code>, so now we just list the data file name.</li>
<li>URL-escape pipe characters. Even though these are legal, <code>Network.URI</code> doesn’t regard them as legal in URLs. So we escape them first (#535).</li>
</ul></li>
<li><p>Mathjax in HTML slide shows: include explicit “Typeset” call. This seems to be needed for some formats (e.g. slideous) and won’t hurt in others (#966).</p></li>
<li><p><code>Text.Pandoc.PDF</code></p>
<ul>
<li>On Windows, create temdir in working directory, since the system temp directory path may contain tildes, which can cause problems in LaTeX (#777).</li>
<li>Put temporary output directory in <code>TEXINPUTS</code> (see #917).</li>
<li><code>makePDF</code> tries to download images that are not found locally, if the first argument is a URL (#917).</li>
<li>If compiling with <code>pdflatex</code> yields an encoding error, offer the suggestion to use <code>--latex-engine=xelatex</code>.</li>
</ul></li>
<li><p>Produce automatic header identifiers in parsing textile, RST, and LaTeX, unless <code>auto_identifiers</code> extension is disabled (#967).</p></li>
<li><p><code>Text.Pandoc.SelfContained</code>: Strip off fragment, query of relative URL before treating as a filename. This fixes <code>--self-contained</code> when used with CSS files that include web fonts using the method described here: <a href="http://paulirish.com/2009/bulletproof-font-face-implementation-syntax/" class="uri">http://paulirish.com/2009/bulletproof-font-face-implementation-syntax/</a> (#739). Handle <code>src</code> in <code>embed</code>, <code>audio</code>, <code>source</code>, <code>input</code> tags.</p></li>
<li><p><code>Text.Pandoc.Parsing</code>: <code>uri</code> parser no longer treats punctuation before percent-encoding, or a <code>+</code> character, as final punctuation.</p></li>
<li><p><code>Text.Pandoc.ImageSize</code>: Handle EPS (#903). This change will make EPS images properly sized on conversion to Word.</p></li>
<li><p>Slidy: Use slidy.js rather than slidy.js.gz. Reason: some browsers have trouble with the gzipped js file, at least on the local file system (#795).</p></li>
<li><p>Markdown reader</p>
<ul>
<li>Properly handle blank line at beginning of input (#882).</li>
<li>Fixed bug in unmatched reference links. The input <code>[*infile*] [*outfile*]</code> was getting improperly parsed: “infile” was emphasized, but “<em>outfile</em>” was literal (#883).</li>
<li>Allow internal <code>+</code> in citation identifiers (#856).</li>
<li>Allow <code>.</code> or <code>)</code> after <code>#</code> in ATX headers if no <code>fancy_lists</code>.</li>
<li>Do not generate blank title, author, or date metadata elements. Leave these out entirely if they aren’t present.</li>
<li>Allow backtick code blocks not to be preceded by blank line (#975).</li>
</ul></li>
<li><p>Textile reader:</p>
<ul>
<li>Correctly handle entities.</li>
<li>Improved handling of <code>&lt;pre&gt;</code> blocks (#927). Remove internal HTML tags in code blocks, rather than printing them verbatim. Parse attributes on <code>&lt;pre&gt;</code> tag for code blocks.</li>
</ul></li>
<li><p>HTML reader: Handle non-simple tables (#893). Column widths are read from <code>col</code> tags if present, otherwise divided equally.</p></li>
<li><p>LaTeX reader</p>
<ul>
<li>Support alltt environment (#892).</li>
<li>Support <code>\textasciitilde</code>, <code>\textasciicircum</code> (#810).</li>
<li>Treat <code>\textsl</code> as emphasized text reader (#850).</li>
<li>Skip positional options after <code>\begin{figure}</code>.</li>
<li>Support <code>\v{}</code> for hacek (#926).</li>
<li>Don’t add spurious “,” to citation suffixes. This is added when needed in pandoc-citeproc.</li>
<li>Allow spaces in alignment spec in tables, e.g. <code>{ l r c }</code>.</li>
<li>Improved support for accented characters (thanks to Scott Morrison).</li>
<li>Parse label after section command and set id (#951).</li>
</ul></li>
<li><p>RST reader:</p>
<ul>
<li>Don’t insert paragraphs where docutils doesn’t. <code>rst2html</code> doesn’t add <code>&lt;p&gt;</code> tags to list items (even when they are separated by blank lines) unless there are multiple paragraphs in the list. This commit changes the RST reader to conform more closely to what docutils does (#880).</li>
<li>Improved metadata. Treat initial field list as metadata when standalone specified. Previously ALL fields “title”, “author”, “date” in field lists were treated as metadata, even if not at the beginning. Use <code>subtitle</code> metadata field for subtitle.</li>
<li>Fixed ‘authors’ metadata parsing in reST. Semicolons separate different authors.</li>
</ul></li>
<li><p>MediaWiki reader</p>
<ul>
<li>Allow space before table rows.</li>
<li>Fixed regression for <code>&lt;ref&gt;URL&lt;/ref&gt;</code>. <code>&lt;</code> is no longer allowed in URLs, according to the uri parser in <code>Text.Pandoc.Parsing</code>. Added a test case.</li>
<li>Correctly handle indented preformatted text without preceding or following blank line.</li>
<li>Fixed <code>|</code> links inside table cells. Improved attribute parsing.</li>
<li>Skip attributes on table rows. Previously we just crashed if rows had attributes, now we ignore them.</li>
<li>Ignore attributes on headers.</li>
<li>Allow <code>Image:</code> for images (#971).</li>
<li>Parse an image with caption in a paragraph by itself as a figure.</li>
</ul></li>
<li><p>LaTeX writer</p>
<ul>
<li>Don’t use ligatures in escaping inline code.</li>
<li>Fixed footnote numbers in LaTeX/PDF tables. This fixes a bug wherein notes were numbered incorrectly in tables (#827).</li>
<li>Always create labels for sections. Previously the labels were only created when there were links to the section in the document (#871).</li>
<li>Stop escaping <code>|</code> in LaTeX math. This caused problems with array environments (#891).</li>
<li>Change <code>\</code> to <code>/</code> in paths. <code>/</code> works even on Windows in LaTeX. <code>\</code> will cause major problems if unescaped.</li>
<li>Write id for code block to label attribute in LaTeX when listings is used (thanks to Florian Eitel).</li>
<li>Scale LaTeX tables so they don’t exceed columnwidth.</li>
<li>Avoid problem with footnotes in unnumbered headers (#940).</li>
</ul></li>
<li><p>Beamer writer: when creating beamer slides, add <code>allowframebreaks</code> option to the slide if it is one of the header classes. It is recommended that your bibliography slide have this attribute:</p>
<pre><code># References {.allowframebreaks}</code></pre>
<p>This causes multiple slides to be created if necessary, depending on the length of the bibliography.</p></li>
<li><p>ConTeXt writer: Properly handle tables without captions. The old output only worked in MkII. This should work in MkIV as well (#837).</p></li>
<li><p>MediaWiki writer: Use native mediawiki tables instead of HTML (#720).</p></li>
<li><p>HTML writer:</p>
<ul>
<li>Fixed <code>--no-highlight</code> (Alexander Kondratskiy).</li>
<li>Don’t convert to lowercase in email obfuscation (#839).</li>
<li>Ensure proper escaping in <code>&lt;title&gt;</code> and <code>&lt;meta&gt;</code> fields.</li>
</ul></li>
<li><p>AsciiDoc writer:</p>
<ul>
<li>Support <code>--atx-headers</code> (Max Rydahl Andersen).</li>
<li>Don’t print empty identifier blocks <code>([[]])</code> on headers (Max Rydahl Andersen).</li>
</ul></li>
<li><p>ODT writer:</p>
<ul>
<li>Fixing wrong numbered-list indentation in open document format (Alexander Kondratskiy) (#369).</li>
<li><code>reference.odt</code>: Added pandoc as “generator” in <code>meta.xml</code>.</li>
<li>Minor changes for ODF 1.2 conformance (#939). We leave the nonconforming <code>contextual-spacing</code> attribute, which is provided by LibreOffice itself and seems well supported.</li>
</ul></li>
<li><p>Docx writer:</p>
<ul>
<li>Fixed rendering of display math in lists. In 1.11 and 1.11.1, display math in lists rendered as a new list item. Now it always appears centered, just as outside of lists, and in proper display math style, no matter how far indented the containing list item is (#784).</li>
<li>Use <code>w:br</code> with <code>w:type</code> <code>textWrapping</code> for linebreaks. Previously we used <code>w:cr</code> (#873).</li>
<li>Use Compact style for Plain block elements, to differentiate between tight and loose lists (#775).</li>
<li>Ignore most components of <code>reference.docx</code>. We take the <code>word/styles.xml</code>, <code>docProps/app.xml</code>, <code>word/theme/theme1.xml</code>, and <code>word/fontTable.xml</code> from <code>reference.docx</code>, ignoring everything else. This should help with the corruption problems caused when different versions of Word resave the reference.docx and reorganize things.</li>
<li>Made <code>--no-highlight</code> work properly.</li>
</ul></li>
<li><p>EPUB writer</p>
<ul>
<li>Don’t add <code>dc:creator</code> tags if present in EPUB metadata.</li>
<li>Add <code>id=&quot;toc-title&quot;</code> to <code>h1</code> in <code>nav.xhtml</code> (#799).</li>
<li>Don’t put blank title page in reading sequence. Set <code>linear=&quot;no&quot;</code> if no title block. Addresses #797.</li>
<li>Download webtex images and include as data URLs. This allows you to use <code>--webtex</code> in creating EPUBs. Math with <code>--webtex</code> is automatically made self-contained.</li>
<li>In <code>data/epub.css</code>, removed highlighting styles (which are no longer needed, since styles are added by the HTML writer according to <code>--highlighting-style</code>). Simplified margin fields.</li>
<li>If resource not found, skip it, as in Docx writer (#916).</li>
</ul></li>
<li><p>RTF writer:</p>
<ul>
<li>Properly handle characters above the 0000-FFFF range. Uses surrogate pairs. Thanks to Hiromi Ishii for the patch.</li>
<li>Fixed regression with RTF table of contents.</li>
<li>Only autolink absolute URIs. This fixes a regression, #830.</li>
</ul></li>
<li><p>Markdown writer:</p>
<ul>
<li>Only autolink absolute URIs. This fixes a regression, #830.</li>
<li>Don’t wrap attributes in fenced code blocks.</li>
<li>Write full metadata in MMD style title blocks.</li>
<li>Put multiple authors on separate lines in pandoc titleblock. Also, don’t wrap long author entries, as new lines get treated as new authors.</li>
</ul></li>
<li><p><code>Text.Pandoc.Templates</code>:</p>
<ul>
<li>Fixed bug retrieving default template for markdown variants.</li>
<li>Templates can now contain “record lookups” in variables; for example, <code>author.institution</code> will retrieve the <code>institution</code> field of the <code>author</code> variable.</li>
<li>More consistent behavior of <code>$for$</code>. When <code>foo</code> is not a list, <code>$for(foo)$...$endfor$</code> should behave like <span class="math inline"><em>i</em><em>f</em>(<em>f</em><em>o</em><em>o</em>)</span>…<span class="math inline"><em>e</em><em>n</em><em>d</em><em>i</em><em>f</em></span>. So if <code>foo</code> resolves to “”, no output should be produced. See pandoc-templates#39.</li>
</ul></li>
<li><p>Citation processing improvements (now part of pandoc-citeproc):</p>
<ul>
<li>Fixed <code>endWithPunct</code> The new version correctly sees a sentence ending in ‘.)’ as ending with punctuation. This fixes a bug which led such sentences to receive an extra period at the end: ‘.).’. Thanks to Steve Petersen for reporting.</li>
<li>Don’t interfere with Notes that aren’t citation notes. This fixes a bug in which notes not generated from citations were being altered (e.g. first letter capitalized) (#898).</li>
<li>Only capitalize footnote citations when they have a prefix.</li>
<li>Changes in suffix parsing. A suffix beginning with a digit gets ‘p’ inserted before it before passing to citeproc-hs, so that bare numbers are treated as page numbers by default. A suffix not beginning with punctuation has a space added at the beginning (rather than a comma and space, as was done before for not-author-in-text citations). The result is that <code>\citep[23]{item1}</code> in LaTeX will be interpreted properly, with ‘23’ treated as a locator of type ‘page’.</li>
<li>Many improvements to citation rendering, due to fixes in citeproc-hs (thanks to Andrea Rossato).</li>
<li>Warnings are issued for undefined citations, which are rendered as <code>???</code>.</li>
<li>Fixed hanging behavior when locale files cannot be found.</li>
</ul></li>
</ul>
<h2 id="template-changes-2">Template changes</h2>
<ul>
<li><p>DocBook: Use DocBook 4.5 doctype.</p></li>
<li><p>Org: ‘#+TITLE:’ is inserted before the title. Previously the writer did this.</p></li>
<li><p>LaTeX: Changes to make mathfont work with xelatex. We need the mathspec library, not just fontspec, for this. We also need to set options for setmathfont (#734).</p></li>
<li><p>LaTeX: Use <code>tex-ansi</code> mapping for <code>monofont</code>. This ensures that straight quotes appear as straight, rather than being treated as curly. See #889.</p></li>
<li><p>Made <code>\includegraphics</code> more flexible in LaTeX template. Now it can be used with options, if needed. Thanks to Bernhard Weichel.</p></li>
<li><p>LaTeX/Beamer: Added <code>classoption</code> variable. This is intended for class options like <code>oneside</code>; it may be repeated with different options. (Thanks to Oliver Matthews.)</p></li>
<li><p>Beamer: Added <code>fonttheme</code> variable. (Thanks to Luis Osa.)</p></li>
<li><p>LaTeX: Added <code>biblio-style</code> variable (#920).</p></li>
<li><p>DZSlides: title attribute on title section.</p></li>
<li><p>HTML5: add meta tag to allow scaling by user (Erik Evenson)</p></li>
</ul>
<h2 id="under-the-hood-improvements-2">Under-the-hood improvements</h2>
<ul>
<li><p>Markdown reader:Improved strong/emph parsing, using the strategy of <a href="https://github.com/jgm/Markdown" class="uri">https://github.com/jgm/Markdown</a>. The new parsing algorithm requires no backtracking, and no keeping track of nesting levels. It will give different results in some edge cases, but these should not affect normal uses.</p></li>
<li><p>Added <code>Text.Pandoc.Compat.Monoid</code>. This allows pandoc to compile with <code>base</code> &lt; 4.5, where <code>Data.Monoid</code> doesn’t export <code>&lt;&gt;</code>. Thanks to Dirk Ullirch for the patch.</p></li>
<li><p>Added <code>Text.Pandoc.Compat.TagSoupEntity</code>. This allows pandoc to compile with <code>tagsoup</code> 0.13.x. Thanks to Dirk Ullrich for the patch.</p></li>
<li><p>Most of <code>Text.Pandoc.Readers.TeXMath</code> has been moved to the <code>texmath</code> module (0.6.4). (This allows <code>pandoc-citeproc</code> to handle simple math in bibliography fields.)</p></li>
<li><p>Added <code>Text.Pandoc.Writers.Shared</code> for shared functions used only in writers. <code>metaToJSON</code> is used in writers to create a JSON object for use in the templates from the pandoc metadata and variables. <code>getField</code>, <code>setField</code>, and <code>defField</code> are for working with JSON template contexts.</p></li>
<li><p>Added <code>Text.Pandoc.Asciify</code> utility module. This exports functions to create ASCII-only versions of identifiers.</p></li>
<li><p><code>Text.Pandoc.Parsing</code></p>
<ul>
<li>Generalized state type on <code>readWith</code> (API change).</li>
<li>Specialize readWith to <code>String</code> input. (API change).</li>
<li>In <code>ParserState</code>, replace <code>stateTitle</code>, <code>stateAuthors</code>, <code>stateDate</code> with <code>stateMeta</code> and <code>stateMeta'</code>.</li>
</ul></li>
<li><p><code>Text.Pandoc.UTF8</code>: use strict bytestrings in reading. The use of lazy bytestrings seemed to cause problems using pandoc on 64-bit Windows 7/8 (#874).</p></li>
<li><p>Factored out <code>registerHeader</code> from markdown reader, added to <code>Text.Pandoc.Parsing</code>.</p></li>
<li><p>Removed <code>blaze_html_0_5</code> flag, require <code>blaze-html</code> &gt;= 0.5. Reason: &lt; 0.5 does not provide a monoid instance for Attribute, which is now needed by the HTML writer (#803).</p></li>
<li><p>Added <code>http-conduit</code> flag, which allows fetching https resources. It also brings in a large number of dependencies (<code>http-conduit</code> and its dependencies), which is why for now it is an optional flag (#820).</p></li>
<li><p>Added CONTRIBUTING.md.</p></li>
<li><p>Improved INSTALL instructions.</p></li>
<li><p><code>make-windows-installer.bat</code>: Removed explicit paths for executables.</p></li>
<li><p><code>aeson</code> is now used instead of <code>json</code> for JSON.</p></li>
<li><p>Set default stack size to 16M. This is needed for some large conversions, esp. if pandoc is compiled with 64-bit ghc.</p></li>
<li><p>Various small documentation improvements. Thanks to achalddave and drothlis for patches.</p></li>
<li><p>Removed comment that chokes recent versions of CPP (#933).</p></li>
<li><p>Removed support for GHC version &lt; 7.2, since pandoc-types now requires at least GHC 7.2 for GHC generics.</p></li>
</ul>
<h1 id="pandoc-1.11.1-2013-03-17">pandoc 1.11.1 (2013-03-17)</h1>
<ul>
<li><p>Markdown reader:</p>
<ul>
<li>Fixed regression in which parentheses were lost in link URLs. Added tests. Closes #786.</li>
<li>Better handling of unmatched double quotes in <code>--smart</code> mode. These occur frequently in fiction, since it is customary not to close quotes in dialogue if the speaker does not change between paragraphs. The unmatched quotes now get turned into literal left double quotes. (No <code>Quoted</code> inline is generated, however.) Closes #99 (again).</li>
</ul></li>
<li><p>HTML writer: Fixed numbering mismatch between TOC and sections. <code>--number-offset</code> now affects TOC numbering as well as section numbering, as it should have all along. Closes #789.</p></li>
<li><p>Markdown writer: Reverted 1.11 change that caused citations to be rendered as markdown citations, even if <code>--bibliography</code> was specified, unless <code>citation</code> extension is disabled. Now, formatted citations are always printed if <code>--bibliography</code> was specified. If you want to reformat markdown keeping pandoc markdown citations intact, don’t use <code>--bibliography</code>. Note that citations parsed from LaTeX documents will be rendered as pandoc markdown citations when <code>--bibliography</code> is not specified.</p></li>
<li><p>ODT writer: Fixed regression leading to corrupt ODTs. This was due to a change in the <code>Show</code> instance for <code>Text.Pandoc.Pretty.Doc</code>. Closes #780.</p></li>
<li><p>Fixed spacing bugs involving code block attributes in RST reader and Markdown writer. Closes #763.</p></li>
<li><p>Windows package: Various improvements due to Fyodor Sheremetyev.</p>
<ul>
<li>Automatically set installation path (Program Files or Local App Data).</li>
<li>Set system PATH environment variable when installing for all users.</li>
<li>Pandoc can installed for all users using the following command. <code>msiexec /i pandoc-1.11.msi ALLUSERS=1</code>.</li>
</ul></li>
<li><p>Bumped QuickCheck version bound.</p></li>
</ul>
<h1 id="pandoc-1.11-2013-03-09">pandoc 1.11 (2013-03-09)</h1>
<ul>
<li><p>Added <code>--number-offset</code> option. (See README for description.)</p></li>
<li><p>Added <code>--default-image-extension</code> option. (See README for description.)</p></li>
<li><p><code>--number-sections</code> behavior change: headers with class <code>unnumbered</code> will not be numbered.</p></li>
<li><p><code>--version</code> now reports the default data directory.</p></li>
<li><p><code>Text.Pandoc.Parsing</code> is no longer exposed. (API change.)</p></li>
<li><p><code>Text.Pandoc.Highlighting</code> is no longer exposed. (API change.)</p></li>
<li><p><code>Text.Pandoc.Shared</code>: Changed type of <code>Element</code>. <code>Sec</code> now includes a field for <code>Attr</code> rather than just <code>String</code>. (API change.)</p></li>
<li><p>Added <code>markdown_github</code> as input format. This was an accidental omission in 1.10.</p></li>
<li><p>Added <code>readerDefaultImageExtension</code> field to <code>ReaderOptions</code>. (API change.)</p></li>
<li><p>Added <code>writerNumberOffset</code> field in <code>WriterOptions</code>. (API change.)</p></li>
<li><p>Beamer template:</p>
<ul>
<li>Fixed captions with longtable. Thanks to Joost Kremers.</li>
<li>Provide <code>\Oldincludegraphics</code> as in LaTeX template (Benjamin Bannier).</li>
</ul></li>
<li><p>LaTeX template:</p>
<ul>
<li>Load microtype after fonts. Microtype needs to know what fonts are being used. Thanks to dfc for the patch.</li>
<li>Set <code>secnumdepth</code> to 5 if <code>--number-sections</code> specified. This yields behavior equivalent to the other writers, numbering level 4 and 5 headers too. Closes #753.</li>
</ul></li>
<li><p>HTML reader:</p>
<ul>
<li>Handle <code>&lt;colgroup&gt;</code> tag.</li>
<li>Preserve all header attributes.</li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Parse <code>\hrule</code> as <code>HorizontalRule</code>. Closes #746.</li>
<li>Parse starred variants of <code>\section</code> etc. as headers with attribute <code>unnumbered</code>.</li>
<li>Read optional attributes in <code>lstlisting</code> and <code>Verbatim</code> environments. We convert these to pandoc standard names, e.g. <code>numberLines</code> for <code>numbers=left</code>, <code>startFrom=100</code> from <code>firstnumber=100</code>.</li>
<li>Handle language attribute for lstlistings.</li>
<li>Better support for Verbatim and minted environments. Closes #763.</li>
</ul></li>
<li><p>Markdown reader:</p>
<ul>
<li><code>-</code> in an attribute context = <code>.unnumbered</code>. The point of this is to provide a way to specify unnumbered headers in non-English documents.</li>
<li>Fixed bug parsing key/value attributes. Parsing failed if you had an unquoted attribute immediately before the final ‘}’.</li>
<li>Make backslash escape work in attributes.</li>
<li>Fix title block parsing. Now if <code>mmd_title_blocks</code> is specified, pandoc will parse a MMD title block if it sees one, even if <code>pandoc_title_blocks</code> is enabled.</li>
<li>Refactoring: <code>litChar</code> now includes entities, so we don’t need to use <code>fromEntities</code> e.g. on titles.</li>
<li>Allow spaces around borders in pipe tables. Closes #772.</li>
<li>Allow all punctuation in angle-bracket autolinks. Previously things like <code>----</code> were disallowed, because the uri parser treated them as trailing punctuation. Closes #768.</li>
<li>Make <code>implicit_header_references</code> work properly when headers are given explicit identifiers.</li>
<li>Check for tables before line blocks. Otherwise some pipe tables get treated as line blocks.</li>
<li>Allow <code>&amp;</code> in emails (for entities).</li>
<li>Properly handle entities in titles and links. A markdown link <code>&lt;http://g&amp;ouml;ogle.com&gt;</code> should be a link to <code>http://göogle.com</code>. Closes #723.</li>
</ul></li>
<li><p>Textile reader:</p>
<ul>
<li>Handle attributes on headers.</li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Add <code>fig:</code> as title for images with captions. This is needed for them to be rendered as figures. Closes #766.</li>
<li>Never emit an empty paragraph. See #761.</li>
<li>Handle <code>\caption</code> for images in figures. Closes #766.</li>
<li>Parse <code>\section*</code>, etc. as unnumbered sections.</li>
</ul></li>
<li><p>HTML writer:</p>
<ul>
<li>Support header attributes. The attributes go on the enclosing <code>section</code> or <code>div</code> tag if <code>--section-divs</code> is specified.</li>
<li>Fixed a regression (only now noticed) in html+lhs output. Previously the bird tracks were being omitted.</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Omit lists with no items to avoid LaTeX errors.</li>
<li>Support line numbering with <code>--listings</code>. If <code>numberLines</code> class is present, we add <code>numbers=left</code>; if <code>startFrom</code> is present, we add <code>firstnumber=</code>. (#763)</li>
</ul></li>
<li><p>ConTeXt writer:</p>
<ul>
<li>Removed <code>\placecontent</code>. This produced a duplicate toc, in conjunction with <code>\placelist</code>.</li>
<li>Use <code>\title</code>, <code>\subject</code> etc. for headers with <code>unnumbered</code> class.</li>
</ul></li>
<li><p>Textile writer:</p>
<ul>
<li>Support header attributes.</li>
</ul></li>
<li><p>Markdown writer:</p>
<ul>
<li>Use grid tables when needed, and if enabled. Closes #740.</li>
<li>Render citations as pandoc-markdown citations. Previously citations were rendered as citeproc-formatted citations by default. Now we render them as pandoc citations, e.g. <code>[@item1]</code>, unless the <code>citations</code> extension is disabled. If you still want formatted citations in your markdown output, use <code>pandoc -t markdown-citations</code>.</li>
</ul></li>
<li><p>RST writer:</p>
<ul>
<li>Support <code>:number-lines:</code> in code blocks.</li>
</ul></li>
<li><p>Docx writer:</p>
<ul>
<li>Better treatment of display math. Display math inside a paragraph is now put in a separate paragraph, so it will render properly (centered and without extra blank lines around it). Partially addresses #742.</li>
<li>Content types and document rels xml files are now created from scratch, rather than being taken over from <code>reference.docx</code>. This fixes problems that arise when you edit the <code>reference.docx</code> with Word.</li>
<li>We also now encode mime types for each individual image rather than using defaults. This should allow us to handle a wider range of image types (including PDF). Closes #414.</li>
<li>Changed style names in <code>reference docx</code>. <code>FootnoteReference</code> -&gt; <code>FootnoteRef</code>, <code>Hyperlink</code> -&gt; <code>Link</code>. The old names got changed by Word when the <code>reference.docx</code> was edited. Closes #414.</li>
</ul></li>
<li><p>EPUB writer:</p>
<ul>
<li>Fix section numbering. Previously the numbering restarted from 1 in each chapter (with <code>--number-sections</code>), though the numbers in the table of contents were correct.</li>
<li>Headers with “unnumbered” attribute are not numbered. (Nor do they cause an increment in running numbering.) Section numbers now work properly, even when there is material before the first numbered section.</li>
<li>Include HTML TOC, even in epub2. The TOC is included in <code>&lt;spine&gt;</code>, but <code>linear</code> is set to <code>no</code> unless the <code>--toc</code> option is specified. Include <code>&lt;guide&gt;</code> element in OPF. This should allow the TOC to be useable in Kindles when converted with kindlegen. Closes #773.</li>
</ul></li>
<li><p><code>Text.Pandoc.Parsing</code>: Optimized <code>oneOfStringsCI</code>. This dramatically reduces the speed penalty that comes from enabling the <code>autolink_bare_uris</code> extension. The penalty is still substantial (in one test, from 0.33s to 0.44s), but nowhere near what it used to be. The RST reader is also much faster now, as it autodetects URIs.</p></li>
<li><p><code>Text.Pandoc.Shared</code>: <code>hierarchicalize</code> will not number section with class “unnumbered”. Unnumbered sections get <code>[]</code> for their section number.</p></li>
<li><p><code>Text.Pandoc.Pretty</code>:</p>
<ul>
<li>Fixed <code>chomp</code> so it works inside <code>Prefixed</code> elements.</li>
<li>Changed <code>Show</code> instance so it is better for debugging.</li>
</ul></li>
<li><p><code>Text.Pandoc.ImageSize</code>: Added <code>Pdf</code> to <code>ImageType</code>.</p></li>
<li><p><code>Text.Pandoc.UTF8</code>: Strip off BOM if present. Closes #743.</p></li>
<li><p>Windows installer improvements:</p>
<ul>
<li>The installer is now signed with a certificate (thanks to Fyodor Sheremetyev).</li>
<li>WiX is used instead of InnoSetup. The installer is now a standard msi file.</li>
<li>The version number is now auto-detected, and need not be updated separately.</li>
</ul></li>
<li><p>OSX installer improvements:</p>
<ul>
<li>The package and pandoc executable are now signed with a certificate (thanks to Fyodor Sheremetyev).</li>
<li>RTF version of license is used.</li>
<li>Use full path for sysctl in <code>InstallationCheck</code> script (jonahbull). Closes #580.</li>
</ul></li>
<li><p>Converted COPYING to markdown.</p></li>
<li><p>pandoc.cabal: Require latest versions of highlighting-kate, texmath, citeproc-hs, zip-archive.</p></li>
</ul>
<h1 id="pandoc-1.10.1-2013-01-23">pandoc 1.10.1 (2013-01-23)</h1>
<ul>
<li><p>Markdown reader: various optimizations, leading to a significant performance boost.</p></li>
<li><p>RST reader: Allow anonymous form of inline links: <code>`hello &lt;url&gt;`__</code> Closes #724.</p></li>
<li><p>Mediawiki reader: Don’t require newlines after tables. Thanks to jrunningen for the patch. Closes #733.</p></li>
<li><p>Fixed LaTeX macro parsing. Now LaTeX macro definitions are preserved when output is LaTeX, and applied when it is another format. Partially addresses #730.</p></li>
<li><p>Markdown and RST readers: Added parser to <code>block</code> that skips blank lines. This fixes a subtle regression involving grid tables with empty cells. Also added test for grid table with empty cells. Closes #732.</p></li>
<li><p>RST writer: Use <code>.. code:: language</code> for code blocks with language. Closes #721.</p></li>
<li><p>DocBook writer: Fixed output for hard line breaks, adding a newline between <code>&lt;literallayout&gt;</code> tags.</p></li>
<li><p>Markdown writer: Use an autolink when link text matches url. Previously we also checked for a null title, but this test fails for links produced by citeproc-hs in bibliographies. So, if the link has a title, it will be lost on conversion to an autolink, but that seems okay.</p></li>
<li><p>Markdown writer: Set title, author, date variables as before. These are no longer used in the default template, since we use titleblock, but we set them anyway for those who use custom templates.</p></li>
<li><p>LaTeX writer: Avoid extra space at start/end of table cell. Thanks to Nick Bart for the suggestion of using @{}.</p></li>
<li><p><code>Text.Pandoc.Parsing</code>:</p>
<ul>
<li>More efficient version of <code>anyLine</code>.</li>
<li>Type of <code>macro</code> has changed; the parser now returns <code>Blocks</code> instead of <code>Block</code>.</li>
</ul></li>
<li><p>Relaxed old-time version bound, allowing 1.0.*.</p></li>
<li><p>Removed obsolete <code>hsmarkdown</code> script. Those who need <code>hsmarkdown</code> should create a symlink as described in the README.</p></li>
</ul>
<h1 id="pandoc-1.10.0.5-2013-01-23">pandoc 1.10.0.5 (2013-01-23)</h1>
<ul>
<li><p>Markdown reader: Try <code>lhsCodeBlock</code> before <code>rawTeXBlock</code>. Otherwise <code>\begin{code}...\end{code}</code> isn’t handled properly in markdown+lhs. Thanks to Daniel Miot for noticing the bug and suggesting the fix.</p></li>
<li><p>Markdown reader: Fixed bug with headerless grid tables. The 1.10 code assumed that each table header cell contains exactly one block. That failed for headerless tables (0) and also for tables with multiple blocks in a header cell. The code is fixed and tests provided. Thanks to Andrew Lee for pointing out the bug.</p></li>
<li><p>Markdown reader: Fixed regressions in fenced code blocks. Closes #722.</p>
<ul>
<li>Tilde code fences can again take a bare language string (<code>~~~ haskell</code>), not just curly-bracketed attributes (<code>~~~ {.haskell}</code>).</li>
<li>Backtick code blocks can take the curly-bracketed attributes.</li>
<li>Backtick code blocks don’t <em>require</em> a language.</li>
<li>Consolidated code for the two kinds of fenced code blocks.</li>
</ul></li>
<li><p>LaTeX template: Use <code>\urlstyle{same}</code> to avoid monospace URLs.</p></li>
<li><p>Markdown writer: Use proportional font for email autolinks with obfuscation. Closes #714.</p></li>
<li><p>Corrected name of <code>blank_before_blockquote</code> in README. Closes #718.</p></li>
<li><p><code>Text.Pandoc.Shared</code>: Fixed bug in <code>uri</code> parser. The bug prevented an autolink at the end of a string ( e.g. at the end of a line block line) from counting as a link. Closes #711.</p></li>
<li><p>Use the <code>hsb2hs</code> preprocessor instead of TH for embed_data_files. This should work on Windows, unlike the TH solution with file-embed.</p></li>
<li><p>Eliminated use of TH in test suite.</p></li>
<li><p>Added <code>Text.Pandoc.Data</code> (non-exported) to hold the association list of embedded data files, if the <code>embed_data_files</code> flag is selected. This isolates the code that needs special treatment with file-embed or <code>hsb2hs</code>.</p></li>
<li><p>Changes to <code>make-windows-installer.bat</code>.</p>
<ul>
<li>Exit batch file if any of the cabal-dev installs fail.</li>
<li>There’s no longer any need to reinstall <code>highlighting-kate</code>.</li>
<li>Don’t start with a <code>cabal update</code>; leave that to the user.</li>
<li>Force reinstall of pandoc.</li>
</ul></li>
<li><p>Fixed EPUB writer so it builds with blaze-html 0.4.x. Thanks to Jens Petersen.</p></li>
</ul>
<h1 id="pandoc-1.10.0.4-2013-01-20">pandoc 1.10.0.4 (2013-01-20)</h1>
<ul>
<li>Fixed bug with escaped % in LaTeX reader. Closes #710.</li>
</ul>
<h1 id="pandoc-1.10.0.3-2013-01-20">pandoc 1.10.0.3 (2013-01-20)</h1>
<ul>
<li>Added further missing fb2 tests to cabal file.</li>
</ul>
<h1 id="pandoc-1.10.0.2-2013-01-20">pandoc 1.10.0.2 (2013-01-20)</h1>
<ul>
<li>Added fb2 tests to cabal file’s extra-source-files.</li>
</ul>
<h1 id="pandoc-1.10.0.1-2013-01-20">pandoc 1.10.0.1 (2013-01-20)</h1>
<ul>
<li>Bump version bounds on test-framework packages.</li>
</ul>
<h1 id="pandoc-1.10-2013-01-19">pandoc 1.10 (2013-01-19)</h1>
<h2 id="new-features-4">New features</h2>
<ul>
<li><p>New input formats: <code>mediawiki</code> (MediaWiki markup).</p></li>
<li><p>New output formats: <code>epub3</code> (EPUB v3 with MathML), <code>fb2</code> (FictionBook2 ebooks).</p></li>
<li><p>New <code>--toc-depth</code> option, specifying how many levels of headers to include in a table of contents.</p></li>
<li><p>New <code>--epub-chapter-level</code> option, specifying the header level at which to divide EPUBs into separate files. Note that this normally affects only performance, not the visual presentation of the EPUB in a reader.</p></li>
<li><p>Removed the <code>--strict</code> option. Instead of using <code>--strict</code>, one can now use the format name <code>markdown_strict</code> for either input or output. This gives more fine-grained control that <code>--strict</code> did, allowing one to convert from pandoc’s markdown to strict markdown or vice versa.</p></li>
<li><p>It is now possible to enable or disable specific syntax extensions by appending them (with <code>+</code> or <code>-</code>) to the writer or reader name. For example,</p>
<pre><code>pandoc -f markdown-footnotes+hard_line_breaks</code></pre>
<p>disables footnotes and enables treating newlines as hard line breaks. The literate Haskell extensions are now implemented this way as well, using either <code>+lhs</code> or <code>+literate_haskell</code>. For a list of extension names, see the README under “Pandoc’s Markdown.”</p></li>
<li><p>The following aliases have been introduced for specific combinations of markdown extensions: <code>markdown_phpextra</code>, <code>markdown_github</code>, <code>markdown_mmd</code>, <code>markdown_strict</code>. These aliases work just like regular reader and writer names, and can be modified with extension modifiers as described above. (Note that conversion from one markdown dialect to another does not work perfectly, because there are differences in markdown parsers besides just the extensions, and because pandoc’s internal document model is not rich enough to capture all of the extensions.)</p></li>
<li><p>New <code>--html-q-tags</code> option. The previous default was to use <code>&lt;q&gt;</code> tags for smart quotes in HTML5. But <code>&lt;q&gt;</code> tags are also valid HTML4. Moreover, they are not a robust way of typesetting quotes, since some user agents don’t support them, and some CSS resets ( e.g. bootstrap) prevent pandoc’s quotes CSS from working properly. We now just insert literal quote characters by default in both <code>html</code> and <code>html5</code> output, but this option is provided for those who still want <code>&lt;q&gt;</code> tags.</p></li>
<li><p>The markdown reader now prints warnings (to stderr) about duplicate link and note references. Closes #375.</p></li>
<li><p>Markdown syntax extensions:</p>
<ul>
<li><p>Added pipe tables. Thanks to François Gannaz for the initial patch. These conform to PHP Markdown Extra’s pipe table syntax. A subset of org-mode table syntax is also supported, which means that you can use org-mode’s nice table editor to create tables.</p></li>
<li><p>Added support for RST-style line blocks. These are useful for verse and addresses.</p></li>
<li><p>Attributes can now be specified for headers, using the same syntax as in code blocks. (However, currently only the identifier has any effect in most writers.) For example,</p>
<pre><code>  # My header {#foo}

  See [the header above](#foo).</code></pre></li>
<li><p>Pandoc will now act as if link references have been defined for all headers without explicit identifiers. So, you can do this:</p>
<pre><code>  # My header

  Link to [My header].
  Another link to [it][My header].</code></pre>
<p>Closes #691.</p></li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Command macros now work everywhere, including non-math. Environment macros still not supported.</li>
<li><code>\input</code> now works, as well as <code>\include</code>. TEXINPUTS is used. Pandoc looks recursively into included files for more included files.</li>
</ul></li>
</ul>
<h2 id="behavior-changes-4">Behavior changes</h2>
<ul>
<li><p>The Markdown reader no longer puts the text of autolinks in a <code>Code</code> inline. This means that autolinks will no longer appear in a monospace font.</p></li>
<li><p>The character <code>/</code> can now appear in markdown citation keys.</p></li>
<li><p>HTML blocks in strict_markdown are no longer required to begin at the left margin. Technically this is required, according to the markdown syntax document, but <code>Markdown.pl</code> and other markdown processors are more liberal.</p></li>
<li><p>The <code>-V</code> option has been changed so that if there are duplicate variables, those specified later on the command line take precedence.</p></li>
<li><p>Tight lists now work in LaTeX and ConTeXt output.</p></li>
<li><p>The LaTeX writer no longer relien on the <code>enumerate</code> package. Instead, it uses standard LaTeX commands to change the list numbering style.</p></li>
<li><p>The LaTeX writer now uses <code>longtable</code> instead of <code>ctable</code>. This allows tables to be split over page boundaries.</p></li>
<li><p>The RST writer now uses a line block to render paragraphs containing linebreaks (which previously weren’t supported at all).</p></li>
<li><p>The markdown writer now applies the <code>--id-prefix</code> to footnote IDs. Closes #614.</p></li>
<li><p>The plain writer no longer uses backslash-escaped line breaks (which are not very “plain”).</p></li>
<li><p><code>Text.Pandoc.UTF8</code>: Better error message for invalid UTF8. Read bytestring and use <code>Text</code>’s decodeUtf8 instead of using <code>System.IO.hGetContents</code>. This way you get a message saying “invalid UTF-8 stream” instead of “invalid byte sequence.” You are also told which byte caused the problem.</p></li>
<li><p>Docx, ODT, and EPUB writers now download images specified by a URL instead of skipping them or raising an error.</p></li>
<li><p>EPUB writer:</p>
<ul>
<li>The default CSS now left-aligns headers by default, instead of centering. This is more consistent with the rest of the writers.</li>
<li>A proper multi-level table of contents is now used in <code>toc.ncx</code>. There is no longer a subsidiary table of contents at the beginning of each chapter.</li>
<li>Code highlighting now works by default.</li>
<li>Section divs are used by default for better semantic markup.</li>
<li>The title is used instead of “Title Page” in the table of contents. Otherwise we have a hard-coded English string, which looks strange in ebooks written in other languages. Closes #572.</li>
</ul></li>
<li><p>HTML writer:</p>
<ul>
<li>Put mathjax in span with class “math”. Closes #562.</li>
<li>Put citations in a span with class “citation.” In HTML5, also include a <code>data-cite</code> attribute with a space-separated list of citation keys.</li>
</ul></li>
<li><p><code>Text.Pandoc.UTF8</code>: use universalNewlineMode in reading. This treats both <code>\r\n</code> and <code>\n</code> as <code>\n</code> on input, no matter what platform we’re running on.</p></li>
<li><p>Citation processing is now done in the Markdown and LaTeX readers, not in <code>pandoc.hs</code>. This makes it easier for library users to use citations.</p></li>
</ul>
<h2 id="template-changes-3">Template changes</h2>
<ul>
<li><p>HTML: Added css to template to preserve spaces in <code>&lt;code&gt;</code> tags. Thanks to Dirk Laurie.</p></li>
<li><p>Beamer: Remove English-centric strings in section pages. Section pages used to have “Section” and a number as well as the section title. Now they just have the title. Similarly for part and subsection. Closes #566.</p></li>
<li><p>LaTeX, ConTeXt: Added papersize variable.</p></li>
<li><p>LaTeX, Beamer templates: Use longtable instead of ctable.</p></li>
<li><p>LaTeX, Beamer templates: Don’t require ‘float’ package for tables. We don’t actually seem to use the ‘[H]’ option.</p></li>
<li><p>Markdown, plain: Fixed titleblock so it is just a single string. Previously separate title, author, and date variables were used, but this didn’t allow different kinds of title blocks.</p></li>
<li><p>EPUB:</p>
<ul>
<li>Rationalized templates. Previously there were three different templates involved in epub production. There is now just one template, <code>default.epub</code> or <code>default.epub3</code>. It can now be overridden using <code>--template</code>, just like other templates. The titlepage is now folded into the default template. A <code>titlepage</code> variable selects it.</li>
<li>UTF-8, lang tag, meta tags, title element.</li>
</ul></li>
<li><p>Added scale-to-width feature to beamer template</p></li>
</ul>
<h2 id="api-changes-4">API changes</h2>
<ul>
<li><p><code>Text.Pandoc.Definition</code>: Added <code>Attr</code> field to <code>Header</code>. Previously header identifers were autogenerated by the writers. Now they are added in the readers (either automatically or explicitly).</p></li>
<li><p><code>Text.Pandoc.Builder</code>:</p>
<ul>
<li><code>Inlines</code> and <code>Blocks</code> are now synonyms for <code>Many Inline</code> and <code>Many Block</code>. <code>Many</code> is a newtype wrapper around <code>Seq</code>, with custom Monoid instances for <code>Many Inline</code> and <code>Many Block.  This allows</code>Many<code>to be made an instance of</code>Foldable<code>and</code>Traversable`.</li>
<li>The old <code>Listable</code> class has been removed.</li>
<li>The module now exports <code>isNull</code>, <code>toList</code>, <code>fromList</code>.</li>
<li>The old <code>Read</code> and <code>Show</code> instances have been removed; derived instances are now used.</li>
<li>Added <code>headerWith</code>.</li>
</ul></li>
<li><p>The readers now take a <code>ReaderOptions</code> rather than a <code>ParserState</code> as a parameter. Indeed, not all parsers use the <code>ParserState</code> type; some have a custom state. The motivation for this change was to separate user-specifiable options from the accounting functions of parser state.</p></li>
<li><p>New module <code>Text.Pandoc.Options</code>. This includes the <code>WriterOptions</code> formerly in <code>Text.Pandoc.Shared</code>, and its associated data types. It also includes a new type <code>ReaderOptions</code>, which contains many options formerly in <code>ParserState</code>, and its associated data types:</p>
<ul>
<li><code>ParserState.stateParseRaw</code> -&gt; <code>ReaderOptions.readerParseRaw</code>.</li>
<li><code>ParserState.stateColumns</code> -&gt; <code>ReaderOptions.readerColumns</code>.</li>
<li><code>ParserState.stateTabStop</code> -&gt; <code>ReaderOptions.readerTabStop</code>.</li>
<li><code>ParserState.stateOldDashes</code> -&gt; <code>ReaderOptions.readerOldDashes</code>.</li>
<li><code>ParserState.stateLiterateHaskell</code> -&gt; <code>ReaderOptions.readerLiterateHaskell</code>.</li>
<li><code>ParserState.stateCitations</code> -&gt; <code>ReaderOptions.readerReferences</code>.</li>
<li><code>ParserState.stateApplyMacros</code> -&gt; <code>ReaderOptions.readerApplyMacros</code>.</li>
<li><code>ParserState.stateIndentedCodeClasses</code> -&gt; <code>ReaderOptions.readerIndentedCodeClasses</code>.</li>
<li>Added <code>ReaderOptions.readerCitationStyle</code>.</li>
</ul></li>
<li><p><code>WriterOptions</code> now includes <code>writerEpubVersion</code>, <code>writerEpubChapterLevel</code>, <code>writerEpubStylesheet</code>, <code>writerEpubFonts</code>, <code>writerReferenceODT</code>, <code>writerReferenceDocx</code>, and <code>writerTOCDepth</code>. <code>writerEPUBMetadata</code> has been renamed <code>writerEpubMetadata</code> for consistency.</p></li>
<li><p>Changed signatures of <code>writeODT</code>, <code>writeDocx</code>, <code>writeEPUB</code>, since they no longer stylesheet, fonts, reference files as separate parameters.</p></li>
<li><p>Removed <code>writerLiterateHaskell</code> from <code>WriterOptions</code>, and <code>readerLiterateHaskell</code> from <code>ReaderOptions</code>. LHS is now handled by an extension (<code>Ext_literate_haskell</code>).</p></li>
<li><p>Removed deprecated <code>writerXeTeX</code>.</p></li>
<li><p>Removed <code>writerStrict</code> from <code>WriterOptions</code>. Added <code>writerExtensions</code>. Strict is now handled through extensions.</p></li>
<li><p><code>Text.Pandoc.Options</code> exports <code>pandocExtensions</code>, <code>strictExtensions</code>, <code>phpMarkdownExtraExtensions</code>, <code>githubMarkdownExtensions</code>, and <code>multimarkdownExtensions</code>, as well as the <code>Extensions</code> type.</p></li>
<li><p>New <code>Text.Pandoc.Readers.MediaWiki</code> module, exporting <code>readMediaWiki</code>.</p></li>
<li><p>New <code>Text.Pandoc.Writers.FB2</code> module, exporting <code>writeFB2</code> (thanks to Sergey Astanin).</p></li>
<li><p><code>Text.Pandoc</code>:</p>
<ul>
<li>Added <code>getReader</code>, <code>getWriter</code> to <code>Text.Pandoc</code>.</li>
<li><code>writers</code> is now an association list <code>(String, Writer)</code>. A <code>Writer</code> can be a <code>PureStringWriter</code>, an <code>IOStringWriter</code>, or an <code>IOByteStringWriter</code>. ALL writers are now in the ‘writers’ list, including the binary writers and FB2 writer. This allows code in <code>pandoc.hs</code> to be simplified.</li>
<li>Changed type of <code>readers</code>, so all readers are in IO. Users who want pure readers can still get them form the reader modules; this just affects the function <code>getReader</code> that looks up a reader based on the format name. The point of this change is to make it possible to print warnings from the parser.</li>
</ul></li>
<li><p><code>Text.Pandoc.Parsing</code>:</p>
<ul>
<li><code>Text.Parsec</code> now exports all Parsec functions used in pandoc code. No other module directly imports Parsec. This will make it easier to change the parsing backend in the future, if we want to.</li>
<li><code>Text.Parsec</code> is used instead of <code>Text.ParserCombinators.Parsec</code>.</li>
<li>Export the type synonym <code>Parser</code>.</li>
<li>Export <code>widthsFromIndices</code>, <code>NoteTable'</code>, <code>KeyTable'</code>, <code>Key'</code>, <code>toKey'</code>, <code>withQuoteContext</code>, <code>singleQuoteStart</code>, <code>singleQuoteEnd</code>, <code>doubleQuoteStart</code>, <code>doubleQuoteEnd</code>, <code>ellipses</code>, <code>apostrophe</code>, <code>dash</code>, <code>nested</code>, <code>F(..)</code>, <code>askF</code>, <code>asksF</code>, <code>runF</code>, <code>lineBlockLines</code>.</li>
<li><code>ParserState</code> is no longer an instance of <code>Show</code>.</li>
<li>Added <code>stateSubstitutions</code> and <code>stateWarnings</code> to <code>ParserState</code>.</li>
<li>Generalized type of <code>withQuoteContext</code>.</li>
<li>Added <code>guardEnabled</code>, <code>guardDisabled</code>, <code>getOption</code>.</li>
<li>Removed <code>failIfStrict</code>.</li>
<li><code>lookupKeySrc</code> and <code>fromKey</code> are no longer exported.</li>
</ul></li>
<li><p><code>Data.Default</code> instances are now provided for <code>ReaderOptions</code>, <code>WriterOptions</code>, and <code>ParserState</code>. <code>Text.Pandoc</code> re-exports <code>def</code>. Now you can use <code>def</code> (which is re-exported by <code>Text.Pandoc</code>) instead of <code>defaultWriterOptions</code> (which is still defined). Closes #546.</p></li>
<li><p><code>Text.Pandoc.Shared</code>:</p>
<ul>
<li>Added <code>safeRead</code>.</li>
<li>Renamed <code>removedLeadingTrailingSpace</code> to <code>trim</code>, <code>removeLeadingSpace</code> to <code>triml</code>, and <code>removeTrailingSpace</code> to <code>trimr</code>.</li>
<li>Count <code>\r</code> as space in <code>trim</code> functions.</li>
<li>Moved <code>renderTags'</code> from HTML reader and <code>Text.Pandoc.SelfContained</code> to <code>Shared</code>.</li>
<li>Removed <code>failUnlessLHS</code>.</li>
<li>Export <code>compactify'</code>, formerly in Markdown reader.</li>
<li>Export <code>isTightList</code>.</li>
<li>Do not export <code>findDataFile</code>.</li>
<li><code>readDataFile</code> now returns a strict ByteString.</li>
<li>Export <code>readDataFileUTF8</code> which returns a String, like the old <code>readDataFile</code>.</li>
<li>Export <code>fetchItem</code> and <code>openURL</code>.</li>
</ul></li>
<li><p><code>Text.Pandoc.ImageSize</code>: Use strict, not lazy bytestrings. Removed <code>readImageSize</code>.</p></li>
<li><p><code>Text.Pandoc.UTF8</code>: Export <code>encodePath</code>, <code>decodePath</code>, <code>decodeArg</code>, <code>toString</code>, <code>fromString</code>, <code>toStringLazy</code>, <code>fromStringLazy</code>.</p></li>
<li><p><code>Text.Pandoc.UTF8</code> is now an exposed module.</p></li>
<li><p><code>Text.Pandoc.Biblio</code>:</p>
<ul>
<li>csl parameter now a <code>String</code> rather than a <code>FilePath</code>.</li>
<li>Changed type of <code>processBiblio</code>. It is no longer in the IO monad. It now takes a <code>Maybe Style</code> argument rather than parameters for CSL and abbrev filenames. (<code>pandoc.hs</code> now calls the functions to parse the style file and add abbreviations.)</li>
</ul></li>
<li><p>Markdown reader now exports <code>readMarkdownWithWarnings</code>.</p></li>
<li><p><code>Text.Pandoc.RTF</code> now exports <code>writeRTFWithEmbeddedImages</code> instead of <code>rtfEmbedImage</code>.</p></li>
</ul>
<h2 id="bug-fixes-3">Bug fixes</h2>
<ul>
<li><p>Make <code>--ascii</code> work properly with <code>--self-contained</code>. Closes #568.</p></li>
<li><p>Markdown reader:</p>
<ul>
<li><p>Fixed link parser to avoid exponential slowdowns. Closes #620. Previously the parser would hang on input like this:</p>
<pre><code>  [[[[[[[[[[[[[[[[[[hi</code></pre>
<p>We fixed this by making the link parser parser characters between balanced brackets (skipping brackets in inline code spans), then parsing the result as an inline list. One change is that</p>
<pre><code>  [hi *there]* bud](/url)</code></pre>
<p>is now no longer parsed as a link. But in this respect pandoc behaved differently from most other implementations anyway, so that seems okay.</p></li>
<li><p>Look for raw html/latex blocks before tables. Otherwise the following gets parsed as a table:</p>
<pre><code>  \begin{code}
  --------------
  -- My comment.
  \end{code}</code></pre>
<p>Closes #578.</p></li>
</ul></li>
<li><p>RST reader:</p>
<ul>
<li>Added support for <code>:target:</code> on <code>.. image::</code> blocks and substitutions.</li>
<li><p>Field list fixes:</p>
<ul>
<li>Fixed field lists items with body beginning after a new line (Denis Laxalde).</li>
<li>Allow any char but ‘:’ in names of field lists in RST reader (Denis Laxalde).</li>
<li>Don’t allow line breaks in field names.</li>
<li>Require whitespace after field list field names.</li>
<li>Don’t create empty definition list for metadata field lists. Previously a field list consisting only of metadata fields (author, title, date) would be parsed as an empty DefinitionList, which is not legal in LaTeX and not needed in any format.</li>
</ul></li>
<li>Don’t recognize inline-markup starts inside words. For example, <code>2*2 = 4*1</code> should not contain an emphasized section. Added test case for “Literal symbols”. Closes #569.</li>
<li>Allow dashes as separator in simple tables. Closes #555.</li>
<li>Added support for <code>container</code>, <code>compound</code>, <code>epigraph</code>, <code>rubric</code>, <code>highlights</code>, <code>pull-quote</code>.</li>
<li>Added support for <code>.. code::</code>.</li>
<li>Made directive labels case-insensitive.</li>
<li>Removed requirement that directives begin at left margin. This was (correctly) not in earlier releases; docutils doesn’t make the requirement.</li>
<li>Added support for <code>replace::</code> and <code>unicode::</code> substitutions.</li>
<li>Ignore unknown interpreted roles.</li>
<li><p>Renamed image parser to <code>subst</code>, since it now handles all substitution references.</p></li>
</ul></li>
<li><p>Textile reader:</p>
<ul>
<li>Allow newlines before pipes in table. Closes #654.</li>
<li>Fixed bug with list items containing line breaks. Now pandoc correctly handles hard line breaks inside list items. Previously they broke list parsing.</li>
<li>Implemented comment blocks.</li>
<li>Fixed bug affected words ending in hyphen.</li>
<li>Properly handle links with surrounding brackets. Square brackets need to be used when the link isn’t surrounded by spaces or punctuation, or when the URL ending may be ambiguous. Closes #564.</li>
<li>Removed nullBlock. Better to know about parsing problems than to skip stuff when we get stuck.</li>
<li>Allow ID attributes on headers.</li>
<li><p>Textile reader: Avoid parsing dashes as strikeout. Previously the input</p>
<pre><code>  text--
  text--
  text--
  text--</code></pre>
would be parsed with strikeouts rather than dashes. This fixes the problem by requiring that a strikeout delimiting - not be followed by a -. Closes #631.</li>
<li>Expanded list of <code>stringBreakers</code>. This fixes a bug on input like “(<em>hello</em>)” which should be a parenthesized emphasized “hello”. The new list is taken from the PHP source of textile 2.4.</li>
<li>Fixed autolinks. Previously the textile reader and writer incorrectly implented RST-style autolinks for URLs and email addresses. This has been fixed. Now an autolink is done this way: <code>&quot;$&quot;:http://myurl.com</code>.</li>
<li><p>Fixed footnotes bug in textile. This affected notes occuring before punctuation, e.g. <code>foo[1].</code>. Closes #518.</p></li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Better handling of citation commands.</li>
<li>Better handling of <code>\noindent</code>.</li>
<li>Added a ‘try’ in rawLaTeXBlock, so we can handle <code>\begin</code> without <code>{</code>. Closes #622.</li>
<li>Made <code>rawLaTeXInline</code> try to parse block commands as well. This is usually what we want, given how <code>rawLaTeXInline</code> is used in the markdown and textile readers. If a block-level LaTeX command is used in the middle of a paragraph (e.g. <code>\subtitle</code> inside a title), we can treat it as raw inline LaTeX.</li>
<li>Handle command. Closes #605.</li>
<li>Basic <code>\enquote</code> support.</li>
<li>Fixed parsing of paragraphs beginning with a group. Closes #606.</li>
<li>Use curly quotes for bare straight quotes.</li>
<li>Support obeylines environment. Closes #604.</li>
<li>Guard against “begin”, “end” in inlineCommand and blockCommand.</li>
<li>Better error messages for environments. Now it should tell you that it was looking for \end{env}, instead of giving “unknown parse error.”</li>
</ul></li>
<li><p>HTML reader:</p>
<ul>
<li>Added HTML 5 tags to list of block-level tags.</li>
<li>HTML reader: Fixed bug in <code>htmlBalanced</code>, which caused hangs in parsing certain markdown input using strict mode.</li>
<li>Parse <code>&lt;q&gt;</code> as <code>Quoted DoubleQuote</code>.</li>
<li>Handle nested <code>&lt;q&gt;</code> tags properly.</li>
<li>Modified <code>htmlTag</code> for fewer false positives. A tag must start with <code>&lt;</code> followed by <code>!</code>,<code>?</code>, <code>/</code>, or a letter. This makes it more useful in the wikimedia and markdown parsers.</li>
</ul></li>
<li><p>DocBook reader: Support title in “figure” element. Closes #650.</p></li>
<li><p>MediaWiki writer:</p>
<ul>
<li>Remove newline after <code>&lt;br/&gt;</code> in translation of <code>LineBreak</code> There’s no particular need for a newline (other than making the generated MediaWiki source look nice to a human), and in fact sometimes it is incorrect: in particular, inside an enumeration, list items cannot have embedded newline characters. (Brent Yorgey)</li>
<li>Use <code>&lt;code&gt;</code> not <code>&lt;tt&gt;</code> for Code.</li>
</ul></li>
<li><p>Man writer: Escape <code>-</code> as <code>\-</code>. Unescaped <code>-</code>’s become hyphens, while <code>\-</code>’s are left as ascii minus signs. That is preferable for use with command-line options. See <a href="http://lintian.debian.org/tags/hyphen-used-as-minus-sign.html" class="uri">http://lintian.debian.org/tags/hyphen-used-as-minus-sign.html</a>. Thanks to Andrea Bolognani for bringing the issue to our attention.</p></li>
<li><p>RST writer:</p>
<ul>
<li>Improved line block output. Use nonbreaking spaces for initial indent (otherwise lost in HTML and LaTeX). Allow multiple paragraphs in a single line block. Allow soft breaks w continuations in line blocks.</li>
<li>Properly handle images with no alt text. Closes #678.</li>
<li>Fixed bug with links with duplicate text. We now (a) use anonymous links for links with inline URLs, and (b) use an inline link instead of a reference link if the reference link would require a label that has already been used for a different link. Closes #511.</li>
<li>Fixed hyperlinked images. Closes #611. Use <code>:target:</code> field when you have a simple linked image.</li>
<li>Don’t add <code>:align: center</code> to figures.</li>
</ul></li>
<li><p>Texinfo writer: Fixed internal cross-references. Now we insert anchors after each header, and use <code>@ref</code> instead of <code>@uref</code> for links. Commas are now escaped as <code>@comma{}</code> only when needed; previously all commas were escaped. (This change is needed, in part, because <code>@ref</code> commands must be followed by a real comma or period.) Also insert a blank line in from of <code>@verbatim</code> environments.</p></li>
<li><p>DocBook writer:</p>
<ul>
<li>Made –id-prefix work in DocBook as well as HTML. Closes #607.</li>
<li>Don’t include empty captions in figures. Closes #581.</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Use <code>\hspace*</code> for nonbreaking space after line break, since <code>~</code> spaces after a line break are just ignored. Closes #687.</li>
<li>Don’t escape <code>_</code> in URLs or hyperref identifiers.</li>
<li>Properly escape strings inside . Closes #576.</li>
<li>Use <code>[fragile]</code> only for slides containing code rendered using listings. Closes #649.</li>
<li>Escape <code>|</code> as <code>\vert</code> in LaTeX math. This avoids a clash with highlighting-kate’s macros, which redefine <code>|</code> as a short verbatim delimiter. Thanks to Björn Peemöller for raising this issue.</li>
<li>Use minipage rather than parbox for block containers in tables. This allows verbatim code to be included in grid tables. Closes #663.</li>
<li>Prevent paragraphs containing only linebreaks or spaces.</li>
</ul></li>
<li><p>HTML writer:</p>
<ul>
<li>Included <code>highlighting-css</code> for code spans, too. Previously it was only included if used in a code block. Closes #653.</li>
<li>Improved line breaks with <code>&lt;dd&gt;</code> tags. We now put a newline between <code>&lt;/dd&gt;</code> and <code>&lt;dd&gt;</code> when there are multiple definitions.</li>
<li>Changed mathjax cdn url so it doesn’t use https. (This caused problems when used with <code>--self-contained</code>.) See #609.</li>
</ul></li>
<li><p>EPUB writer:</p>
<ul>
<li><code>--number-sections</code> now works properly.</li>
<li>Don’t strip meta and link elements in epub metadata. Patch from aberrancy. Closes #589.</li>
<li>Fixed a couple validation bugs.</li>
<li>Use ch001, ch002, etc. for chapter filenames. This improves sorting of chapters in some readers, which apparently sort ch2 after ch10. Closes #610.</li>
</ul></li>
<li><p>ODT writer: properly set title property (Arlo O’Keeffe).</p></li>
<li><p>Docx writer:</p>
<ul>
<li><p>Fixed bug with nested lists. Previously a list like</p>
<pre><code>  1. one
      - a
      - b
  2. two</code></pre>
would come out with a bullet instead of “2.” Thanks to Russell Allen for reporting the bug.</li>
<li>Use <code>w:cr</code> in <code>w:r</code> instead of <code>w:br</code> for linebreaks. This seems to fix a problem viewing pandoc-generated docx files in LibreOffice.</li>
<li>Use integer ids for bookmarks. Closes #626.</li>
<li>Added nsid to abstractNum elements. This helps when merging word documents with numbered or bulleted lists. Closes #627.</li>
<li>Use separate footnotes.xml for notes. This seems to help LibreOffice convert the file, even though it was valid docx before. Closes #637.</li>
<li>Use rIdNN identifiers for r:embed in images.</li>
<li>Avoid reading image files again when we’ve already processed them.</li>
<li><p>Fixed typo in <code>referenc.docx</code> that prevented image captions from working. Thanks to Huashan Chen.</p></li>
</ul></li>
<li><p><code>Text.Pandoc.Parsing</code>:</p>
<ul>
<li>Fixed bug in <code>withRaw</code>, which didn’t correctly handle the case where nothing is parsed.</li>
<li>Made <code>emailAddress</code> parser more correct. Now it is based on RFC 822, though it still doesn’t implement quoted strings in email addresses.</li>
<li>Revised URI parser. It now allows many more schemes, allows uppercase URIs, and better handles trailing punctuation and trailing slashes in bare URIs. Added many tests.</li>
<li>Simplified and improved singleQuoteStart. This makes <code>'s'</code>, <code>'l'</code>, etc. parse properly. Formerly we had some English-centric heuristics, but they are no longer needed. Closes #698.</li>
</ul></li>
<li><p><code>Text.Pandoc.Pretty</code>: Added wide punctuation range to <code>charWidth</code>. This fixes bug with Chinese commas in markdown and reST tables, and a bug that caused combining characters to be dropped.</p></li>
<li><p><code>Text.Pandoc.MIME</code>: Added MIME types for .wof and .eot. Closes #640.</p></li>
<li><p><code>Text.Pandoc.Biblio</code>:</p>
<ul>
<li>Run <code>mvPunc</code> and <code>deNote</code> on metadata too. This fixed a bug with notes on titles using footnote styles.</li>
<li>Fixed bug in fetching CSL files from CSL data directory.</li>
</ul></li>
<li><p><code>pandoc.hs</code>: Give correct value to <code>writerSourceDirectory</code> when a URL is provided. It should be the URL up to the path.</p></li>
<li><p>Fixed/simplified diff output for tests. Biblio: Make sure mvPunc and deNote run on metadata too. This fixed a bug with notes on titles using footnote styles.</p></li>
</ul>
<h2 id="under-the-hood-improvements-3">Under the hood improvements</h2>
<ul>
<li><p>We no longer depend on <code>utf8-string</code>. Instead we use functions defined in <code>Text.Pandoc.UTF8</code> that use <code>Data.Text</code>’s conversions.</p></li>
<li><p>Use <code>safeRead</code> instead of using <code>reads</code> directly (various modules).</p></li>
<li><p>“Implicit figures” (images alone in a paragraph) are now handled differently. The markdown reader gives their titles the prefix <code>fig:</code>; the writers look for this before treating the image as a figure. Though this is a bit of a hack, it has two advantages: (i) implicit figures can be limited to the markdown reader, and (ii) they can be deactivated by turning off the <code>implicit_figures</code> extension.</p></li>
<li><p><code>catch</code> from <code>Control.Exception</code> is now used instead of the old Preface <code>catch</code>.</p></li>
<li><p><code>Text.Pandoc.Shared</code>: Improved algorithm for <code>normalizeSpaces</code> and <code>oneOfStrings</code> (which is now non-backtracking).</p></li>
<li><p><code>Text.Pandoc.Biblio</code>: Remove workaround for <code>toCapital</code>. Now citeproc-hs is fixed upstream, so this is no longer needed. Closes #531.</p></li>
<li><p>Textile reader: Improved speed of <code>hyphenedWords</code>. This speeds up the textile reader by about a factor of 4.</p></li>
<li><p>Use <code>Text.Pandoc.Builder</code> in RST reader, for more flexibility, better performance, and automatic normalization.</p></li>
<li><p>Major rewrite of markdown reader:</p>
<ul>
<li>Use <code>Text.Pandoc.Builder</code> instead of lists. This also means that everything is normalized automatically.</li>
<li>Move to a one-pass parsing strategy, returning values in the reader monad, which are then run (at the end of parsing) against the final parser state.</li>
</ul></li>
<li><p>In HTML writer, we now use <code>toHtml</code> instead of pre-escaping. We work around the problem that blaze-html unnecessarily escapes <code>'</code> by pre-escaping just the <code>'</code> characters, instead of the whole string. If blaze-html later stops escaping <code>'</code> characters, we can simplify <code>strToHtml</code> to <code>toHtml</code>. Closes #629.</p></li>
<li><p>Moved code for embedding images in RTFs from <code>pandoc.hs</code> to the RTF writer (which now exports <code>writeRTFWithEmbeddedImages</code>).</p></li>
<li><p>Moved citation processing from <code>pandoc.hs</code> into the readers. This makes things more convenient for library users.</p></li>
<li><p>The man pages are now built by an executable <code>make-pandoc-man-pages</code>, which has its own stanza in the cabal file so that dependencies can be handled by Cabal. Special treatment in <code>Setup.hs</code> ensures that this executable never gets installed; it is only used to create the man pages.</p></li>
<li><p>The cabal file has been modified so that the pandoc library is used in building the pandoc executable. (This required moving <code>pandoc.hs</code> from <code>src</code> to <code>.</code>.) This cuts compile time in half.</p></li>
<li><p>The <code>executable</code> and <code>library</code> flags have been removed.</p></li>
<li><p><code>-threaded</code> has been removed from ghc-options.</p></li>
<li><p>Version bounds of dependencies have been raised, and the <code>blaze_html_0_5</code> flag now defaults to True. Pandoc now compiles on GHC 7.6.</p></li>
<li><p>We now require base &gt;= 4.2.</p></li>
<li><p>Integrated the benchmark program into cabal. One can now do:</p>
<pre><code>cabal configure --enable-benchmarks &amp;&amp; cabal build
cabal bench --benchmark-option=&#39;markdown&#39; --benchmark-option=&#39;-s 20&#39;</code></pre>
<p>The benchmark now uses README + testsuite, so benchmark results from older versions aren’t comparable.</p></li>
<li><p>Integrated test suite with cabal. To run tests, configure with <code>--enable-tests</code>, then <code>cabal test</code>. You can specify particular tests using <code>--test-options='-t markdown'</code>. No output is shown unless tests fail. The Haskell test modules have been moved from <code>src/</code> to <code>tests/</code>.</p></li>
<li><p>Moved all data files and templates to the <code>data/</code> subdirectory.</p></li>
<li><p>Added an <code>embed_data_files</code> cabal flag. This causes all data files to be embedded in the binary, so that the binary is self-sufficient and can be relocated anywhere, copied on a USB key, etc. The Windows installer now uses this. (Since we no longer have the option to build the executable without the library, this is the only way to get a relocatable binary on Windows.)</p></li>
<li><p>Removed pcre3.dll from windows package. It isn’t needed unless highlighting-kate is compiled with the <code>pcre-light</code> flag. By default, regex-prce-builtin is used.</p></li>
</ul>
<h1 id="pandoc-1.9.4.5-2012-10-21">pandoc 1.9.4.5 (2012-10-21)</h1>
<ul>
<li>Raised version bounds on network, base64-bytestring, json, and template-haskell.</li>
</ul>
<h1 id="pandoc-1.9.4.4-2012-10-20">pandoc 1.9.4.4 (2012-10-20)</h1>
<ul>
<li><p>Removed <code>tests</code> flag and made test suite into a proper cabal test suite, which can now be enabled using <code>--enable-tests</code> and run with <code>cabal test</code>.</p></li>
<li><p>Moved man page creation out of <code>Setup.hs</code> and into an executable built by Cabal, but never installed. This allows dependencies to be specified, and solves a problem with 1.9.4.3, which could only be installed if <code>data-default</code> had already been installed.</p></li>
<li><p>Updated <code>lhs-latex.tex</code> test for latest highlighting-kate representation of backticks.</p></li>
</ul>
<h1 id="pandoc-1.9.4.3-2012-10-20">pandoc 1.9.4.3 (2012-10-20)</h1>
<ul>
<li><p>Removed <code>-threaded</code> from default compile flags.</p></li>
<li><p>Modified modules to compile with GHC 7.6 and latest version of time package.</p></li>
</ul>
<h1 id="pandoc-1.9.4.2-2012-06-29">pandoc 1.9.4.2 (2012-06-29)</h1>
<ul>
<li><p>Don’t encode/decode file paths if base &gt;= 4.4. Prior to base 4.4, filepaths and command line arguments were treated as unencoded lists of bytes, not unicode strings, so we had to work around that by encoding and decoding them. This commit adds CPP checks for the base version that intelligibly enable encoding/decoding when needed. Fixes a bug with multilingual filenames when pandoc was compiled with ghc 7.4 (#540).</p></li>
<li><p>Don’t generate an empty H1 after hrule slide breaks. We now use a slide-level header with contents <code>[Str &quot;\0&quot;]</code> to mark an hrule break. This avoids creation of an empty H1 in these contexts. Closes #484.</p></li>
<li><p>Docbook reader: Added support for “bold” emphasis. Thanks to mb21.</p></li>
<li><p>In make_osx_package.sh, ensure citeproc-hs is built with the embed_data_files flag.</p></li>
<li><p>MediaWiki writer: Avoid extra blank lines after sublists (Gavin Beatty).</p></li>
<li><p>ConTeXt writer: Don’t escape <code>&amp;</code>, <code>^</code>, <code>&lt;</code>, <code>&gt;</code>, <code>_</code>, simplified escapes for <code>}</code> and <code>{</code> to <code>\{</code> and <code>\}</code> (Aditya Mahajan).</p></li>
<li><p>Fixed handling of absolute URLs in CSS imports with <code>--self-contained</code>. Closes #535.</p></li>
<li><p>Added webm to mime types. Closes #543.</p></li>
<li><p>Added some missing exports and tests to the cabal file (Alexander V Vershilov).</p></li>
<li><p>Compile with <code>-rtsopts</code> and <code>-threaded</code> by default.</p></li>
</ul>
<h1 id="pandoc-1.9.4.1-2012-06-08">pandoc 1.9.4.1 (2012-06-08)</h1>
<ul>
<li><p>Markdown reader: Added <code>cf.</code> and <code>cp.</code> to list of likely abbreviations.</p></li>
<li><p>LaTeX template: Added <code>linkcolor</code>, <code>urlcolor</code> and <code>links-as-notes</code> variables. Make TOC links black.</p></li>
<li><p>LaTeX template improvements.</p>
<ul>
<li>Don’t print date unless one is given explicitly in the document.</li>
<li>Simplified templates.</li>
<li>Use fontenc [T1] by default, and lmodern.</li>
<li>Use microtype if available.</li>
</ul></li>
<li><p>Biblio:</p>
<ul>
<li>Add comma to beginning of bare suffix, e.g. <code>@item1 [50]</code>. Motivation: <code>@item1 [50]</code> should be as close as possible to <code>[@item1, 50]</code>.</li>
<li>Added workaround for a bug in citeproc-hs 0.3.4 that causes footnotes beginning with a citation to be empty. Closes #531.</li>
</ul></li>
<li><p>Fixed documentation on mixed lists. Closes #533.</p></li>
</ul>
<h1 id="pandoc-1.9.4-2012-06-03">pandoc 1.9.4 (2012-06-03)</h1>
<ul>
<li><p>Simplified <code>Text.Pandoc.Biblio</code> and fixed bugs with citations inside footnotes and captions. We now handle note citations by inserting footnotes during initial citation processing, and doing a separate pass later to remove notes inside notes.</p></li>
<li><p>Added ‘zenburn’ highlight style from highlighting-kate.</p></li>
<li><p>Added Slideous writer. Slideous is an HTML + javascript slide show format, similar to Slidy, but works with IE 7. (Jonas Smedegaard)</p></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Ensure we don’t have extra blank lines at ends of cells. This can cause LaTeX errors, as they are interpreted as new paragraphs.</li>
<li>More consistent interblock spacing.</li>
<li>Require highlighting-kate &gt;= 0.5.1, for proper highlighted inline code in LaTeX. Closes #527.</li>
<li>Ensure that a Verbatim at the end of a footnote is followed by a newline. (Fixes a regression in the previous version.)</li>
<li>In default template, use black for internal links and TOC. Added commented-out code to use footnotes for links, as would be suitable in print output.</li>
</ul></li>
<li><p>Beamer writer: When <code>--incremental</code> is used, lists inside a block quote should appear all at once. (This makes Beamer output consistent with the HTML slide show formats.)</p></li>
<li><p>ConTeXt writer:</p>
<ul>
<li>Escape <code>%</code> as <code>\letterpercent{}</code> not <code>\letterpercent</code>, to avoid gobbling spaces after the <code>%</code> sign.</li>
<li>Ensure space after <code>\stopformula</code>.</li>
</ul></li>
<li><p>Markdown writer:</p>
<ul>
<li>Use <code>:</code> form instead of <code>~</code> in definition lists, for better compatibility with other markdown implementations.</li>
<li>Don’t wrap the term, because it breaks definition lists.</li>
<li>Use a nonzero space to prevent false recognition of list marker in ordered lists. Closes #516.</li>
</ul></li>
<li><p>Org writer: Add space before language name. Closes #523.</p></li>
<li><p>Docx writer: Simplified bullet characters so they work properly with Word 2007. Closes #520.</p></li>
<li><p>LaTeX reader: Support <code>\centerline</code>.</p></li>
<li><p>RST reader: handle figures. Closes #522.</p></li>
<li><p>Textile reader: fix for <code>&lt;notextile&gt;</code> and <code>==</code>. Closes #517. (Paul Rivier)</p></li>
</ul>
<h1 id="pandoc-1.9.3-2012-05-12">pandoc 1.9.3 (2012-05-12)</h1>
<ul>
<li><p>Added docbook reader (with contributions from Mauro Bieg).</p></li>
<li><p>Fixed bug in <code>fromEntities</code>. The previous version would turn <code>hi &amp; low you know;</code> into <code>hi &amp;</code>.</p></li>
<li><p>HTML reader:</p>
<ul>
<li>Don’t skip nonbreaking spaces. Previously a paragraph containing just <code>&amp;nbsp;</code> would be rendered as an empty paragraph. Thanks to Paul Vorbach for pointing out the bug.</li>
<li>Support <code>&lt;col&gt;</code> and <code>&lt;caption&gt;</code> in tables. Closes #486.</li>
</ul></li>
<li><p>Markdown reader:</p>
<ul>
<li>Don’t recognize references inside delimited code blocks.</li>
<li>Allow list items to begin with lists.</li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Handle <code>\bgroup</code>, <code>\egroup</code>, <code>\begingroup</code>, <code>\endgroup</code>.</li>
<li>Control sequences can’t be followed by a letter. This fixes a bug where <code>\begingroup</code> was parsed as <code>\begin</code> followed by <code>group</code>.</li>
<li>Parse ‘dimension’ arguments to unknown commands. e.g. <code>\parindent0pt</code></li>
<li>Make <code>\label</code> and <code>\ref</code> sensitive to <code>--parse-raw</code>. If <code>--parse-raw</code> is selected, these will be parsed as raw latex inlines, rather than bracketed text.</li>
<li>Don’t crash on unknown block commands (like <code>\vspace{10pt}</code>) inside <code>\author</code>; just skip them. Closes #505.</li>
</ul></li>
<li><p>Textile reader:</p>
<ul>
<li>Implemented literal escapes with <code>==</code> and <code>&lt;notextile&gt;</code>. Closes #473.</li>
<li>Added support for LaTeX blocks and inlines (Paul Rivier).</li>
<li>Better conformance to RedCloth inline parsing (Paul Rivier).</li>
<li>Parse ‘+text+’ as emphasized (should be underlined, but this is better than leaving literal plus characters in the output.</li>
</ul></li>
<li><p>Docx writer: Fixed multi-paragraph list items. Previously they each got a list marker. Closes #457.</p></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Added <code>--no-tex-ligatures</code> option to avoid replacing quotation marks and dashes with TeX ligatures.</li>
<li>Use <code>fixltx2e</code> package to provide ’.</li>
<li>Improve spacing around LaTeX block environments: quote, verbatim, itemize, description, enumerate. Closes #502.</li>
<li>Use blue instead of pink for URL links in latex/pdf output.</li>
</ul></li>
<li><p>ConTeXt writer: Fixed escaping of <code>%</code>. In text, <code>%</code> needs to be escaped as <code>\letterpercent</code>, not <code>\%</code> Inside URLs, <code>%</code> needs to be escaped as <code>\%</code> Thanks to jmarca and adityam for the fix. Closes #492.</p></li>
<li><p>Texinfo writer: Escape special characters in node titles. This fixes a problem pointed out by Joost Kremers. Pandoc used to escape an ‘@’ in a chapter title, but not in the corresponding node title, leading to invalid texinfo.</p></li>
<li><p>Fixed document encoding in texinfo template. Resolves Debian Bug #667816.</p></li>
<li><p>Markdown writer:</p>
<ul>
<li>Don’t force delimited code blocks to be flush left. Fixes bug with delimited code blocks inside lists etc.</li>
<li>Escape <code>&lt;</code> and <code>$</code>.</li>
</ul></li>
<li><p>LaTeX writer: Use <code>\hyperref[ident]{text}</code> for internal links. Previously we used <code>\href{\#ident}{text}</code>, which didn’t work on all systems. Thanks to Dirk Laurie.</p></li>
<li><p>RST writer: Don’t wrap link references. Closes #487.</p></li>
<li><p>Updated to use latest versions of blaze-html, mtl.</p></li>
</ul>
<h1 id="pandoc-1.9.2-2012-04-05">pandoc 1.9.2 (2012-04-05)</h1>
<ul>
<li><p>LaTeX reader:</p>
<ul>
<li>Made <code>lstlisting</code> work as a proper verbatim environment.</li>
<li>Fixed bug parsing LaTeX tables with one column.</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Use <code>{}</code> around <code>ctable</code> caption, so that formatting can be used.</li>
<li>Don’t require eurosym package unless document has a €.</li>
</ul></li>
<li><p>LaTeX template: Added variables for <code>geometry</code>, <code>romanfont</code>, <code>sansfont</code>, <code>mathfont</code>, <code>mainfont</code> so users can more easily customize fonts.</p></li>
<li><p>PDF writer:</p>
<ul>
<li>Run latex engine at least two times, to ensure that PDFs will have hyperlinked bookmarks.</li>
<li>Added PDF metadata (title,author) in LaTeX standalone + PDF output.</li>
</ul></li>
<li><p>Texinfo writer: retain directories in image paths. (Peter Wang)</p></li>
<li><p>RST writer: Better handling of inline formatting, in accord with docutils’ “inline markup recognition rules” (though we don’t implement the unicode rules fully). Now <code>hi*there*hi</code> gets rendered properly as <code>hi\ *there*\ hi</code>, and unnecessary <code>\</code> are avoided around <code>:math:</code>, <code>:sub:</code>, <code>:sup:</code>.</p></li>
<li><p>RST reader:</p>
<ul>
<li>Parse <code>\</code> as null, not escaped space.</li>
<li>Allow <code>:math:`...`</code> even when not followed by blank or <code>\</code>. This does not implement the complex rule docutils follows, but it should be good enough for most purposes.</li>
<li>Add support for the rST default-role directive. (Greg Maslov)</li>
</ul></li>
<li><p>Text.Pandoc.Parsing: Added <code>stateRstDefaultRole</code> field to <code>ParserState</code>. (Greg Maslov)</p></li>
<li><p>Markdown reader: Properly handle citations nested in other inline elements.</p></li>
<li><p>Markdown writer: don’t replace empty alt in image with “image”.</p></li>
<li><p>DZSlides: Updated template.html and styles in default template. Removed bizarre CSS for <code>q</code> in dzslides template.</p></li>
<li><p>Avoid repeated <code>id</code> attribute in section and header in HTML slides.</p></li>
<li><p>README improvements: new instructions on internal links, removed misleading note on reST math.</p></li>
<li><p>Build system:</p>
<ul>
<li>Fixed Windows installer so that dzslides works.</li>
<li>Removed stripansi.sh.</li>
<li>Added .travis.yml for Travis continuous integration support..</li>
<li>Fixed upper bound for zlib (Sergei Trofimovich).</li>
<li>Fixed upper bound for test-framework.</li>
<li>Updated haddocks for haddock-2.10 (Sergei Trofimovich).</li>
</ul></li>
</ul>
<h1 id="pandoc-1.9.1.2-2012-03-09">pandoc 1.9.1.2 (2012-03-09)</h1>
<ul>
<li><p>Added <code>beamer+lhs</code> as output format.</p></li>
<li><p>Don’t escape <code>&lt;</code> in <code>&lt;style&gt;</code> tags with <code>--self-contained</code>. This fixes a bug which prevented highlighting from working when using <code>--self-contained</code>.</p></li>
<li><p>PDF: run latex engine three times if <code>--toc</code> specified. This fixes page numbers in the table of contents.</p></li>
<li><p>Docx writer: Added TableNormal style to tables.</p></li>
<li><p>LaTeX math environment fixes. <code>aligned</code> is now used instead of the nonexistent <code>aligned*</code>. <code>multline</code> instead of the nonexistent <code>multiline</code>.</p></li>
<li><p>LaTeX writer: Use <code>\textasciitilde</code> for literal <code>~</code>.</p></li>
<li><p>HTML writer: Don’t escape contents of EQ tags with –gladtex. This fixes a regression from 1.8.</p></li>
<li><p>Use <code>&lt;q&gt;</code> tags for Quoted items for HTML5 output. The quote style can be changed by modifying the template or including a css file. A default quote style is included.</p></li>
<li><p>LaTeX reader: Fixed accents (~{a}, <code>\c{c}</code>). Correctly handle ^{}. Support “minted” as a LaTeX verbatim block.</p></li>
<li><p>Updated LaTeX template for better language support. Use <code>polyglossia</code> instead of <code>babel</code> with xetex. Set <code>lang</code> as documentclass option. <code>\setmainlanguage</code> will use the last of a comma-separated list of languages. Thanks to François Gannaz.</p></li>
<li><p>Fixed default LaTeX template so <code>\euro</code> and <code>€</code> work. The <code>eurosym</code> package is needed if you are using pdflatex.</p></li>
<li><p>Fixed escaping of period in man writer (thanks to Michael Thompson).</p></li>
<li><p>Fixed list label positions in beamer.</p></li>
<li><p>Set <code>mainlang</code> variable in context writer. This parallels behavior of latex writer. <code>mainlang</code> is the last of a comma-separated list of languages in lang.</p></li>
<li><p>EPUB language metadat: convert e.g. <code>en_US</code> from locale to <code>en-US</code>.</p></li>
<li><p>Changed <code>-V</code> so that you can specify a key without a value. Such keys get the value <code>true</code>.</p></li>
<li><p>Fixed permissions on installed man pages - thanks Magnus Therning.</p></li>
<li><p>Windows installer: require XP or higher. The installer is now compiled on a Windows 7 machine, which fixes a problem using citation functions on Windows 7.</p></li>
<li><p>OSX package: Check for 64-bit Intel CPU before installing.</p></li>
</ul>
<h1 id="pandoc-1.9.1.1-2012-02-11">pandoc 1.9.1.1 (2012-02-11)</h1>
<ul>
<li><p>Better handling of raw latex environments in markdown. Now</p>
<pre><code>\begin{equation}
a_1
\end{equation}</code></pre>
<p>turns into a raw latex block as expected.</p></li>
<li><p>Improvements to LaTeX reader:</p>
<ul>
<li>Skip options after block commands.</li>
<li>Correctly handle <code>{\\}</code> in braced.</li>
<li>Added a needed ‘try’.</li>
<li>Citations: add <code>,</code> to suffix if it doesn’t start with space or punctuation. Otherwise we get no space between the year and the suffix in author-date styles.</li>
</ul></li>
<li><p>Added two needed data files for S5. This fixes a problem with <code>pandoc -t s5 --self-contained</code>. Also removed <code>slides.min.js</code>, which was no longer being used.</p></li>
<li><p>Fixed some minor problems in <code>reference.docx</code>: name on “Date” style, <code>xCs</code> instead of <code>xIs</code>.</p></li>
<li><p>Fixed a problem creating docx files using a reference docx modified using Word. The problem seems to be that Word modifies <code>_rels/.rels</code>, changing the Type of the Relationship to <code>docProps/core.xml</code>. Pandoc now changes this back to the correct value if it has been altered, fixing the problem.</p></li>
<li><p>Fixed html5 template so it works properly with highlighting.</p></li>
</ul>
<h1 id="pandoc-1.9.1-2012-02-09">pandoc 1.9.1 (2012-02-09)</h1>
<ul>
<li><p>LaTeX reader:</p>
<ul>
<li>Fixed regression in 1.9; properly handle escaped $ in latex math.</li>
<li>Put LaTeX verse environments in blockquotes.</li>
</ul></li>
<li><p>Markdown reader:</p>
<ul>
<li>Limit nesting of strong/emph. This avoids exponential lookahead in parasitic cases, like <code>a**a*a**a*a**a*a**a*a**a*a**a*a**a*a**</code>.</li>
<li>Improved attributes syntax (in code blocks/spans): (1) Attributes can contain line breaks. (2) Values in key-value attributes can be surrounded by either double or single quotes, or left unquoted if they contain no spaces.</li>
</ul></li>
<li><p>Headers no longer wrap in markdown or RST writers.</p></li>
<li><p>Added <code>stateMaxNestingLevel</code> to <code>ParserState</code>. We set this to 6, so you can still have <code>Emph</code> inside <code>Emph</code>, just not indefinitely.</p></li>
<li><p>More efficient implementation of <code>nowrap</code> in <code>Text.Pandoc.Pretty</code>.</p></li>
<li><p><code>Text.Pandoc.PDF</code>: Only run latex twice if <code>\tableofcontents</code> is present.</p></li>
<li><p>Require highlighting-kate &gt;= 0.5.0.2, texmath &gt;= 0.6.0.2.</p></li>
</ul>
<h1 id="pandoc-1.9.0.5-2012-02-06">pandoc 1.9.0.5 (2012-02-06)</h1>
<ul>
<li><p>Changed cabal file so that build-depends for the test program are not required unless the tests flag is used.</p></li>
<li><p>LaTeX writer: insert <code>{}</code> between adjacent hyphens so they don’t form ligatures (dashes) in code spans.</p></li>
</ul>
<h1 id="pandoc-1.9.0.4-2012-02-06">pandoc 1.9.0.4 (2012-02-06)</h1>
<ul>
<li><p>Raised version bound on test-framework to avoid problems compiling tests on GHC 7.4.1.</p></li>
<li><p>LaTeX reader: Use raw LaTeX as fallback inline text for Cites, so citations don’t just disappear unless you process with citeproc. Ignore <code>\bibliographystyle</code>, <code>\nocite</code>.</p></li>
<li><p>Simplified tex2pdf; it will always run latex twice to resolve table of contents and hyperrefs.</p></li>
</ul>
<h1 id="pandoc-1.9.0.3-2012-02-06">pandoc 1.9.0.3 (2012-02-06)</h1>
<ul>
<li><p>Require Cabal &gt;= 1.10.</p></li>
<li><p>Tweaked cabal file to meet Cabal 1.10 requirements.</p></li>
</ul>
<h1 id="pandoc-1.9.0.2-2012-02-05">pandoc 1.9.0.2 (2012-02-05)</h1>
<ul>
<li>Allow build with json 0.4 or 0.5. Otherwise we can’t build with ghc 6.12.</li>
</ul>
<h1 id="pandoc-1.9-2012-02-05">pandoc 1.9 (2012-02-05)</h1>
<h2 id="new-features-5">New features</h2>
<ul>
<li><p>Added a Microsoft Word <code>docx</code> writer. The writer includes support for highlighted code and for math (which is converted from TeX to OMML, Office’s native math markup language, using texmath’s new OMML module). A new option <code>--reference-docx</code> allows the user to customize the styles.</p></li>
<li><p>Added an <code>asciidoc</code> writer (<a href="http://www.methods.co.nz/asciidoc/" class="uri">http://www.methods.co.nz/asciidoc/</a>).</p></li>
<li><p>Better support for slide shows:</p>
<ul>
<li><p>Added a <code>dzslides</code> writer. DZSlides is a lightweight HTML5/javascript slide show format due to Paul Rouget (<a href="http://paulrouget.com/dzslides/" class="uri">http://paulrouget.com/dzslides/</a>).</p></li>
<li><p>Added a LaTeX <code>beamer</code> writer. Beamer is a LaTeX package for creating slide presentations.</p></li>
<li><p>New, flexible rules for dividing documents into sections and slides (see the “Structuring the slide show” in the User’s Guide). These are backward-compatible with the old rules, but they allow slide shows to be organized into sections and subsections containing multiple slides.</p></li>
<li><p>A new <code>--slide-level</code> option allows users to override defaults and select a slide level below the first header level with content.</p></li>
</ul></li>
<li><p>A new <code>--self-contained</code> option produces HTML output that does not depend on an internet connection or the presence of any external files. Linked images, CSS, and javascript is downloaded (or fetched locally) and encoded in <code>data:</code> URIs. This is useful for making portable <code>HTML slide shows. The --offline</code> option has been deprecated and is now <code>treated as a synonym or --self-contained</code>.</p></li>
<li><p>Support for PDF output:</p>
<ul>
<li>Removed the old <code>markdown2pdf</code>.</li>
<li><code>pandoc</code> can now create PDFs (assuming you have latex and a set of appropriate packages installed): just specify an output file with the <code>.pdf</code> extension.</li>
<li>A new option <code>--latex-engine</code> allows you to specify <code>pdflatex</code>, <code>xelatex</code>, or <code>lualatex</code> as the processor.</li>
</ul></li>
<li><p>Highlighting changes:</p>
<ul>
<li>Syntax highlighting is now a standard feature; the <code>highlighting</code> flag is no longer needed when compiling.</li>
<li>A new <code>--no-highlight</code> option allows highlighting to be disabled.</li>
<li>Highlighting now works in <code>docx</code>, <code>latex</code>, and <code>epub</code>, as well as <code>html</code>, <code>html5</code>, <code>dzslides</code>, <code>s5</code>, and <code>slidy</code>.</li>
<li>A new <code>--highlight-style</code> option selects between various highlighting color themes.</li>
</ul></li>
<li><p>Internal links to sections now work in ConTeXt and LaTeX as well as HTML.</p></li>
<li><p>LaTeX <code>\include</code> and <code>\usepackage</code> commands are now processed, provided the files are in the working directory.</p></li>
<li><p>EPUB improvements:</p>
<ul>
<li>Internal and external links now work in EPUB.</li>
<li>Raw HTML is allowed.</li>
<li>New <code>--epub-embed-font</code> option.</li>
<li>Customizable templates for EPUB pages offer more control over formatting: <code>epub-page.html</code>, <code>epub-coverimage.html</code>, <code>epub-titlepage.html</code>.</li>
</ul></li>
<li><p><code>--mathml</code> now works with DocBook.</p></li>
<li><p>Added support for math in RST reader and writer. Inline math uses the <code>:math:`...`</code> construct. Display math uses</p>
<pre><code>.. math:: ...</code></pre>
<p>or if the math is multiline,</p>
<pre><code>.. math::

   ...</code></pre>
<p>These constructions are now supported now by <code>rst2latex.py</code>.</p></li>
<li><p>Github syntax for fenced code blocks is supported in pandoc’s markdown. You can now write</p>
<pre><code>```ruby
x = 2
```</code></pre>
<p>instead of</p>
<pre><code>~~~ {.ruby}
x = 2
~~~~</code></pre></li>
<li><p>Easier scripting: a new <code>toJsonFilter</code> function makes it easier to write Haskell scripts to manipulate the Pandoc AST. See <a href="scripting.html#pandoc-1.9-changes">Scripting with pandoc</a>.</p></li>
</ul>
<h2 id="behavior-changes-5">Behavior changes</h2>
<ul>
<li><p>Fixed parsing of consecutive lists in markdown. Pandoc previously behaved like Markdown.pl for consecutive lists of different styles. Thus, the following would be parsed as a single ordered list, rather than an ordered list followed by an unordered list:</p>
<pre><code>1. one
2. two

- one
- two</code></pre>
<p>This change makes pandoc behave more sensibly, parsing this as two lists. Any change in list type (ordered/unordered) or in list number style will trigger a new list. Thus, the following will also be parsed as two lists:</p>
<pre><code>1. one
2. two

a. one
b. two</code></pre>
<p>Since we regard this as a bug in Markdown.pl, and not something anyone would ever rely on, we do not preserve the old behavior even when <code>--strict</code> is selected.</p></li>
<li><p>Dashes work differently with <code>--smart</code>: <code>---</code> is always em-dash, and <code>--</code> is always en-dash. Pandoc no longer tries to guess when <code>-</code> should be en-dash. <em>Note:</em> This may change how existing documents look when processed with pandoc. A new option, <code>--old-dashes</code>, is provided for legacy documents.</p></li>
<li><p>The markdown writer now uses setext headers for levels 1-2. The old behavior (ATX headers for all levels) can be restored using the new <code>--atx-headers</code> option.</p></li>
<li><p>Links are now allowed in markdown image captions. They are also allowed in links, but will appear there as regular text. So,</p>
<pre><code>[link with [link](/url)](/url)</code></pre>
<p>will turn into</p>
<pre><code>&lt;p&gt;&lt;a href=&quot;/url&quot;&gt;link with link&lt;/a&gt;&lt;/p&gt;</code></pre></li>
<li><p>Improved handling of citations using <code>citeproc-hs-0.3.4</code>. Added <code>--citation-abbreviations</code> option.</p></li>
<li><p>Citation keys can no longer end with a punctuation character. This means that <code>@item1.</code> will be parsed as a citation with key ‘item1’, followed by a period, instead of a citation with key ‘item1.’, as was the case previously.</p></li>
<li><p>In HTML output, citations are now put in a span with class <code>citation</code>.</p></li>
<li><p>The markdown reader now recognizes DocBook block and inline tags. It was always possible to include raw DocBook tags in a markdown document, but now pandoc will be able to distinguish block from inline tags and behave accordingly. Thus, for example,</p>
<pre><code>&lt;sidebar&gt;
hello
&lt;/sidebar&gt;</code></pre>
<p>will not be wrapped in <code>&lt;para&gt;</code> tags.</p></li>
<li><p>The LaTeX parser has been completely rewritten; it is now much more accurate, robust, and extensible. However, there are two important changes in how it treats unknown LaTeX. (1) Previously, unknown environments became BlockQuote elements; now, they are treated as “transparent”, so <code>\begin{unknown}xyz\end{unknown}</code> is the same as <code>xyz</code>. (2) Previously, arguments of unknown commands were passed through with their braces; now the braces are stripped off.</p></li>
<li><p><code>--smart</code> is no longer selected automatically with <code>man</code> output.</p></li>
<li><p>The deprecated <code>--xetex</code> option has been removed.</p></li>
<li><p>The <code>--html5</code>/<code>-5</code> option has been deprecated. Use <code>-t html5</code> instead. <code>html5</code> and <code>html5+lhs</code> are now separate output formats.</p></li>
<li><p>Single quotes are no longer escaped in HTML output. They do not need to be escaped outside of attributes.</p></li>
<li><p>Pandoc will no longer transform leading newlines in code blocks to <code>&lt;br/&gt;</code> tags.</p></li>
<li><p>The ODT writer now sizes images appropriately, using the image size and DPI information embedded in the image.</p></li>
<li><p><code>--standalone</code> is once again implicitly for a non-text output format (ODT, EPUB). You can again do <code>pandoc test.txt -o test.odt</code> and get a standalone ODT file.</p></li>
<li><p>The Docbook writer now uses <code>&lt;sect1&gt;</code>, <code>&lt;sect2&gt;</code>, etc. instead of <code>&lt;section&gt;</code>.</p></li>
<li><p>The HTML writer now uses <code>&lt;del&gt;</code> for strikeout.</p></li>
<li><p>In HTML output with <code>--section-divs</code>, the classes <code>section</code> and <code>level[1,2,..6]</code> are put on the <code>div</code> tags so they can be styled. In HTML 5 output with <code>--section-divs</code>, the classes <code>level[1,2,...6]</code> are put on <code>section</code> tags.</p></li>
<li><p>EPUB writer changes:</p>
<ul>
<li>The <code>lang</code> variable now sets the language in the metadata (if it is not set, we default to the locale).</li>
<li>EPUB: UTF-8 is used rather than decimal entities.</li>
</ul></li>
<li><p>Added <code>titleslide</code> class to title slide in S5 template.</p></li>
<li><p>In HTML, EPUB, and docx metadata, the date is normalized into YYYY-MM-DD format if possible. (This is required for validation.)</p></li>
<li><p>Attributes in highlighted code blocks are now preserved in HTML. The container element will have the classes, id, and key-value attributes you specified in the delimited code block. Previously these were stripped off.</p></li>
<li><p>The reference backlink in the HTML writer no longer has a special <code>footnoteBacklink</code> class.</p></li>
<li><p>The HTML template has been split into <code>html</code> and <code>html5</code> templates.</p></li>
<li><p>Author and date are treated more consistently in HTML templates. Authors are now <code>&lt;h2&gt;</code>, date <code>&lt;h3&gt;</code>.</p></li>
<li><p>URLs are hyphenated in the ConTeXt writer (B. Scott Michel).</p></li>
<li><p>In <code>Text.Pandoc.Builder</code>, <code>+++</code> has been replaced by <code>&lt;&gt;</code>.</p></li>
</ul>
<h2 id="bug-fixes-4">Bug fixes</h2>
<ul>
<li><p>Better support for combining characters and East Asian wide characters in markdown and reST.</p></li>
<li><p>Better handling of single quotes with <code>--smart</code>. Previously <code>D'oh l'*aide*</code> would be parsed with left and right single quotes instead of apostrophes. This kind of error is now fixed.</p></li>
<li><p>Highlighting: Use <code>reads</code> instead of <code>read</code> for better error handling. Fixes crash on <code>startNum=&quot;abc&quot;</code>.</p></li>
<li><p>Added blank comment after directives in rst template.</p></li>
<li><p>Unescape entities in citation <code>refId</code>. The <code>refId</code>s coming from citeproc contain XML numeric entities, and these don’t match with the citation keys parsed by pandoc. Solution is to unescape them.</p></li>
<li><p>HTML reader: Fixed bug parsing tables with both thead and tbody.</p></li>
<li><p>Markdown reader:</p>
<ul>
<li>Better handling of escapes in link URLs and titles.</li>
<li>Fixed backslash escapes in reference links.</li>
<li>Fixed bug in table/hrule parsing, by checking that the top line of a table is not followed by a blank line. This bug caused slowdowns on some files with hrules and tables, as pandoc tried to interpret the hrules as the tops of multiline tables.</li>
<li>Fixed bug in code block attribute parser. Previously the ID attribute got lost if it didn’t come first. Now attributes can come in any order.</li>
</ul></li>
<li><p>RST reader: allow footnotes followed by newline without space characters.</p></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Ignore empty groups {}, { }.</li>
<li>LaTeX reader: Handle <code>\@</code>.</li>
<li>LaTeX reader: Don’t crash on commands like <code>\itemsep</code>.</li>
<li>LaTeX reader: Better handling of letter environments.</li>
</ul></li>
<li><p>RST writer: Fixed bug involving empty table cells. isSimple was being calculated in a way that assumed there were no non-empty cells.</p></li>
<li><p>ConTeXt writer:</p>
<ul>
<li>Made <code>--toc</code> work even without <code>--number-sections</code>.</li>
<li>Escape # in link URLs.</li>
<li>Use buffering for footnotes containing code blocks.</li>
<li>Changed ‘descr’ to ‘description’, fixed alignment.</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Escape euro character.</li>
<li>Don’t escape <code>~</code> inside <code>\href{...}</code>.</li>
<li>Escape <code>#</code> in href URLs.</li>
<li>Improved detection of book classes. We now check the <code>documentclass</code> variable, and if that is not set, we look through the template itself. Also, we have added the KOMA classes scrreprt and scrbook. You can now make a book using <code>pandoc -V documentclass:book mybook.txt -o mybook.pdf</code></li>
<li>LHS files now set the “listings” variable, so that the definition of the <code>code</code> environment will be included in the template.</li>
<li>Links are colored blue by default (this can be changed by modifying <code>hyperref</code> settings in the template).</li>
<li>Added <code>lang</code> variable to LaTeX template.</li>
</ul></li>
<li><p>HTML writer:</p>
<ul>
<li>Fixed bug in HTML template with html5 and mathml.</li>
<li>Don’t use self-closing img, br, hr tags for HTML5.</li>
<li>Use <code>&lt;section&gt;</code> for footnotes if HTML5.</li>
<li>Update HTML templates to use Content-Style-Type meta tag.</li>
<li>Use separate variables for meta-date, meta-author. This makes footnotes work in author and date fields.</li>
<li>Use ‘vertical-align:middle’ in WebTeX math for better alignment.</li>
</ul></li>
<li><p>S5/slidy writer: Make footnotes appear on separate slide at end.</p></li>
<li><p>MIME: Added ‘layout-cache’ to getMimeType. This ensures that the META-INF/manifest.xml for ODT files will have everything it needs, so that ODT files modified by LibreOffice can be used as <code>--reference-odt</code>.</p></li>
<li><p><code>Text.Pandoc.Templates</code>: Return empty string for json template.</p></li>
<li><p><code>Text.Pandoc.Biblio</code>:</p>
<ul>
<li>Expand citations recursively inside nested inlines.</li>
<li>Treat <code>\160</code> as space when parsing locator and suffix. This fixes a bug with “p. 33” when <code>--smart</code> is used. Previously the whole “p. 33” would be included in the suffix, with no locator.</li>
<li>Put whole author-in-text citation in a Cite. Previously just the date and other info went in the Cite.</li>
<li>Don’t add comma+space to prefix if it ends in punctuation.</li>
</ul></li>
<li><p>Updated chicago-author-date.csl. The old version did not work properly for edited volumes with no author.</p></li>
<li><p>EPUB writer:</p>
<ul>
<li>Add date to EPUB titlepage and metadata.</li>
<li>Added TOC identifier in EPUB page template.</li>
<li>Don’t generate superfluous file <code>cover-image.jpg</code>.</li>
</ul></li>
</ul>
<h2 id="under-the-hood-improvements-4">Under the hood improvements</h2>
<ul>
<li><p>Modified <code>make_osx_package.sh</code> to use cabal-dev. Items are no longer installed as root. Man pages are zipped and given proper permissions.</p></li>
<li><p>Modified windows installer generater to use cabal-dev.</p></li>
<li><p>Setup: Making man pages now works with cabal-dev (at least on OSX). In Setup.hs we now invoke ‘runghc’ in a way that points it to the correct package databases, instead of always falling back to the default user package db.</p></li>
<li><p>Updated to work with GHC 7.4.1.</p></li>
<li><p>Removed dependency on old-time.</p></li>
<li><p>Removed dependency on dlist.</p></li>
<li><p>New slidy directory for “self-contained.”</p></li>
<li><p>TeXMath writer: Use unicode thin spaces for thin spaces.</p></li>
<li><p>Markdown citations: don’t strip off initial space in locator.</p></li>
</ul>
<h2 id="api-changes-5">API changes</h2>
<ul>
<li><p>Removed <code>Apostrophe</code>, <code>EmDash</code>, <code>EnDash</code>, and <code>Ellipses</code> from the native <code>Inline</code> type in pandoc-types. Now we use <code>Str</code> elements with unicode.</p></li>
<li><p>Improvements to <code>Text.Pandoc.Builder</code>:</p>
<ul>
<li><code>Inlines</code> and <code>Blocks</code> are now newtypes (not synonyms for sequences).</li>
<li>Instances are defined for <code>IsString</code>, <code>Show</code>, <code>Read</code>, <code>Monoid</code>, and a new <code>Listable</code> class, which allows these to be manipulated to some extent like lists. Monoid append includes automatic normalization.</li>
<li><code>+++</code> has been replaced by <code>&lt;&gt;</code> (mappend).</li>
</ul></li>
<li><p>Use blaze-html instead of xhtml for HTML generation. This changes the type of <code>writeHtml</code>.</p></li>
<li><p><code>Text.Pandoc.Shared</code>:</p>
<ul>
<li>Added <code>warn</code> and <code>err</code>.</li>
<li>Removed <code>unescapeURI</code>, modified <code>escapeURI</code>. (See under <a href="#behavior-changes-5">behavior changes</a>, above.)</li>
</ul></li>
<li><p>Changes in URI escaping: Previously the readers escaped URIs by converting unicode characters to octets and then percent encoding. Now unicode characters are left as they are, and <code>escapeURI</code> only percent-encodes space characters. This gives more readable URIs, and works well with modern user agents. URIs are no longer unescaped at all on conversion to <code>markdown</code>, <code>asciidoc</code>, <code>rst</code>, <code>org</code>.</p></li>
<li><p>New module <code>Text.Pandoc.SelfContained</code>.</p></li>
<li><p>New module <code>Text.Pandoc.Docx</code>.</p></li>
<li><p>New module <code>Text.Pandoc.PDF</code>.</p></li>
<li><p>Added <code>writerBeamer</code> to <code>WriterOptions</code>.</p></li>
<li><p>Added <code>normalizeDate</code> to <code>Text.Pandoc.Shared</code>.</p></li>
<li><p>Added <code>splitStringWithIndices</code> in <code>Text.Pandoc.Shared</code>. This is like <code>splitWithIndices</code>, but it is sensitive to distinctions between wide, combining, and regular characters.</p></li>
<li><p><code>Text.Pandoc.Pretty</code>:</p>
<ul>
<li>Added <code>chomp</code> combinator.</li>
<li>Added <code>beforeNonBreak</code> combinator. This allows you to include something conditionally on it being before a nonblank. Used for RST inline math.</li>
<li>Added <code>charWidth</code> function. All characters marked W or F in the unicode spec EastAsianWidth.txt get width 2.</li>
<li>Added <code>realLength</code>, based on <code>charWidth</code>. <code>realLength</code> is now used in calculating offsets.</li>
</ul></li>
<li><p>New module <code>Text.Pandoc.Slides</code>, for common functions for breaking a document into slides.</p></li>
<li><p>Removed <code>Text.Pandoc.S5</code>, which is no longer needed.</p></li>
<li><p>Removed <code>Text.Pandoc.CharacterReferences</code>. Moved <code>characterReference</code> to <code>Text.Pandoc.Parsing</code>. <code>decodeCharacterReferences</code> is replaced by <code>fromEntities</code> in <code>Text.Pandoc.XML</code>.</p></li>
<li><p>Added <code>Text.Pandoc.ImageSize</code>. This is intened for use in <code>docx</code> and <code>odt</code> writers, so the size and dpi of images can be calculated.</p></li>
<li><p>Removed <code>writerAscii</code> in <code>WriterOptions</code>.</p></li>
<li><p>Added <code>writerHighlight</code> to <code>WriterOptions</code>.</p></li>
<li><p>Added <code>DZSlides</code> to <code>HTMLSlideVariant</code>.</p></li>
<li><p><code>writeEPUB</code> has a new argument for font files to embed.</p></li>
<li><p>Added <code>stateLastStrPos</code> to <code>ParserState</code>. This lets us keep track of whether we’re parsing the position immediately after a regular (non-space, non-symbol) string, which is useful for distinguishing apostrophes from single quote starts.</p></li>
<li><p><code>Text.Pandoc.Parsing</code>:</p>
<ul>
<li><code>escaped</code> now returns a <code>Char</code>.</li>
<li>Removed <code>charsInBalanced'</code>, added a character parser as a parameter of <code>charsInBalanced</code>. This is needed for proper handling of escapes, etc.</li>
<li>Added <code>withRaw</code>.</li>
</ul></li>
<li><p>Added <code>toEntities</code> to <code>Text.Pandoc.XML</code>.</p></li>
<li><p><code>Text.Pandoc.Readers.LaTeX</code>:</p>
<ul>
<li>Export <code>handleIncludes</code>.</li>
<li>Export <code>rawLaTeXBlock</code> instead of <code>rawLaTeXEnvironment'</code>.</li>
</ul></li>
<li><p>Added <code>ToJsonFilter</code> class and <code>toJsonFilter</code> function to <code>Text.Pandoc</code>, deprecating the old <code>jsonFilter</code> function.</p></li>
<li><p><code>Text.Pandoc.Highlighting</code>:</p>
<ul>
<li>Removed <code>highlightHtml</code>, <code>defaultHighlightingCss</code>.</li>
<li>Export <code>formatLaTeXInline</code>, <code>formatLaTeXBlock</code>, and <code>highlight</code>, plus key functions from highlighting-kate.</li>
<li>Changed types of highlighting function. <code>highlight</code> returns a <code>Maybe</code>, not an <code>Either</code>.</li>
</ul></li>
</ul>
<h1 id="pandoc-1.8.2.1-2011-08-01">pandoc 1.8.2.1 (2011-08-01)</h1>
<ul>
<li><p>Adjusted Arbitrary instance to help avoid timeouts in tests.</p></li>
<li><p>Added <code>Tests.Writers.Markdown</code> to cabal file.</p></li>
<li><p>Relaxed version bounds on pandoc-types, test-framework.</p></li>
</ul>
<h1 id="pandoc-1.8.2-2011-07-30">pandoc 1.8.2 (2011-07-30)</h1>
<ul>
<li><p>Added script to produce OS X package.</p></li>
<li><p>Made <code>templates</code> directory a git submodule. This should make it easier for people to revise their custom templates when the default templates change.</p></li>
<li><p>Changed template naming scheme: <code>FORMAT.template</code> -&gt; <code>default.FORMAT</code>. <strong>Note:</strong> If you have existing templates in <code>~/.pandoc/templates</code>, you must rename them to conform to the new scheme!</p></li>
<li><p>Default template improvements:</p>
<ul>
<li>HTML: Display author and date after title.</li>
<li>HTML: Made table of contents more customizable. The container for the TOC is now in the template, so users can insert a header or other styling. (Thanks to Bruce D’Arcus for the suggestion.)</li>
<li>HTML, Slidy, S5: Enclose scripts in CDATA tags.</li>
<li>Slidy, S5: Added <code>s5-url</code> and <code>slidy-url</code> variables, instead of hard-coding. If you want to put your slidy files in the slidy subdirectory, for example, you can do <code>pandoc -t slidy -V slidy-url=slidy -s</code>.</li>
<li>LaTeX: Use <code>\and</code> to separate authors in LaTeX documents (reader &amp; writer). Closes #279.</li>
<li>LaTeX: Set <code>\emergencystretch</code> to prevent overfull lines.</li>
<li>LaTeX: Use different <code>hyperref</code> options for <code>xetex</code>, fixing problems with unicode bookmarks (thanks to CircleCode).</li>
<li>LaTeX: Removed <code>ucs</code> package, use <code>utf8</code> rather than <code>utf8x</code> with <code>inputenc</code>. This covers fewer characters but is more robust with other packages, and <code>ucs</code> is unmaintained. Users who need better unicode support should use xelatex or lualatex.</li>
</ul></li>
<li><p>If a template specified with <code>--template</code> is not found, look for it in <code>datadir</code>. Also, if no extension is provided, supply one based on the writer. So now you can put your <code>special.latex</code> template in <code>~/.pandoc/templates</code>, and use it from any directory via <code>pandoc -t latex --template special</code>.</p></li>
<li><p>Added <code>nonspaceChar</code> to <code>Text.Pandoc.Parsing</code>.</p></li>
<li><p>Fixed smart quotes bug, now handling <code>'...hi'</code> properly.</p></li>
<li><p>RST reader:</p>
<ul>
<li>Partial support for labeled footnotes.</li>
<li>Improved accuracy of <code>simpleReferenceName</code> parser.</li>
</ul></li>
<li><p>HTML reader:</p>
<ul>
<li>Substitute correct unicode characters for characters in the 128..159 range, which are often found even in HTML that purports to be UTF-8.</li>
</ul></li>
<li><p>LaTeX reader: Handle <code>\subtitle</code> command (a subtitle is added to the title, after a colon and linebreak). Closes #280.</p></li>
<li><p>Leaner <code>reference.odt</code>.</p></li>
<li><p>Added unexported module <code>Text.Pandoc.MIME</code> for use in the ODT writer.</p></li>
<li><p>ODT writer: Construct <code>manifest.xml</code> based on archive contents. This fixes a bug in ODTs containing images. Recent versions of LibreOffice would reject these as corrupt, because <code>manifest.xml</code> did not contain a reference to the image files.</p></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Make verbatim environments flush to avoid spurious blank lines. Closes #277.</li>
<li>Use <code>\texttt</code> and escapes insntead of <code>\verb!...!</code>, which is too fragile (doesn’t work in command arguments).</li>
<li>Use <code>\enquote{}</code> for quotes if the template includes the <code>csquotes</code> package. This provides better support for local quoting styles. (Thanks to Andreas Wagner for the idea.)</li>
</ul></li>
<li><p>ConTeXt writer: Make <code>\starttyping</code>/<code>\stoptyping</code> flush with margin, preventing spurious blank lines.</p></li>
<li><p>Slidy writer:</p>
<ul>
<li>Use non-minimized version of <code>slidy.css</code> with <code>--offline</code> option, so users can more easily edit it.</li>
<li>Also fixed a bug in the CSS that prevented proper centering of title (now reported and fixed upstream).</li>
</ul></li>
<li><p>S5 writer:</p>
<ul>
<li>Replaced <code>s5/default/slides.js.{comment,packed}</code> with new compressed <code>s5/default/slides.min.js</code>.</li>
<li>Use <code>data:</code> protocol to embed S5 CSS in <code>&lt;link&gt;</code> tags, when <code>--offline</code> is specified. Using inline CSS didn’t work with Chrome or Safari. This fixes offline S5 on those browsers.</li>
</ul></li>
<li><p>HTML writer: Removed English title on footnote backlinks. This is incongrous in non-English documents.</p></li>
<li><p>Docbook writer:</p>
<ul>
<li>Use CALS tables. (Some older docbook software does not work well with XHTML tables.) Closes #77.</li>
<li>Use <code>programlisting</code> tags (instead of <code>screen</code>) for code blocks.</li>
</ul></li>
<li><p><code>markdown2pdf</code>:</p>
<ul>
<li>Calls latex with <code>-halt-on-error -interaction nonstopmode</code> instead of <code>-interaction=batchmode</code>, which essentially just ignored errors, leading to bad results. Better to know when something is wrong.</li>
<li>Fixed issues with non-UTF-8 output of <code>pdflatex</code>.</li>
<li>Better error reporting.</li>
</ul></li>
<li><p><code>--mathjax</code> now takes an optional URL argument. If it is not provided, pandoc links directly to the (secure) mathjax CDN, as now recommended (thanks to dsanson).</p></li>
<li><p>Deprecated <code>--xetex</code> option in <code>pandoc</code>. It is no longer needed, since the LaTeX writer now produces a file that can be processed by <code>latex</code>, <code>pdflatex</code>, <code>lualatex</code>, or <code>xelatex</code>.</p></li>
<li><p>Introduced <code>--luatex</code> option to <code>markdown2pdf</code>. This causes <code>lualatex</code> to be used to create the PDF.</p></li>
</ul>
<h1 id="pandoc-1.8.1.2-2011-07-16">pandoc 1.8.1.2 (2011-07-16)</h1>
<ul>
<li><p>Added <code>--epub-cover-image</code> option.</p></li>
<li><p>Documented <code>--biblatex</code> and <code>--natbib</code> options.</p></li>
<li><p>Allow <code>--section-divs</code> with slidy output. Resolves Issue #296.</p></li>
<li><p>Disallow notes within notes in reST and markdown. These previously caused infinite looping and stack overflows. For example:</p>
<pre><code>[^1]

[^1]: See [^1]</code></pre>
<p>Note references are allowed in reST notes, so this isn’t a full implementation of reST. That can come later. For now we need to prevent the stack overflows. Partially resolves Issue #297.</p></li>
<li><p>EPUB writer: Allow non-plain math methods.</p></li>
<li><p>Forbid ()s in citation item keys. Resolves Issue #304: problems with <code>(@item1; @item2)</code> because the final paren was being parsed as part of the item key.</p></li>
<li><p>Changed URI parser so it doesn’t include trailing punctuation. So, in RST, <code>http://google.com.</code> should be parsed as a link followed by a period. The parser is smart enough to recognize balanced parentheses, as often occur in wikipedia links: <code>http://foo.bar/baz_(bam)</code>.</p></li>
<li><p>Markdown+lhs reader: Require space after inverse bird tracks, so that HTML tags can be used freely at the left margin of a markdown+lhs document. Thanks to Conal Elliot for the suggestion.</p></li>
<li><p>Markdown reader: Fixed bug in footnote order (reported by CircleCode).</p></li>
<li>RST reader:
<ul>
<li>Fixed bug in in field lists with multi-line items at the end of the list.</li>
<li>Added parentheses to RST <code>specialChars</code>, so <code>(http://google.com)</code> will be parsed as a link in parens. Resolves Issue #291.</li>
<li>Allow <code>|</code> followed by newline in RST line block.</li>
</ul></li>
<li>LaTeX reader:
<ul>
<li>Support <code>\dots</code>.</li>
<li>Gobble option &amp; space after linebreak <code>\\[10pt]</code>.</li>
</ul></li>
<li>Textile reader:
<ul>
<li>Make it possible to have colons after links. (qerub)</li>
<li>Make it possible to have colons after links. (Christoffer Sawicki)</li>
</ul></li>
<li>HTML reader:
<ul>
<li>Skip spaces after <code>&lt;b&gt;</code>, <code>&lt;emph&gt;</code>, etc.</li>
<li>Handle tbody, thead in simple tables. Closes #274.</li>
<li>Implicit <code>Para</code>s instead of <code>Plains</code> in some contexts.</li>
</ul></li>
<li><p>OpenDocument writer: Use special <code>First paragraph</code> style for first paragraph after most non-paragraph blocks. This allows users to specify e.g. that only paragraphs after the first paragraph of a block are to be indented. Thanks to Andrea Rossato for the patch. Closes #20.</p></li>
<li><p>LaTeX writer: use <code>deVerb</code> on table and picture captions. Otherwise LaTeX complains about <code>\verb</code> inside command argument. Thanks to bbanier for reporting the bug.</p></li>
<li><p>Markdown writer: Insert HTML comment btw list and indented code block. This prevents the code block from being interpreted as part of the list.</p></li>
<li><p>EPUB writer: Add a meta element specify the cover. Some EPUB e-readers, such as the Nook, require a meta element inside the OPF metadata block to ensure the cover image is properly displayed. (Kelsey Hightower)</p></li>
<li><p>HTML writer: Use embed tag for images with non-image extensions. (e.g. PDFs). Closes #264.</p></li>
<li><p>LaTeX writer: Improved tables.</p>
<ul>
<li>More space between lines, top-align cells.</li>
<li>Use ctable package, which allows footnotes and provides additional options.</li>
<li>Made cell alignments work in multiline tables.</li>
<li>Closes #271, #272.</li>
</ul></li>
<li><p>Un-URI-escape image filenames in LaTeX, ConTeXt, RTF, Texinfo. Also do this when copying image files into EPUBs and ODTs. Closes #263.</p></li>
<li><p>Changed to github issue tracker.</p></li>
<li><p>Added failing emph/strong markdown test case due to Perry Wagle.</p></li>
<li>Slidy improvements:
<ul>
<li>Updated to use Slidy2.</li>
<li>Fixed bug, unclosed div tag.</li>
<li>Added <code>duration</code> variable in template. Setting this activates the timer.</li>
<li>Use ‘titlepage’ instead of ‘cover’ for title div.</li>
</ul></li>
</ul>
<h1 id="pandoc-1.8.1.1-2011-02-13">pandoc 1.8.1.1 (2011-02-13)</h1>
<ul>
<li><code>markdown2pdf</code>: Removed some debugging lines accidentally included in the 1.8.1 release. With those lines, the temp directory is created in the working directory, and it is not deleted. This fix restores the original behavior.</li>
</ul>
<h1 id="pandoc-1.8.1-2011-02-13">pandoc 1.8.1 (2011-02-13)</h1>
<ul>
<li><p>Added <code>--ascii</code> option. Currently supported only in HTML writer, which it causes to use numerical entities instead of UTF-8.</p></li>
<li><p>EPUB writer: <code>--toc</code> now works to provide a table of contents at the beginning of each chapter.</p></li>
<li><p>LaTeX writer: Change figure defaults to <code>htbp</code>. This prevents “too many unprocessed floats.” Resolves Issue #285.</p></li>
<li><p><code>Text.Pandoc.UTF8</code>: Encode filenames even when using recent base.</p></li>
<li><p><code>markdown2pdf</code>: Fixed filename encoding issues. With help from Paulo Tanimoto. Resolves Issue #286.</p></li>
<li><p>HTML writer: Put line breaks in section divs.</p></li>
<li><p><code>Text.Pandoc.Shared</code>: Make <code>writerSectionDivs</code> default to False.</p></li>
</ul>
<h1 id="pandoc-1.8.0.3-2011-02-05">pandoc 1.8.0.3 (2011-02-05)</h1>
<ul>
<li>Fixed Source-repository stanza in cabal file.</li>
</ul>
<h1 id="pandoc-1.8.0.2-2011-02-05">pandoc 1.8.0.2 (2011-02-05)</h1>
<ul>
<li><p>HTML writer:</p>
<ul>
<li>Stringify alt text instead of converting to HTML.</li>
<li>Break lines after block elements, not inside tags. HTML output now closely resembles that of tidy. Resolves Issue #134.</li>
</ul></li>
<li><p>Markdown reader: Fixed bug in footnote block parser (pointed out by Jesse Rosenthal). The problem arose when the blank line at the end of a footnote block contained indenting spaces.</p></li>
<li><p>Shared: Improved ‘normalize’ function so it normalizes Spaces too. In normal form, Space elements only occur to separate two non-Space elements. So, we never have [Space], or [, …, Space].</p></li>
<li><p>Tests:</p>
<ul>
<li>Improved Arbitrary instance.</li>
<li>Added timeout for test instances.</li>
</ul></li>
<li><p>README:</p>
<ul>
<li>Added section on four-space rule for lists. Resolves Issue #283.</li>
<li>Clarified optional arguments on math options.</li>
</ul></li>
<li><p>markdown2pdf: Fixed bug with output file extensions. Previously <code>markdown2pdf test.txt -o test.en.pdf</code> would produce <code>test.pdf</code>, not <code>test.en.pdf</code>. Thanks to Paolo Tanimoto for the fix.</p></li>
</ul>
<h1 id="pandoc-1.8.0.1-2001-01-31">pandoc 1.8.0.1 (2001-01-31)</h1>
<ul>
<li><p>Revised Interact.hs so that it works with the CPP macros in the UTF8 module.</p></li>
<li><p>Revised Setup.hs so that we don’t call MakeManPage.hs unless the man pages are out of date.</p></li>
</ul>
<h1 id="pandoc-1.8-2011-01-30">pandoc 1.8 (2011-01-30)</h1>
<h2 id="new-features-6">New features</h2>
<ul>
<li><p>Support for citations using Andrea Rossato’s <code>citeproc-hs</code> 0.3. You can now write, for example,</p>
<pre><code>Water is wet [see @doe99, pp. 33-35; also @smith04, ch. 1].</code></pre>
<p>and, when you process your document using <code>pandoc</code>, specifying a citation style using <code>--csl</code> and a bibliography using <code>--bibliography</code>, the citation will be replaced by an appropriately formatted citation, and a list of works cited will be added to the end of the document.</p>
<p>This means that you can switch effortlessly between different citation and bibliography styles, including footnote, numerical, and author-date formats. The bibliography can be in any of the following formats: MODS, BibTeX, BibLaTeX, RIS, EndNote, EndNote XML, ISI, MEDLINE, Copac, or JSON. See the README for further details.</p>
<p>Citations are supported in the markdown reader, using a special syntax, and in the LaTeX reader, using natbib or biblatex syntax. (Thanks to Nathan Gass for the natbib and biblatex support.)</p></li>
<li><p>New <code>textile</code> reader and writer. Thanks to Paul Rivier for contributing the <code>textile</code> reader, an almost complete implementation of the textile syntax used by the ruby <a href="http://redcloth.org/textile">RedCloth library</a>. Resolves Issue #51.</p></li>
<li><p>New <code>org</code> writer, for Emacs Org-mode, contributed by Puneeth Chaganti.</p></li>
<li><p>New <code>json</code> reader and writer, for reading and writing a JSON representation of the native Pandoc AST. These are much faster than the <code>native</code> reader and writer, and should be used for serializing Pandoc to text. To convert between the JSON representation and native Pandoc, use <code>encodeJSON</code> and <code>decodeJSON</code> from <code>Text.JSON.Generic</code>.</p></li>
<li><p>A new <code>jsonFilter</code> function in <code>Text.Pandoc</code> makes it easy to write scripts that transform a JSON-encoded pandoc document. For example:</p>
<pre><code>-- removelinks.hs - removes links from document
import Text.Pandoc
main = interact $ jsonFilter $ bottomUp removeLink
         where removeLink (Link xs _) = Emph xs
               removeLink x = x</code></pre>
<p>To use this to remove links while translating markdown to LaTeX:</p>
<pre><code>pandoc -t json | runghc removelinks.hs | pandoc -f json -t latex</code></pre></li>
<li><p>Attributes are now allowed in inline <code>Code</code> elements, for example:</p>
<pre><code>In this code, `ulist ! [theclass &quot;special&quot;] &lt;&lt; elts`{.haskell} is...</code></pre>
<p>The attribute syntax is the same as for delimited code blocks. <code>Code</code> inline has an extra argument place for attributes, just like <code>CodeBlock</code>. Inline code will be highlighted in HTML output, if pandoc is compiled with highlighting support. Resolves Issue #119.</p></li>
<li><p>New <code>RawBlock</code> and <code>RawInline</code> elements (replacing <code>RawHtml</code>, <code>HtmlInline</code>, and <code>TeX</code>) provide lots of flexibility in writing scripts to transform Pandoc documents. Scripts can now change how each element is rendered in each output format.</p></li>
<li><p>You can now define LaTeX macros in markdown documents, and pandoc will apply them to TeX math. For example,</p>
<pre><code>\newcommand{\plus}[2]{#1 + #2}
$\plus{3}{4}$</code></pre>
<p>yields <code>3+4</code>. Since the macros are applied in the reader, they will work in every output format, not just LaTeX.</p></li>
<li><p>LaTeX macros can also be used in LaTeX documents (both in math and in non-math contexts).</p></li>
<li><p>A new <code>--mathjax</code> option has been added for displaying math in HTML using MathJax. Resolves issue #259.</p></li>
<li><p>Footnotes are now supported in the RST reader. (Note, however, that unlike docutils, pandoc ignores the numeral or symbol used in the note; footnotes are put in an auto-numbered ordered list.) Resolves Issue #258.</p></li>
<li><p>A new <code>--normalize</code> option causes pandoc to normalize the AST before writing the document. This means that, for example, <code>*hi**there*</code> will be rendered as <code>&lt;em&gt;hithere&lt;/em&gt;</code> instead of <code>&lt;em&gt;hi&lt;/em&gt;&lt;em&gt;there&lt;/em&gt;</code>. This is not the default, because there is a significant performance penalty.</p></li>
<li><p>A new <code>--chapters</code> command-line option causes headers in DocBook, LaTeX, and ConTeXt to start with “chapter” (level one). Resolves Issue #265.</p></li>
<li><p>In DocBook output, <code>&lt;chapter&gt;</code> is now used for top-level headers if the template contains <code>&lt;book&gt;</code>. Resolves Issue #265.</p></li>
<li><p>A new <code>--listings</code> option in <code>pandoc</code> and <code>markdown2pdf</code> causes the LaTeX writer to use the listings package for code blocks. (Thanks to Josef Svennigsson for the pandoc patch, and Etienne Millon for the markdown2pdf patch.)</p></li>
<li><p><code>markdown2pdf</code> now supports <code>--data-dir</code>.</p></li>
<li><p>URLs in autolinks now have class “url” so they can be styled.</p></li>
<li><p>Improved prettyprinting in most formats. Lines will be wrapped more evenly and duplicate blank lines avoided.</p></li>
<li><p>New <code>--columns</code> command-line option sets the column width for line wrapping and relative width calculations for tables.</p></li>
<li><p>Made <code>--smart</code> work in HTML, RST, and Textile readers, as well as markdown.</p></li>
<li><p>Added <code>--html5</code> option for HTML5 output.</p></li>
<li><p>Added support for listings package in LaTeX reader (Puneeth Chaganti).</p></li>
<li><p>Added support for simple tables in the LaTeX reader.</p></li>
<li><p>Added support for simple tables in the HTML reader.</p></li>
<li><p>Significant performance improvements in many readers and writers.</p></li>
</ul>
<h2 id="api-and-program-changes">API and program changes</h2>
<ul>
<li><p>Moved <code>Text.Pandoc.Definition</code> from the <code>pandoc</code> package to a new auxiliary package, <code>pandoc-types</code>. This will make it possible for other programs to supply output in Pandoc format, without depending on the whole pandoc package.</p></li>
<li><p>Added <code>Attr</code> field to <code>Code</code>.</p></li>
<li><p>Removed <code>RawHtml</code>, <code>HtmlInline</code>, and <code>TeX</code> elements; added generic <code>RawBlock</code> and <code>RawInline</code>.</p></li>
<li><p>Moved generic functions to <code>Text.Pandoc.Generic</code>. Deprecated <code>processWith</code>, replacing it with two functions, <code>bottomUp</code> and <code>topDown</code>. Removed previously deprecated functions <code>processPandoc</code> and <code>queryPandoc</code>.</p></li>
<li><p>Added <code>Text.Pandoc.Builder</code>, for building <code>Pandoc</code> structures.</p></li>
<li><p><code>Text.Pandoc</code> now exports association lists <code>readers</code> and <code>writers</code>.</p></li>
<li><p>Added <code>Text.Pandoc.Readers.Native</code>, which exports <code>readNative</code>. <code>readNative</code> can now read full pandoc documents, block lists, blocks, inline lists, or inlines. It will interpret <code>Str &quot;hi&quot;</code> as if it were <code>Pandoc (Meta [] [] []) [Plain [Str &quot;hi&quot;]]</code>. This should make testing easier.</p></li>
<li><p>Removed deprecated <code>-C/--custom-header</code> option. Use <code>--template</code> instead.</p></li>
<li><p><code>--biblio-file</code> has been replaced by <code>--bibliography</code>. <code>--biblio-format</code> has been removed; pandoc now guesses the format from the file extension (see README).</p></li>
<li><p>pandoc will treat an argument as a URI only if it has an <code>http(s)</code> scheme. Previously pandoc would treat some Windows pathnames beginning with <code>C:/</code> as URIs.</p></li>
<li><p>The <code>--sanitize-html</code> option and the <code>stateSanitize</code> field in <code>ParserState</code> have been removed. Sanitization is better done in the resulting HTML using <code>xss-sanitize</code>, which is based on pandoc’s sanitization, but improved.</p></li>
<li><p>pandoc now adds a newline to the end of its output in fragment mode (= not <code>--standalone</code>).</p></li>
<li><p>Added support for <code>lang</code> in <code>html</code> tag in the HTML template, so you can do <code>pandoc -s -V lang=es</code>, for example.</p></li>
<li><p><code>highlightHtml</code> in <code>Text.Pandoc.Highlighting</code> now takes a boolean argument that selects between “inline” and “block” HTML.</p></li>
<li><p><code>Text.Pandoc.Writers.RTF</code> now exports <code>rtfEmbedImage</code>. Images are embedded in RTF output when possible (png, jpeg). Resolves Issue #275.</p></li>
<li><p>Added <code>Text.Pandoc.Pretty</code>. This is better suited for pandoc than the <code>pretty</code> package. Changed all writers that used <code>Text.PrettyPrint.HughesPJ</code> to use <code>Text.Pandoc.Pretty</code> instead.</p></li>
<li><p>Rewrote <code>writeNative</code> using the new prettyprinting module. It is now much faster. The output has been made more consistent and compressed. <code>writeNative</code> is also now sensitive to writerStandalone<code>, and will simply</code>print a block list if writerStandalone` is False.</p></li>
<li><p>Removed <code>Text.Pandoc.Blocks</code>. <code>Text.Pandoc.Pretty</code> allows you to define blocks and concatenate them, so a separate module is no longer needed.</p></li>
<li><p><code>Text.Pandoc.Shared</code>:</p>
<ul>
<li>Added <code>writerColumns</code>, <code>writerChapters</code>, and <code>writerHtml5</code> to <code>WriterOptions</code>.</li>
<li>Added <code>normalize</code>.</li>
<li>Removed unneeded prettyprinting functions: <code>wrapped</code>, <code>wrapIfNeeded</code>, <code>wrappedTeX</code>, <code>wrapTeXIfNeeded</code>, <code>hang'</code>, <code>BlockWrapper</code>, <code>wrappedBlocksToDoc</code>.</li>
<li>Made <code>splitBy</code> take a test instead of an element.</li>
<li>Added <code>findDataFile</code>, refactored <code>readDataFile</code>.</li>
<li>Added <code>stringify</code>. Rewrote <code>inlineListToIdentifier</code> using <code>stringify</code>.</li>
<li>Fixed <code>inlineListToIdentifier</code> to treat ‘\160’ as ‘’.</li>
</ul></li>
<li><p><code>Text.Pandoc.Readers.HTML</code>:</p>
<ul>
<li>Removed <code>rawHtmlBlock</code>, <code>anyHtmlBlockTag</code>, <code>anyHtmlInlineTag</code>, <code>anyHtmlTag</code>, <code>anyHtmlEndTag</code>, <code>htmlEndTag</code>, <code>extractTagType</code>, <code>htmlBlockElement</code>, <code>htmlComment</code></li>
<li>Added <code>htmlTag</code>, <code>htmlInBalanced</code>, <code>isInlineTag</code>, <code>isBlockTag</code>, <code>isTextTag</code></li>
</ul></li>
<li><p>Moved <code>smartPunctuation</code> from <code>Text.Pandoc.Readers.Markdown</code> to <code>Text.Pandoc.Readers.Parsing</code>, and parameterized it with an inline parser.</p></li>
<li><p>Ellipses are no longer allowed to contain spaces. Previously we allowed ‘. . .’, ‘. . .’, etc. This caused too many complications, and removed author’s flexibility in combining ellipses with spaces and periods.</p></li>
<li><p>Allow linebreaks in URLs (treat as spaces). Also, a string of consecutive spaces or tabs is now parsed as a single space. If you have multiple spaces in your URL, use <code>%20%20</code>.</p></li>
<li><p><code>Text.Pandoc.Parsing</code>:</p>
<ul>
<li>Removed <code>refsMatch</code>.</li>
<li>Hid <code>Key</code> constructor.</li>
<li>Removed custom <code>Ord</code> and <code>Eq</code> instances for <code>Key</code>.</li>
<li>Added <code>toKey</code> and <code>fromKey</code> to convert between <code>Key</code> and <code>[Inline]</code>.</li>
<li>Generalized type on <code>readWith</code>.</li>
</ul></li>
<li><p>Small change in calculation of relative widths of table columns. If the size of the header &gt; the specified column width, use the header size as 100% for purposes of calculating relative widths of columns.</p></li>
<li><p>Markdown writer now uses some pandoc-specific features when <code>--strict</code> is not specified: <code>\</code> newline is used for a hard linebreak instead of two spaces then a newline. And delimited code blocks are used when there are attributes.</p></li>
<li><p>HTML writer: improved gladTeX output by setting ENV appropriately for display or inline math (Jonathan Daugherty).</p></li>
<li><p>LaTeX writer: Use <code>\paragraph</code>, <code>\subparagraph</code> for level 4,5 headers.</p></li>
<li><p>LaTeX reader:</p>
<ul>
<li><code>\label{foo}</code> and <code>\ref{foo}</code> now become <code>{foo}</code> instead of <code>(foo)</code>.</li>
<li><code>\index{}</code> commands are skipped.</li>
</ul></li>
<li><p>Added <code>fontsize</code> variable to default LaTeX template. This makes it easy to set the font size using <code>markdown2pdf</code>: <code>markdown2pdf -V fontsize=12pt input.txt</code>.</p></li>
<li><p>Fixed problem with strikeout in LaTeX headers when using hyperref, by adding a command to the default LaTeX template that disables <code>\sout</code> inside pdf strings. Thanks to Joost Kremers for the fix.</p></li>
<li><p>The <code>COLUMNS</code> environment variable no longer has any effect.</p></li>
</ul>
<h2 id="under-the-hood-improvements-5">Under-the-hood improvements</h2>
<ul>
<li><p>Pandoc now compiles with GHC 7. (This alone leads to a significant performance improvement, 15-20%.)</p></li>
<li><p>Completely rewrote HTML reader using tagsoup as a lexer. The new reader is faster and more accurate. Unlike the old reader, it does not get bogged down on some input (Issues #277, 255). And it handles namespaces in tags (Issue #274).</p></li>
<li><p>Replaced <code>escapeStringAsXML</code> with a faster version.</p></li>
<li><p>Rewrote <code>spaceChar</code> and some other parsers in Text.Pandoc.Parsing for a significant performance boost.</p></li>
<li><p>Improved performance of all readers by rewriting parsers.</p></li>
<li><p>Simplified Text.Pandoc.CharacterReferences by using entity lookup functions from TagSoup.</p></li>
<li><p><code>Text.Pandoc.UTF8</code> now uses the unicode-aware IO functions from <code>System.IO</code> if base &gt;= 4.2. This gives support for windows line endings on windows.</p></li>
<li><p>Remove duplications in documentation by generating the pandoc man page from README, using <code>MakeManPage.hs</code>.</p></li>
<li><p>README now includes a full description of markdown syntax, including non-pandoc-specific parts. A new <code>pandoc_markdown</code> man page is extracted from this, so you can look up markdown syntax by doing <code>man pandoc_markdown</code>.</p></li>
<li><p>Completely revised test framework (with help from Nathan Gass). The new test framework is built when the <code>tests</code> Cabal flag is set. It includes the old integration tests, but also some new unit and quickcheck tests. Test output has been much improved, and you can now specify a glob pattern after <code>cabal test</code> to indicate which tests should be run; for example <code>cabal test citations</code> will run all the citation tests.</p></li>
<li><p>Added a shell script, <code>stripansi.sh</code>, for filtering ANSI control sequences from test output: <code>cabal test | ./stripansi.sh &gt; test.log</code>.</p></li>
<li><p>Added <code>Interact.hs</code> to make it easier to use ghci while developing. <code>Interact.hs</code> loads <code>ghci</code> from the <code>src</code> directory, specifying all the options needed to load pandoc modules (including specific package dependencies, which it gets by parsing dist/setup-config).</p></li>
<li><p>Added <code>Benchmark.hs</code>, testing all readers + writers using criterion.</p></li>
<li><p>Added <code>stats.sh</code>, to make it easier to collect and archive benchmark and lines-of-code stats.</p></li>
<li><p>Added upper bounds to all cabal dependencies.</p></li>
<li><p>Include man pages in extra-source-files. This allows users to install pandoc from the tarball without needing to build the man pages.</p></li>
</ul>
<h2 id="bug-fixes-5">Bug fixes</h2>
<ul>
<li><p>Filenames are encoded as UTF8. Resolves Issue #252.</p></li>
<li><p>Handle curly quotes better in <code>--smart</code> mode. Previously, curly quotes were just parsed literally, leading to problems in some output formats. Now they are parsed as <code>Quoted</code> inlines, if <code>--smart</code> is specified. Resolves Issue #270.</p></li>
<li><p>Text.Pandoc.Parsing: Fixed bug in grid table parser. Spaces at end of line were not being stripped properly, resulting in unintended LineBreaks.</p></li>
<li><p>Markdown reader:</p>
<ul>
<li>Allow HTML comments as inline elements in markdown. So, <code>aaa &lt;!-- comment --&gt; bbb</code> can be a single paragraph.</li>
<li>Fixed superscripts with links: <code>^[link](/foo)^</code> gets recognized as a superscripted link, not an inline note followed by garbage.</li>
<li>Fixed regression, making markdown reference keys case-insensitive again. Resolves Issue #272.</li>
<li>Properly handle abbreviations (like <code>Mr.</code>) at the end of a line.</li>
<li>Better handling of intraword underscores, avoiding exponential slowdowns in some cases. Resolves Issue #182.</li>
<li>Fixed bug in alignments in tables with blank rows in the header.</li>
</ul></li>
<li><p>RST reader:</p>
<ul>
<li>Field lists now allow spaces in field names, and block content in field values. (Thanks to Lachlan Musicman for pointing out the bug.)</li>
<li>Definition list items are now always <code>Para</code> instead of <code>Plain</code>, matching behavior of <code>rst2xml.py</code>.</li>
<li>In image blocks, the description is parsed properly and used for the alt attribute, not also the title.</li>
<li>Skip blank lines at beginning of file. Resolves Debian #611328.</li>
</ul></li>
<li><p>LaTeX reader:</p>
<ul>
<li>Improved parsing of preamble. Previously you’d get unexpected behavior on a document that contained <code>\begin{document}</code> in, say, a verbatim block.</li>
<li>Allow spaces between <code>\begin</code> or <code>\end</code> and <code>{</code>.</li>
<li>Support <code>\L</code> and <code>\l</code>.</li>
<li>Skip comments inside paragraphs.</li>
</ul></li>
<li><p>LaTeX writer:</p>
<ul>
<li>Escape strings in <code>\href{..}</code>.</li>
<li>In nonsimple tables, put cells in <code>\parbox</code>.</li>
</ul></li>
<li><p>OpenDocument writer: don’t print raw TeX.</p></li>
<li><p>Markdown writer:</p>
<ul>
<li>Fixed bug in <code>Image</code>. URI was getting unescaped twice!</li>
<li>Avoid printing extra blank lines at the end if there are no notes or references.</li>
</ul></li>
<li><p>LaTeX and ConTeXt: Escape <code>[</code> and <code>]</code> as <code>{[}</code> and <code>{]}</code>. This avoids unwanted interpretation as an optional argument.</p></li>
<li><p>ConTeXt writer: Fixed problem with inline code. Previously <code>}</code> would be rendered <code>\type{}}</code>. Now we check the string for ‘}’ and ‘{’. If it contains neither, use <code>\type{}</code>; otherwise use <code>\mono{}</code> with an escaped version of the string.</p></li>
<li><p><code>:</code> now allowed in HTML tags. Resolves Issue #274.</p></li>
</ul>
<h1 id="pandoc-1.6-2010-07-24">pandoc 1.6 (2010-07-24)</h1>
<ul>
<li><p>New EPUB and HTML Slidy writers. (Issue #122)</p>
<ul>
<li><a href="http://en.wikipedia.org/wiki/EPUB">EPUB</a> is a standard ebook format, used in Apple’s iBooks for the iPad and iPhone, Barnes and Noble’s nook reader, the Sony reader, and many other devices, and by online ebook readers like <a href="http://bookworm.oreilly.com/">bookworm</a>. (Amazon’s Kindle uses a different format, MobiPocket, but EPUB books can easily be converted to Kindle format.) Now you can write your book in markdown and produce an ebook with a single command! I’ve put up a short <a href="http://johnmacfarlane.net/pandoc/epub.html">tutorial here</a>.</li>
<li><a href="http://www.w3.org/Talks/Tools/Slidy">Slidy</a>, like S5, is a system for producing HTML+javascript slide shows.</li>
</ul></li>
<li><p>All input is assumed to be UTF-8, no matter what the locale and ghc version, and all output is UTF-8. This reverts to pre-1.5 behavior. Also, a BOM, if present, is stripped from the input.</p></li>
<li><p>Markdown now supports grid tables, whose cells can contain arbitrary block elements. (Issue #43)</p></li>
<li><p>Sequentially numbered example lists in markdown with <code>@</code> marker.</p></li>
<li><p>Markdown table captions can begin with a bare colon and no longer need to include the English word “table.” Also, a caption can now occur either before or after the table. (Issue #227)</p></li>
<li><p>New command-line options:</p>
<ul>
<li><code>--epub-stylesheet</code> allows you to specify a CSS file that will be used to style your ebook.</li>
<li><code>--epub-metadata</code> allows you to specify metadata for the ebook.</li>
<li><code>--offline</code> causes the generated HTML slideshow to include all needed scripts and stylesheets.</li>
<li><code>--webtex</code> causes TeX math to be converted to images using the Google Charts API (unless a different URL is specified).</li>
<li><code>--section-divs</code> causes div tags to be added around each section in an HTML document. (Issue #230, 239)</li>
</ul></li>
<li><p>Default behavior of S5 writer in standalone mode has changed: previously, it would include all needed scripts and stylesheets in the generated HTML; now, only links are included unless the <code>--offline</code> option is used.</p></li>
<li><p>Default behavior of HTML writer has changed. Between 1.2 and 1.5, pandoc would enclose sections in div tags with identifiers on the div tags, so that the sections can be manipulated in javascript. This caused undesirable interactions with raw HTML div tags. So, starting with 1.6, the default is to put the identifiers directly on the header tags, and not to include the divs. The <code>--section-divs</code> option selects the 1.2-1.5 behavior.</p></li>
<li><p>API changes:</p>
<ul>
<li><code>HTMLMathMethod</code>: Added <code>WebTeX</code>, removed <code>MimeTeX</code>.</li>
<li><code>WriterOptions</code>: Added <code>writerUserDataDir</code>, <code>writerSourceDirectory</code>, <code>writerEPUBMetadata</code> fields. Removed <code>writerIncludeBefore</code>, <code>writerIncludeAfter</code>.</li>
<li>Added <code>headerShift</code> to <code>Text.Pandoc.Shared</code>.</li>
<li>Moved parsing code and <code>ParserState</code> from <code>Text.Pandoc.Shared</code> to a new module, <code>Text.Pandoc.Parsing</code>.</li>
<li>Added <code>stateHasChapters</code> to <code>ParserState</code>.</li>
<li>Added <code>HTMLSlideVariant</code>.</li>
<li>Made <code>KeyTable</code> a map instead of an association list.</li>
<li>Added accessors for <code>Meta</code> fields (<code>docTitle</code>, <code>docAuthors</code>, <code>docDate</code>).</li>
<li><code>Pandoc</code>, <code>Meta</code>, <code>Inline</code>, and <code>Block</code> have been given <code>Ord</code> instances.</li>
<li>Reference keys now have a type of their own (<code>Key</code>), with its own <code>Ord</code> instance for case-insensitive comparison.</li>
<li>Added <code>Text.Pandoc.Writers.EPUB</code>.</li>
<li>Added <code>Text.Pandoc.UUID</code>.</li>
<li>Removed <code>Text.Pandoc.ODT</code>, added <code>Text.Pandoc.Writers.ODT</code>. Removed <code>saveOpenDocumentAsODT</code>, added <code>writeODT</code>.</li>
<li>Added <code>Text.Pandoc.Writers.Native</code> and <code>writeNative</code>. Removed <code>prettyPandoc</code>.</li>
<li>Added <code>Text.Pandoc.UTF8</code> for portable UTF8 string IO.</li>
<li>Removed <code>Text.Pandoc.Writers.S5</code> and the <code>writeS5</code> function. Moved <code>s5Includes</code> to a new module, <code>Text.Pandoc.S5</code>. To write S5, you now use <code>writeHtml</code> with <code>writerSlideVariant</code> set to <code>S5Slides</code> or <code>SlidySlides</code>.</li>
</ul></li>
<li><p>Template changes. If you use custom templates, please update them, particularly if you use syntax highlighting with pandoc. The old HTML templates hardcoded highlighting CSS that will no longer work with the most recent version of highlighting-kate.</p>
<ul>
<li>HTML template: avoid empty meta tag if no date.</li>
<li>HTML template: Use default highlighting CSS from highlighting-kate instead of hard-coding the CSS into the template.</li>
<li>HTML template: insert-before text goes before the title, and immediately after the <code>&lt;body&gt;</code> tag, as documented. (Issue #241)</li>
<li>Added slidy and s5 templates.</li>
<li>Added amssymb to preamble of latex template. (github Issue 1)</li>
</ul></li>
<li><p>Removed excess newlines at the end of output. Note: because output will not contain an extra newline, you may need to make adjustments if you are inserting pandoc’s output into a template.</p></li>
<li><p>In S5 and slidy, horizontal rules now cause a new slide, so you are no longer limited to one slide per section.</p></li>
<li><p>Improved handling of code in man writer. Inline code is now monospace, not bold, and code blocks now use .nf (no fill) and .IP (indented para).</p></li>
<li><p>HTML reader parses <code>&lt;tt&gt;</code> as Code. (Issue #247)</p></li>
<li><p>html+lhs output now contains bird tracks, even when compiled without highlighting support. (Issue #242)</p></li>
<li><p>Colons are now no longer allowed in autogenerated XML/HTML identifiers, since they have a special meaning in XML.</p></li>
<li><p>Code improvements in ODT writer. Remote images are now replaced with their alt text rather than a broken link.</p></li>
<li><p>LaTeX reader improvements:</p>
<ul>
<li>Made latex <code>\section</code>, <code>\chapter</code> parsers more forgiving of whitespace.</li>
<li>Parse <code>\chapter{}</code> in latex.</li>
<li>Changed <code>rawLaTeXInline</code> to accept <code>\section</code>, <code>\begin</code>, etc.</li>
<li>Use new <code>rawLaTeXInline'</code> in LaTeX reader, and export <code>rawLaTeXInline</code> for use in markdown reader.</li>
<li>Fixes bug wherein <code>\section{foo}</code> was not recognized as raw TeX in markdown document.</li>
</ul></li>
<li><p>LaTeX writer: images are automatically shrunk if they would extend beyond the page margin.</p></li>
<li><p>Plain, markdown, RST writers now use unicode for smart punctuation.</p></li>
<li><p>Man writer converts math to unicode when possible, as in other writers.</p></li>
<li><p><code>markdown2pdf</code> can now recognize citeproc options.</p></li>
<li><p>Command-line arguments are converted to UTF-8. (Issue #234)</p></li>
<li><p><code>Text.Pandoc.TeXMath</code> has been rewritten to use texmath’s parser. This allows it to handle a wider range of formulas. Also, if a formula cannot be converted, it is left in raw TeX; formulas are no longer partially converted.</p></li>
<li><p>Unicode curly quotes are left alone when parsing smart quotes. (Issue #143)</p></li>
<li><p>Cabal file changes:</p>
<ul>
<li>Removed parsec &lt; 3 restriction.</li>
<li>Added ‘threaded’ flag for architectures where GHC lacks a threaded runtime.</li>
<li>Use ‘threaded’ only for markdown2pdf; it is not needed for pandoc.</li>
<li>Require highlighting-kate 0.2.7.</li>
</ul></li>
<li><p>Use explicit imports from <code>Data.Generics</code>. Otherwise we have a conflict with the ‘empty’ symbol, introduced in syb &gt;= 0.2. (Issue #237)</p></li>
<li><p>New data files: slidy/slidy.min.js, slidy/slidy.min.css, epub.css.</p></li>
</ul>
<h1 id="pandoc-1.5.1.1-2010-03-29">pandoc 1.5.1.1 (2010-03-29)</h1>
<ul>
<li>Fixed header identifiers (uniqueIdent in Shared) so they work as advertized in README and are guaranteed to be valid XHTML names. Thanks to Xyne for reporting the bug.</li>
</ul>
<h1 id="pandoc-1.5.1-2010-03-23">pandoc 1.5.1 (2010-03-23)</h1>
<ul>
<li>Fixed treatment of unicode characters in URIs.</li>
<li>Revised Setup.hs so it works with debian’s build process.</li>
<li>Fixed bug in OpenDocument writer that led to invalid XML for some input.</li>
</ul>
<h1 id="pandoc-1.5.0.1-2010-03-21">pandoc 1.5.0.1 (2010-03-21)</h1>
<ul>
<li>HTML writer: Fixed error in math writer (with MathML option) that caused an infinite loop for unparsable MathML.</li>
</ul>
<h1 id="pandoc-1.5-2010-03-20">pandoc 1.5 (2010-03-20)</h1>
<ul>
<li>Moved repository to <a href="http://github.com/jgm/pandoc">github</a>.</li>
<li>New <code>--mathml</code> option, for display of TeX math as MathML.</li>
<li>New <code>--data-dir</code> option, allowing users to specify a data directory other than <code>~/.pandoc</code>. Files placed in this directory will be used instead of system defaults.</li>
<li>New <code>--base-header-level</code> option. For example, <code>--base-header-level=2</code> changes level 1 headers to level 2, level 2 to level 3, etc.</li>
<li>New ‘plain’ output format: plain text without pictures, hyperlinks, inline formatting, or anything else that looks even vaguely markupish.</li>
<li>Titles and authors in title blocks can now span multiple lines, as long as the continuation lines begin with a space character.</li>
<li>When given an absolute URI as a parameter, pandoc will fetch the content via HTTP.</li>
<li>The HTML reader has been made much more forgiving. It no longer requires well-formed xhtml as input.</li>
<li><code>html2markdown</code> has been removed; it is no longer necessary, given the last two changes. <code>pandoc</code> can be used by itself to convert web pages to markdown or other formats.</li>
<li><code>hsmarkdown</code> has also been removed. Use <code>pandoc --strict</code> instead. Or symlink pandoc’s executable to <code>hsmarkdown</code>; <code>pandoc</code> will then behave like <code>hsmarkdown</code> used to.</li>
<li>An image in a paragraph by itself is now rendered as a figure in most writers, with the alt text as the caption.</li>
<li>Incomplete support for reST tables (simple and grid). Thanks to Eric Kow. Colspans and rowspans not yet supported.</li>
<li>In mediawiki, links with relative URLs are now formatted as wikilinks. Also, headers have been promoted: <code>= head =</code> is now level 1 instead of level 2.</li>
<li>The markdown reader now handles “inverse bird tracks” when parsing literate haskell. These are used for haskell example code that is not part of the literate program.</li>
<li>The <code>-B</code> and <code>-A</code> options now imply <code>-s</code> and no longer work in fragment mode.</li>
<li>Headerless tables are now printed properly in all writers. In addition, tbody, thead, and cols are used in HTML and Docbook tables.</li>
<li>Improved build system; removed obsolete Makefile.</li>
<li>In LaTeX writer, <code>\chapter</code> is now used instead of <code>\section</code>. when the documentclass is book, report, or memoir.</li>
<li>Many small bug fixes. See <a href="changelog.txt">changelog</a> for details.</li>
</ul>
<h1 id="pandoc-1.4-2010-01-02">pandoc 1.4 (2010-01-02)</h1>
<ul>
<li>New template system replaces old headers, giving users much more control over pandoc’s output in <code>--standalone</code> mode. Added <code>--template</code> and <code>--variable</code> options. The <code>--print-default-header</code> option is now <code>--print-default-template</code>. See README under “Templates” for details.</li>
<li>The old <code>--custom-header</code> option should still work, but it has been deprecated.</li>
<li>New <code>--reference-odt</code> option allows users to customize styles in ODT output.</li>
<li>Users may now put custom templates, s5 styles, and a reference ODT in the <code>~/.pandoc</code> directory, where they will override system defaults. See README for details.</li>
<li>Unicode is now used whenever possible in HTML and XML output. Entities are used only where necessary (<code>&amp;gt;</code>, <code>&amp;lt;</code>, <code>&amp;quot;</code>, <code>&amp;amp;</code>).</li>
<li>Authors and dates may now include formatting and notes.</li>
<li>Added <code>--xetex</code> option for <code>pandoc</code> and <code>markdown2pdf</code>.</li>
<li>Windows installer now includes highlighting support and <code>markdown2pdf</code> and <code>hsmarkdown</code> wrappers.</li>
<li>Pandoc no longer requires Template Haskell, which should make it more portable.</li>
<li>Pandoc can now be built on GHC 6.12, as well as earlier versions.</li>
<li>See README for other small improvements and bug fixes.</li>
</ul>
<h1 id="pandoc-1.3-2009-12-10">pandoc 1.3 (2009-12-10)</h1>
<ul>
<li>Added <code>--id-prefix</code> option to help prevent duplicate identifiers when you’re generating HTML fragments.</li>
<li>Added <code>--indented-code-classes</code> option, which specifies default highlighting syntax for indented code blocks.</li>
<li><code>--number-sections</code> now affects HTML output.</li>
<li>Improved syntax for markdown definition lists.</li>
<li>Better looking simple tables.</li>
<li>Markdown tables without headers are now possible.</li>
<li>New hard line break syntax: backslash followed by newline.</li>
<li>Improved performance of markdown reader by ~10% by eliminating the need for a separate parsing pass for notes.</li>
<li>Improved syntax highlighting for literate Haskell.</li>
<li>Support for “..code-block” directive in RST reader.</li>
<li>Windows binary now includes highlighting support.</li>
<li>Many bug fixes and small improvements. See <a href="changelog.txt">changelog</a> for details.</li>
</ul>
<h1 id="pandoc-1.2.1-2009-07-18">pandoc 1.2.1 (2009-07-18)</h1>
<ul>
<li>Improved the efficiency of the markdown reader’s abbreviation parsing (should give a big performance boost with <code>--smart</code>).</li>
<li>HTML writer now wraps sections in divs with unique identifiers, for easier manipulation.</li>
<li>Improved LaTeX reader’s coverage of math modes.</li>
<li>Added a portable Haskell version of markdown2pdf (thanks to Paolo Tanimoto).</li>
<li>Made <code>--strict</code> compatible with <code>--standalone</code> and <code>--toc.</code></li>
<li>Many other small improvements and bug fixes. See <a href="changelog.txt">changelog</a> for details.</li>
</ul>
<h1 id="pandoc-1.2-2009-03-01">pandoc 1.2 (2009-03-01)</h1>
<ul>
<li>Added support for literate Haskell. lhs support is triggered by ‘+lhs’ suffixes in formats. For example, ‘latex+lhs’ is literate Haskell LaTeX. ‘.lhs’ files are treated by default as literate markdown.</li>
<li>Added <code>--email-obfuscation</code> option.</li>
<li>Brought citeproc support up to date for citeproc-hs-0.2.</li>
<li>Many bugs fixed. See <a href="changelog.txt">changelog</a> for details.</li>
</ul>
<h1 id="pandoc-1.1-2008-11-06">pandoc 1.1 (2008-11-06)</h1>
<ul>
<li>New <code>--jsmath</code> option supporting use of pandoc with [jsMath].</li>
<li>Classes on HTML table output for better CSS styling.</li>
<li>Windows installer no longer requires admin privileges.</li>
<li>Many bugs fixed. See <a href="changelog.txt">changelog</a> for details.</li>
</ul>
<h1 id="pandoc-1.0-2008-09-13">pandoc 1.0 (2008-09-13)</h1>
<ul>
<li>New writers for MediaWiki, GNU Texinfo (thanks to Peter Wang), OpenDocument XML (thanks to Andrea Rossato), and ODT (OpenOffice document).</li>
<li>New <a href="README.html#delimited-code-blocks">delimited code blocks</a>, with optional syntax highlighting.</li>
<li>Reorganized build system: pandoc can now be built using standard Cabal tools. It can be compiled on Windows without Cygwin. The tests can also be run without perl or unix tools.</li>
<li>LaTeXMathML replaces ASCIIMathML for rendering math in HTML.</li>
<li>Support for “displayed” math.</li>
<li>Common abbreviations are now handled more intelligently, with a non-breaking space (and not a sentence-ending space) after the period.</li>
<li>Code is -Wall clean.</li>
<li>Many bug fixes and small improvements. See <a href="changelog.txt">changelog</a> for full details.</li>
</ul>
<h1 id="pandoc-0.46-2008-01-08">pandoc 0.46 (2008-01-08)</h1>
<ul>
<li>Added a <code>--sanitize-html</code> option (and a corresponding parameter in <code>ParserState</code> for those using the pandoc libraries in programs). This option causes pandoc to sanitize HTML (in HTML or Markdown input) using a whitelist method. Possibly harmful HTML elements are replaced with HTML comments. This should be useful in the context of web applications, where pandoc may be used to convert user input into HTML.</li>
<li>Made -H, -A, and -B options cumulative: if they are specified multiple times, multiple files will be included.</li>
<li>Many bug fixes and small improvements. See <a href="changelog.txt">changelog</a> for full details.</li>
</ul>
<h1 id="pandoc-0.45-2007-12-09">pandoc 0.45 (2007-12-09)</h1>
<ul>
<li>Many bug fixes and structural improvements. See <a href="changelog.txt">changelog</a> for full details.</li>
<li>Improved treatment of math. Math is now rendered using unicode by default in HTML, RTF, and DocBook output. For more accurate display of math in HTML, <code>--gladtex</code>, <code>--mimetex</code>, and <code>--asciimathml</code> options are provided. See the <a href="README.html#math">User’s Guide</a> for details.</li>
<li>Removed support for box-style block quotes in markdown.</li>
<li>More idiomatic ConTeXt output.</li>
<li>Text wrapping in ConTeXt and LaTeX output.</li>
<li>Pandoc now correctly handles all standard line endings (CR, LF, CRLF).</li>
<li>New <code>--no-wrap</code> option that disables line wrapping and minimizes whitespace in HTML output.</li>
<li>Build process is now compatible with both GHC 6.8 and GHC 6.6. GHC and GHC_PKG environment variables may be used to specify which version of the compiler to use, when multiple versions are installed.</li>
</ul>
        </div>
      </main>
    </div>
    <footer>
    </footer>
  </div>
</body>
</html>
